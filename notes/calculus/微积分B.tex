\documentclass[a4paper,punct=CCT]{ctexbook}

\title{微积分B}
\author{赵磊}

\input{preamble-all}

\newcommand*{\mreason}[1]{#1}
\newcommand*{\ex}[2]{\textbf{例#1：}#2}
\newcommand*{\disp}[1]{\( \displaystyle #1 \)}
\newcommand*{\exds}[2]{\ex{#1}\disp{#2}}
% \parasp
\renewcommand{\arraystretch}{1.8}
\newcommand*{\hangpar}[2]{\hangindent=1.2cm \textbf{#1}\\[6pt]#2}
\newcommand*{\veq}{\ensuremath{\mathrel{\:\rotatebox{90}{=}}}}
\renewcommand*{\enumparen}[1]{（\makebox[0.6em][c]{\normalfont#1}）}
\DeclareEmphSequence{\bfseries}
\renewcommand*{\tand}{\textop{且}}
\renewcommand*{\tor}{\textop{或}}
\renewcommand*{\otherwise}{\text{其他}}
\renewcommand*{\iand}{\intertext{和}}
\renewcommand*{\siand}{\shortintertext{和}}
\makeatletter
\newtheoremstyle{plain}{3pt}{3pt}{\itshape}{}{\bfseries}{}{.5em}{%
  \thmname{#1}\thmnumber{\@ifnotempty{#1}{ }\@upn{#2}}%
  \thmnote{ {\the\thm@notefont（#3）}}%
  % \@ifnotempty{#3}{\thm@headsep=.75ex}
}
\newtheoremstyle{definition}{3pt}{3pt}{}{}{\bfseries}{}{.5em}{%
  \thmname{#1}\thmnumber{\@ifnotempty{#1}{ }\@upn{#2}}%
  \thmnote{ {\the\thm@notefont（#3）}}%
  % \@ifnotempty{#3}{\thm@headsep=.75ex}
}
\newtheoremstyle{remark}{3pt}{3pt}{}{}{}{\ignorespaces}{\z@}{\noindent\ignorespaces}
\makeatother
\newtheorem{theorem}{定理}
\newtheorem*{theorem*}{定理}
\newtheorem{corollary}[theorem]{推论}
\newtheorem*{corollary*}{推论}
\theoremstyle{definition}
\newtheorem{definition}{定义}
\newtheorem*{definition*}{定义}
\newtheorem{axiom}{公理}
\newtheorem*{axiom*}{公理}
\newtheorem{example}{例}
\newtheorem*{example*}{例}
\theoremstyle{remark}
\newtheorem*{remark}{评论}

\usepackage{cancel}
\usepackage{systeme}
\usepackage{caption}
\usepackage[normalem]{ulem}
% \usepackage[perpage]{footmisc}
\usepackage{enumitem}

\usepackage{tikz}
\usetikzlibrary{positioning,shapes,automata,external,colorbrewer}
\tikzexternalize[mode=list and make,prefix=figures/]

% \usepackage[lite,subscriptcorrection,nofontinfo]{mtpro2}
\usepackage{fontspec}

\defaultfontfeatures{Ligatures=TeX}
\setmainfont{Palatino Linotype}
%\usepackage[integrals]{wasysym}
\usepackage{fontawesome}

% \xeCJKsetup{CJKecglue=\,}
% \ltjsetparameter{xkanjiskip={0.13\zw plus 1pt minus 1pt}}
\setCJKmainfont{Songti SC}[
  BoldFont = Heiti SC,
  ItalicFont = STFangsong
]

\usepackage[math-style=TeX]{unicode-math}
\setmathfont{TeX Gyre Pagella Math}

\usepackage{microtype}

\newif\ifshowsol
\newif\ifshowex
\newif\ifshowsolp
\showsoltrue
\showextrue
\ifshowsol
\showsolptrue
\fi
\showsolptrue

\renewcommand*{\proofname}{证}
\makeatletter
\renewenvironment{proof}[1][\proofname]{\par
  \pushQED{\qed}%
  \normalfont \topsep6\p@\@plus6\p@\relax
  \trivlist
  % \item[]\ignorespaces
  \item[\hskip\labelsep
    \bfseries
    #1%
    % \@addpunct{\hskip6.5pt}%
    ]\ignorespaces
}{%
  \popQED\endtrivlist\@endpefalse
}
\makeatother

% \newenvironment{example}[1][]{\noindent\textbf{例#1：}}{}

\AtBeginDocument{%
  % \renewcommand{\perp}{\mathrel{\bot}}
  \let\leq\leqslant
  \let\le\leq
  \let\geq\geqslant
  \let\ge\geq}

\begin{document}
\frontmatter

\maketitle
\thispagestyle{empty}
% \cleardoublepage

\chapter*{前言}

这是我在首期“乘风计划”中《微积分B》课程中做的学习笔记．

\clearpage
\thispagestyle{empty}

\mainmatter

\part{极限理论与一元函数}

\chapter{实数与函数}

\section{实数集的界与确界}

\begin{definition}
  \label{defn:bnd}
  设\(A\)是一个非空实数集．若存在\(M > 0\)，使得对任意的\(x \in A\)，都有\(\abs{x} \le M\)，则称实数集\(A\)有界，称\(M\)为\(A\)的一个界；若存在\(M_1 \in \R\)，使得对任意的\(x \in A\)，都有\(x \le M_1\)，则称实数集\(A\)有上界，称\(M_1\)为\(A\)的一个上界；下界的定义类似．
\end{definition}

% \pskip
\begin{theorem*}
  实数集有界的充分必要条件是其既有上界又有下界．

  \begin{proof}
    只证充分性．设\(M_1, M_2\)分别为实数集的上下界，取\(M = \maxb*{\abs{M_1}, \abs{M_2}}\)，则\(M\)就是该实数集的一个界．
  \end{proof}
\end{theorem*}

\begin{example*}
  证明正整数集\(\Z^+\)是无界集．

  \begin{proof}
    对于任意的\(M > 0\)，取\(n_0 = \floor M + 1\)，都有\(n_0 \in \Z^+\)且\(n_0 > M\)．
  \end{proof}
\end{example*}


\begin{example*}
  证明\(\brce{n \sin \frac{n\pi}2}\)是无界集．

  \begin{proof}
    对于所有的\(M > 0\)，取\(n_0 = 2 \floor M + 1\)，那么就有
    \[
      \abs[\Big]{n_0 \sin \frac{n_0\pi}2} = \abs[\Big]{(-1)^{\floor M} n_0} = n_0 = 2 \floor M + 1 > M. \qedhere
    \]
  \end{proof}
\end{example*}

\begin{definition*}
  实数集\(A\)的最小上界称作上确界\footnote{上（下）确界的概念最早可以追溯到Roger Paman．}，记作\(\sup A\)；它的最大下界称作下确界，记作\(\inf A\)．
\end{definition*}

\begin{definition}
  \label{defn:supinf}
  对于实数集\(A\)，如果实数\(M\)满足：\enumparen{1}对于任意的\(x \in A\)，都有\(x \le M \)；\enumparen{2}对于任意的\(ε > 0\)，都存在\(x \in A\)使得\(x > M - ε\)；那么就称\(M\)为\(A\)的上确界．下确界的定义类似．
\end{definition}

\begin{example*}
  证明\(\inf\Seq[\big]{\frac1n} = 0\)．

  \begin{proof}
    取\(x = 1/\paren[\big]{\floor{\frac1ε}+1}\)即可．
  \end{proof}
\end{example*}

\begin{axiom}[确界存在公理]
  \label{ax:lubglb}
  若非空实数集\(A\)有上界，则其在实数范围内上有上确界；若有下界，则在实数范围内有下确界．
\end{axiom}

\subpdfbookmark{思考}{B1.1.1.P}
\subsection*{思考}

设\(E \subset R\)为非空实数集．上确界\(\sup E\)和最大值\(\max E\)有什么和联系区别？下确界\(\inf E\)和最小值\(\min E\)呢？

\ifshowsolp
\pskip
如果\(E\)有最大值，则\(\sup E = \max E\)．最小值的情况同理．
\fi

\ifshowex
\currentpdfbookmark{练习}{B1.1.1.E}
\subsection*{练习\label{B1.1.1.E}}

\begin{enumerate}
\item 下列集合中，有最大值的集合是\uline{\makebox[4em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(\brce{x \mid x \in (0, 1), x \in \Q}\)
  \item 自然数集
    \ifshowsol
  \item[\faCircle] 有限个数构成的集合\(\brce{a_1, a_2, \dots, a_n}\)
    \else
  \item 有限个数构成的集合\(\brce{a_1, a_2, \dots, a_n}\)
    \fi
  \item \(\brce[\big]{x \in \R \mid x^2 - 2x -3 < 0}\)
  \end{itemize}

\item 集合\(\brce{x \in \R \mid -x^2 - x + 2 > 0}\)的上确界是\ifshowsol
  \uline{\makebox[4em]{\(1\)}}\else\uline{\makebox[4em]{}}\fi．

\item \(\displaystyle \bigcup_{n=1}^\infty \paren[\Big]{1 + \frac1n, 2 - \frac1n} =\)
  \ifshowsol\uline{\makebox[4em]{\((1, 2)\)}}\else\uline{\makebox[4em]{}}\fi．

\item \(\displaystyle \bigcap_{n=1}^\infty \parenbrkt[\Big]{2-\frac1n, 3-\frac1n} =\)
  \ifshowsol\uline{\makebox[4em]{\(\brce{2}\)}}\else\uline{\makebox[4em]{}}\fi．

\item 设集合\(A = \brkt{-1,1},\ B = \paren{0,2}\)，则\(A \setminus B =\)
  \ifshowsol\uline{\makebox[4em]{\(\brkt{-1,0}\)}}\else\uline{\makebox[4em]{}}\fi．

\item 设集合\(A = \brce{x \in \R \mid x^2 < 2},\ B = \brce{x \in \Q \mid x^2 < 2}\)，则\uline{\makebox[4em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(\sup A > \sqrt2 > \sup B\)
  \item \(\sup A = \sqrt2 > \sup B\)
  \item \(\sup A > \sqrt2 = \sup B\)
    \ifshowsol
  \item[\faCircle] \(\sup A = \sqrt2 = \sup B\)
    \else
  \item \(\sup A = \sqrt2 = \sup B\)
    \fi
  \end{itemize}

\item 若\(A, B\)为\(\R\)中的非空有界集，记\(M_1 = \inf\paren{A \cup B},\ M_2 = \min\brce{\inf A, \inf B},\ N_1 = \sup\paren{A \cup B},\ N_2 = \max\brce{\sup A, \sup B}\)，则\uline{\makebox[4em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(M_1 < M_2,\ N_1 > N_2\)
  \item \(M_1 = M_2,\ N_1 > N_2\)
  \item \(M_1 < M_2,\ N_1 = N_2\)
    \ifshowsol
  \item[\faCircle] \(M_1 = M_2,\ N_1 = N_2\)
    \else
  \item \(M_1 = M_2,\ N_1 = N_2\)
    \fi
  \end{itemize}

\item 若\(A, B\)为\(\R\)中的两个不同非空有界集，且\(A \cap B\)非空，记\(M_1 = \inf(A \cap B),\ M_2 = \max\brce{\inf A, \inf B},\ N_1 = \sup(A \cap B),\ N_2 = \min\brce{\sup A, \sup B}\)，则\uline{\makebox[4em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
    \ifshowsol
  \item[\faCircle] \(M_1 \ge M_2,\ N_1 \le N_2\)
    \else
  \item \(M_1 \ge M_2,\ N_1 \le N_2\)
    \fi
  \item \(M_1 > M_2,\ N_1 < N_2\)
  \item \(M_1 < M_2,\ N_1 > N_2\)
  \item \(M_1 = M_2,\ N_1 = N_2\)
  \end{itemize}

\item \label{B1.1.1.E.9}若\(a, b \in \R\)，则\(\max\brce{a, b}\)和\(\min\brce{a, b}\)分别是\uline{\makebox[4em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
    \ifshowsol
  \item[\faCircle] \(\displaystyle \frac{a+b+\abs{a-b}}{2},\ \frac{a+b-\abs{a-b}}{2}\)
    \else
  \item \(\displaystyle \frac{a+b+\abs{a-b}}{2},\ \frac{a+b-\abs{a-b}}{2}\)
    \fi
  \item \(\displaystyle \frac{a-b+\abs{a-b}}{2},\ \frac{a+b-\abs{a-b}}{2}\)
  \item \(\displaystyle \frac{a+b-\abs{a-b}}{2},\ \frac{a-b+\abs{a-b}}{2}\)
  \item \(\displaystyle \frac{a+b+\abs{a-b}}{2},\ \frac{a-b+\abs{a-b}}{2}\)
  \end{itemize}

\item 设\(A,\ B\)为\(\R^+\)中的非空有界集，定义数集\(P = \brce{x \mid x = a + b, a \in A, b \in B}, Q = \brce{x \mid x = a - b, a \in A, b \in B}\)，则下列四个等式
  \begin{align*}
    \sup P &= \sup A + \sup B & \inf P &= \inf A + \inf B \\
    \sup Q &= \sup A - \sup B & \inf Q &= \inf A - \inf B
  \end{align*}
  正确的等式个数是
  \ifshowsol
  \uline{\makebox[4em]{\(2\)}}%
  \else
  \uline{\makebox[4em]{}}%
  \fi
  个．

  \ifshowsol
  前两个等式是正确的，后两个改成\(\sup Q = \sup A - \inf B\)和\(\inf Q = \inf A - \sup B\)就正确了．
  \fi
\end{enumerate}
\fi

\section{函数的概念}

\begin{definition*}
  设\(D\)是一个非空实数集，\(\,f\)是\(D\)上的一个对应关系．若对任意的\(x \in D\)，都存在唯一的实数\(y\)通过\(\,f\)与\(x\)对应，则称\(\,f\)是定义在\(D\)上的一个函数，记作\(y = f(x),\ x \in D\)．
\end{definition*}

函数的记号是欧拉的，现代定义最早是由狄利克雷提出的．

\begin{definition*}
  设函数\(f\)在\(D\)上有定义，称点集\(\Set[\big]{(x,y) \mid y = f(x),\ x \in D}\)为\(f\)的图形．
\end{definition*}

\begin{definition}[狄利克雷函数]
  \label{defn:dirichlet}
  \[
    \Fn D(x) =
    \begin{cases}
      1, & x \in \Q, \\
      0, & x \in \R \setminus \Q.
    \end{cases}
  \]
\end{definition}

\begin{definition}[单位阶跃函数]
  \label{defn:heaviside}
  \[
    \Fn H(x) =
    \begin{cases}
      1, & x \ge 0, \\
      0, & x < 0.
    \end{cases}
  \]
\end{definition}

\begin{definition*}[符号函数]
  \[
    \sgn(x) =
    \begin{cases}
      1, & x > 0, \\
      0, & x = 0, \\
      -1, & x < 0.
    \end{cases}
  \]
\end{definition*}

\begin{definition*}[分段函数]
  在定义域上不能由一个统一的数学表达式表示，但在定义域的不同范围上能用不同的数学表达式给出的函数称为分段函数．
\end{definition*}

\begin{definition*}[隐函数]
  无法或者不方便显式地来定义，而是使用代数关系（一般无法写出解析解形式）来确定的函数．
\end{definition*}

\begin{example*}
  对于任意\(k \le 0\)，找到使得等式\(2^x = kx + 2\)成立的\(x\)，这样建立的从\(k\)到\(x\)的关系就是一个隐函数．
\end{example*}

\begin{example*}
  易知函数\(y = x + \frac12 \sin x\)是单调递增函数，那么由这个函数确定的反函数\(x = x(y)\)也是一个隐函数\footnote{反函数和单调函数的定义见于第~\ref{sec:funcops}节和第~\ref{sec:funcprops}节．}．
\end{example*}

\begin{example*}
  等式\(x^2 + y^2 = 1\)是函数\(y = \sqrt{1 - x^2}\)和函数\(y = -\sqrt{1 - x^2}\)的隐式表示．
\end{example*}

\subpdfbookmark{思考}{B1.1.2.P}
\subsection*{思考}

\begin{enumerate}
\item 取整函数的定义为
  \[
    y = \floor x = n,\ x \in \brktparen{n, n+1},\ n = 0, \pm1, \pm2, \dots
  \]
  试画出取整函数的图像．

  \ifshowsolp
  \begin{figure}[H]
    \centering
    \tikzsetnextfilename{B1.1.2.P.1}
    \begin{tikzpicture}[scale=0.67,font=\scriptsize]
      \draw[->] (-4,0) -- (5,0) node[anchor=west] {\(x\)};
      \draw[->] (0,-4) -- (0,5) node[anchor=south] {\(y\)};
      \draw[thick] plot[jump mark left,mark=*]
      coordinates{(-3,-3) (-2,-2) (-1,-1) (0,0) (1,1) (2,2) (3,3) (4,4)};
      \draw[-] (-3,-0.1)  node[anchor=north,yshift=1pt]                 {\(-3\)} -- (-3,0.1);
      \draw[-] (-2,-0.1)  node[anchor=north,yshift=1pt]                 {\(-2\)} -- (-2,0.1);
      \draw[-] (-1,-0.1)  node[anchor=north,yshift=1pt]                 {\(-1\)} -- (-1,0.1);
      \draw[-] (0,-0.1)   node[anchor=north east,yshift=1pt,xshift=1pt] {\(0\)}  -- (0,0.1);
      \draw[-] (1,-0.1)   node[anchor=north,yshift=1pt]                 {\(1\)}  -- (1,0.1);
      \draw[-] (2,-0.1)   node[anchor=north,yshift=1pt]                 {\(2\)}  -- (2,0.1);
      \draw[-] (3,-0.1)   node[anchor=north,yshift=1pt]                 {\(3\)}  -- (3,0.1);
      \draw[-] (4,-0.1)   node[anchor=north,yshift=1pt]                 {\(4\)}  -- (4,0.1);
      \draw[-] (-0.05,-3) node[anchor=east,xshift=3pt]                  {\(-3\)} -- (0.05,-3);
      \draw[-] (-0.05,-2) node[anchor=east,xshift=3pt]                  {\(-2\)} -- (0.05,-2);
      \draw[-] (-0.05,-1) node[anchor=north east,yshift=2pt,xshift=3pt] {\(-1\)} -- (0.05,-1);
      \draw[-] (-0.05,1)  node[anchor=east,xshift=3pt]                  {\(1\)}  -- (0.05,1);
      \draw[-] (-0.05,2)  node[anchor=east,xshift=3pt]                  {\(2\)}  -- (0.05,2);
      \draw[-] (-0.05,3)  node[anchor=east,xshift=3pt]                  {\(3\)}  -- (0.05,3);
      \draw[-] (-0.05,4)  node[anchor=east,xshift=3pt]                  {\(4\)}  -- (0.05,4);
    \end{tikzpicture}
  \end{figure}
  \fi

\item 能否画出狄利克雷函数的图像？

  \ifshowsolp
  不能．
  \fi
\end{enumerate}

\ifshowex
\currentpdfbookmark{练习}{B1.1.2.E}
\subsection*{练习}

\begin{enumerate}
\item 函数\(y = \sqrt{x - \sqrt{x}} + \sqrt{2^x - 4}\)的定义域为
  \ifshowsol
  \uline{\makebox[5em]{\(\brktparen{2, +\infty}\)}}．
  \else
  \uline{\makebox[5em]{}}．
  \fi

\item 函数\(y = \frac1{\floor{x+1}}\)的定义域为
  \ifshowsol
  \uline{\makebox[10em]{\(\paren{-\infty, -1} \cup \brktparen{0, +\infty}\)}}．
  \else
  \uline{\makebox[10em]{}}．
  \fi

\item 函数\(y = \abs x + \abs{x-1} - \abs{4-2x}\)的最大值和最小值分别是
  \ifshowsol
  \uline{\makebox[3em]{\(-3\)}}和\uline{\makebox[3em]{\(3\)}}．
  \else
  \uline{\makebox[3em]{}}和\uline{\makebox[3em]{}}．
  \fi

\item 设非负实数\(x, y\)满足方程\((1-x)\,y^2 = x^3\)．若\(x = \frac{t^2}{1+t^2}\)，则\(y\)能看作\(t\)的一个函数．用\(t\)表示\(y\)，有\(y =\)
  \ifshowsol
  \uline{\makebox[6em]{\(t^3/\paren{1+t^2}\)}}．
  \else
  \uline{\makebox[6em]{}}．
  \fi

\item 有函数
  \[
    f(x) =
    \begin{cases}
      \frac1{2^x}, & x \ge 4, \\
      \,f(x+1), & x < 4.
    \end{cases}
  \]
  求\(f(\log_2 3) =\)
  \ifshowsol
  \uline{\makebox[4em]{\(1/{24}\)}}．
  \else
  \uline{\makebox[4em]{}}．
  \fi

\item 函数
  \[
    f(x) =
    \begin{cases}
      x^2 + 2x - 3, & x \le 0, \\
      -2 + \ln x, & x > 0
    \end{cases}
  \]
  的零点个数为
  \ifshowsol
  \uline{\makebox[3em]{\(2\)}}．
  \else
  \uline{\makebox[3em]{}}．
  \fi

\item 函数
  \[
    f(x) =
    \begin{cases}
      4x - 4, & x \le 1, \\
      x^2 - 4x + 3, & x > 1
    \end{cases}
  \]
  的图像与函数图像
  \[
    g(x) = \log_2 x
  \]
  的图像交点个数是
  \ifshowsol
  \uline{\makebox[3em]{\(3\)}}．
  \else
  \uline{\makebox[3em]{}}．
  \fi

\item 设函数
  \[
    f(x) =
    \begin{cases}
      2^{-x} - 1, & x \le 0, \\
      x^{1/2}, & x > 0.
    \end{cases}
  \]
  不等式\(f(x) > 1\)的解集是
  \ifshowsol
  \uline{\makebox[10em]{\(\paren{-\infty, -1} \cup \paren{1, +\infty}\)}}．
  \else
  \uline{\makebox[10em]{}}．
  \fi

\item 函数\(\displaystyle y = \frac{\ln(1+3x)}{x^2-3x+2}\)的定义域为
  \ifshowsol
  \uline{\makebox[13em]{\(\brce{x \mid x > -1/3, x \ne 1, x \ne 2}\)}}．
  \else
  \uline{\makebox[13em]{}}．
  \fi

\item 函数\(y = \arcsin(2x+1)\)的定义域为
  \ifshowsol
  \uline{\makebox[9em]{\(\brce{x \mid -1/2 \le x \le 0}\)}}．
  \else
  \uline{\makebox[9em]{}}．
  \fi

\item 函数\(y = a(x-2) + b + 3\)的图像可由函数\(y = ax + b\)的图像\uline{\makebox[4em]{}}得到．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 向左平移\(2\)个单位，向上平移\(3\)个单位
  \item 向左平移\(2\)个单位，向下平移\(3\)个单位
    \ifshowsol
  \item[\faCircle] 向右平移\(2\)个单位，向上平移\(3\)个单位
    \else
  \item 向右平移\(2\)个单位，向上平移\(3\)个单位
    \fi
  \item 向右平移\(2\)个单位，向下平移\(3\)个单位
  \end{itemize}

\item 下列各组函数中，两个函数相等的一组是\uline{\makebox[4em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(f(x) = \sqrt{x^2},\ g(x) = x\)
    \ifshowsol
  \item[\faCircle] \(f(x) = 3\ln x,\ g(x) = \ln x^3\)
    \else
  \item \(f(x) = 3\ln x,\ g(x) = \ln x^3\)
    \fi
  \item \(f(x) = \tan x,\ g(x) = \frac1{\cot x}\)
  \item \(f(x) = x - 3,\ g(x) = \frac{x^2-2x-3}{x+1}\)
  \end{itemize}
\end{enumerate}
\fi

\section{函数的运算\label{sec:funcops}}

\begin{definition}
  \label{defn:func4ops}
  设函数\(f(x)\)和\(g(x)\)的定义域分别为\(D_1\)和\(D_2\)，且\(D = D_1 \cap D_2\)非空．定义函数的四则运算为
  \begin{enumerate}
    \renewcommand{\labelenumi}{\enumparen{\arabic{enumi}}}
  \item 加减法\((\,f \pm g)(x) = f(x) \pm g(x),\ x \in D\);
  \item 乘法\((\,fg)(x) = f(x) \, g(x),\ x \in D\);
  \item 除法\((\,f/g)(x) = f(x) / g(x)\ (\,g(x) \ne 0),\ x \in D\)．
  \end{enumerate}
\end{definition}

\begin{example*}
  设\(f(x) = x + \sqrt x,\ g(x) = x - \sqrt x\)．
  经过函数的加法运算，有\((\,f+g)(x) = 2x,\ x \in \brktparen{0, +\infty}\)．
\end{example*}

\begin{definition*}
  设\(g\colon D_g \to Z_g,\ f\colon D_f \to Z_f\)且\(Z_g \subset D_f\)，那么对于任意的\(x \in D_g\)，函数值\(\,f\paren{g(x)}\)都是有意义的．定义函数\(\,f\)和\(g\)的复合为
  \[
    \begin{split}
      f \circ g\colon & D_g \to Z_f \\
      & x \mapsto f\paren{g(x)}.
    \end{split}
  \]

  \begin{remark}
    我们经常把条件放宽，只要\(Z_g \cap D_f \ne \emptyset\)，就可以定义复合函数，这个函数和上面的定义中的规则一样，只是定义域可能会变窄，即
    \[
      \begin{split}
        f \circ g\colon & \paren[\big]{\,f^{-1}(Z_g \cap D_f) \subset D_g} \to Z_f \\
        & x \mapsto f\paren{g(x)}.
      \end{split}
    \]
  \end{remark}
\end{definition*}

\begin{example*}
  设函数\(y = \sqrt u\)和\(u = 1+x^2\)．它们可以做复合运算得到\(y = \sqrt{1+x^2}\)．
\end{example*}

\begin{example*}
  设函数\(y = \arcsin u\)和\(u = 2+x^2\)．它们无法做这样的复合运算\(y = \arcsin(2+x^2)\)．
\end{example*}

\begin{definition}
  \label{defn:funcinv}
  设函数\(f\colon D \to Z_f\)和一对应关系\(g\)．若对任意的\(y \in Z_f\)，通过\(g\)找到唯一的\(x \in D\)，使得\(y = f(x)\)，则称\(g\)是\(f\)的反函数，记作\(f^{-1}\)．
\end{definition}

易知\(f(\,f^{-1}(x)) = f^{-1}(\,f(x)) = x\)．

\begin{theorem*}
  函数\(y = f(x)\)与其反函数\(y = f^{-1}(x)\)的图像关于直线\(y = x\)对称．
\end{theorem*}

\begin{theorem*}
  反函数存在的充分必要条件是这个函数是一一对应的．
\end{theorem*}

\begin{example*}
  求\(y = \sinh x = \frac12 (e^x - e^{-x})\)的反函数．

  \begin{remark}
    通过变形将\(x\)用\(y\)表出，有
    \begin{align*}
      y &= \frac{e^x - e^{-x}}{2} && \reason{原式} \\
      2y &= e^x - e^{-x} && \reason{同乘以\(2\)} \\
      0 &= \paren{e^{x}}^2- 2y\,e^x - 1 && \reason{同乘以\(e^x\)并移项} \\
      e^x &= y + \sqrt{y^2 + 1} && \reason{关于\(e^x\)解方程} \\
      x &= \ln\paren[\big]{y + \sqrt{y^2 + 1}}. && \reason{取对数}
    \end{align*}
    所以反函数是\(y = \arcsinh x = \ln\paren[\big]{x + \sqrt{x^2 + 1}}\)．
  \end{remark}
\end{example*}

\begin{definition*}
  反三角函数
  \begin{enumerate}
    \renewcommand{\labelenumi}{\enumparen{\arabic{enumi}}}
  \item 反正弦函数\(y = \arcsin x\)，定义域\(\brkt{-1, 1}\)，值域\(\brkt{-\frac\pi2, \frac\pi2}\);
  \item 反余弦函数\(y = \arccos x\)，定义域\(\brkt{-1, 1}\)，值域\(\brkt{0, \pi}\);
  \item 反正切函数\(y = \arcsin x\)，定义域\(\brkt{-\infty, +\infty}\)，值域\(\brkt{-\frac\pi2, \frac\pi2}\);
  \item 反余切函数\(y = \arccos x\)，定义域\(\brkt{-\infty, +\infty}\)，值域\(\brkt{0, \pi}\)．
  \end{enumerate}
  其中我们限制值域的范围叫做反三角函数的主值范围．
\end{definition*}

\subpdfbookmark{思考}{B1.1.3.P}
\subsection*{思考}

\begin{enumerate}
\item 复合函数\(f \circ g\)与\(g \circ f\)是否相等？

  \ifshowsolp
  不一定相等．
  \fi

\item 什么样的函数存在反函数？如何确定反函数的定义域和值域？

  \ifshowsolp
  一一对应的函数一定存在反函数．如果不是一一对应，那么至少也应该是单射的．这时，\(\ran f\)就是\(f^{-1}\)的定义域，\(f\)的定义域就是反函数的值域．如果连单射都不是，我们就要向反三角函数那样找到一个主分支，来构造反函数．
  \fi
\end{enumerate}

\ifshowex
\currentpdfbookmark{练习}{B1.1.3.E}
\subsection*{练习}

\begin{enumerate}
\item 设
  \[
    f(x) =
    \begin{cases}
      2e^{x-1}, & x < 2, \\
      \log_3(x^2-1), & x \ge 2,
    \end{cases}
  \]
  则\(f(\,f(2)) =\)
  \ifshowsol
  \uline{\makebox[3em]{\(2\)}}．
  \else
  \uline{\makebox[3em]{}}．
  \fi

\item 设\(f(x) = \cos x,\ f(\varphi(x)) = 1 - x^2\)，则\(\varphi(x)\)的定义域是
  \ifshowsol
  \uline{\makebox[6em]{\(\brkt[\big]{-\sqrt2, \sqrt2}\)}}．
  \else
  \uline{\makebox[6em]{}}．
  \fi

\item 下列各对函数\(y = f(u), u = g(x)\)中，可以复合成复合函数\(y = f(g(x))\)的是
  \uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
    \ifshowsol
  \item[\faCircle] \(f(u) = \sqrt{u^2 + 1},\ g(x) = e^x\)
    \else
  \item \(f(u) = \sqrt{u^2 + 1},\ g(x) = e^x\)
    \fi
  \item \(f(u) = \arccos(1+2u),\ g(x) = 1 + x^2\)
  \item \(f(u) = \sqrt{u+1},\ g(x) = \sin x - 3\)
  \item \(f(u) = \ln^2 u,\ g(x) = \arcsin x\)
  \end{itemize}

\item 函数\(y = e^{3x-1},\ x \in \brktparen{0, +\infty}\)的反函数为
  \ifshowsol
  \uline{\makebox[15em]{\(y = (1 + \ln x)/3,\ x \in \brktparen{e^{-1}, +\infty}\)}}．
  \else
  \uline{\makebox[15em]{}}．
  \fi

\item 求函数
  \[
    y =
    \begin{cases}
      1 + e^{-x}, & x \le 0, \\
      2 - 2x, & 0 < x < 1, \\
      2x - (1+x^2), & x \ge 1
    \end{cases}
  \]
  的反函数．

  \ifshowsol
  反函数为
  \[
    y =
    \begin{cases}
      -\ln\paren{x-1}, & x \ge 2, \\
      1 - \frac12 x, & 0 < x < 2, \\
      1 + \sqrt{-x}, & x \le 0.
    \end{cases}
  \]
  \fi

\item 已知\(f(\sin x) = 2 \ln \cos x + x\)，则\(f(x) =\)
  \ifshowsol
  \uline{\makebox[20em]{\(f(x) = \ln(1-x^2) + 2k\pi + \arcsin x,\ k \in \Z\)}}．
  \else
  \uline{\makebox[20em]{}}．
  \fi

\item 设
  \[
    f(x) =
    \begin{cases}
      x^2, & x \ge 0, \\
      2x - 1, & x < 0,
    \end{cases}
    \qquad
    g(x) =
    \begin{cases}
      -x^2, & x \le 1, \\
      \log_2(1+x), & x > 1,
    \end{cases}
  \]
  则\(f(g(0))\)和\(f(g(1))\)的值分别是
  \ifshowsol
  \uline{\makebox[3em]{\(0\)}}和\uline{\makebox[3em]{\(-3\)}}．
  \else
  \uline{\makebox[3em]{}}和\uline{\makebox[3em]{}}．
  \fi

\item 已知\(f(x-1) = \ln \dfrac{x^2+1}{x^2-3}\)．若\(f(g(x)) = x^2\)，则\(g(x)\)的定义域为
  \ifshowsol
  \uline{\makebox[10em]{\(\paren{-\infty, 0} \cup \paren{0, +\infty}\)}}．

  实际上，\(g\)是可以求出来的，就是
  \[
    g(x) = \pm \sqrt{\frac{3e^{x^2}+1}{e^{x^2}-1}} - 1.
  \]
  \else
  \uline{\makebox[10em]{}}．
  \fi

\item 已知\(f(x) = x^5 - a\)且\(f(-1) = 0\)．求\(f^{-1}(1) =\)
  \ifshowsol
  \uline{\makebox[3em]{\(0\)}}．
  \else
  \uline{\makebox[3em]{}}．
  \fi

\item 设函数\(y = f(x)\)的反函数为\(y = f^{-1}(x)\)且\(y = f(2x-1)\)的图像经过点\(\paren[\big]{\frac12, 1}\)．那么\(y = f^{-1}(x)\)的图像必过点
  \ifshowsol
  \uline{\makebox[3em]{\(\paren{1, 0}\)}}．
  \else
  \uline{\makebox[3em]{}}．
  \fi

\item 设函数\(f(x) = \log_a(x+b)\ (a > 0, a \ne 1)\)的图像经过点\(\paren{2,1}\)且其反函数的图像经过点\(\paren{2,8}\)．那么\(a + b =\)
  \ifshowsol
  \uline{\makebox[3em]{\(4\)}}．

  实际上，\(a = 3\)且\(b = 1\)．
  \else
  \uline{\makebox[3em]{}}．
  \fi

\item 设函数\(f(x) = \dfrac{2x+3}{x-1}\)且函数\(y = h(x)\)的图像与\(y = f^{-1}(x+1)\)的图像关于直线\(y = x\)对称．求\(h(3)\)的值．

  \ifshowsol
  这题相当于是求\(3 = f^{-1}(x+1)\)时\(x\)的值．有\(f(3) = f(\,f^{-1}(x+1)) = x+1 = \dfrac92\)，所以\(h(3) = \dfrac72\)．

  实际上，\(h(x) = 1 + \dfrac{5}{x-1}\)．
  \fi

\end{enumerate}
\fi

\section{函数的初等性质\label{sec:funcprops}}

\begin{definition*}
  设函数\(f\colon D \to Z_f\)\,．若\(\ran f \subset Z_f\)是有界集，则称\(f\)是有界函数，\(\ran f\)的界就是\(f\)在\(D\)上的界．
\end{definition*}

\begin{example*}
  证明\(f(x) = \dfrac1x\)在\(\paren{0,+\infty}\)上无界．

  \begin{proof}
    对于任意的\(M > 0\)，取\(x_0 = \frac1{2M}\)，则有\(x \in \paren{0,+\infty}\)且\(f(x_0) = 2M > M\)．
  \end{proof}
\end{example*}

\begin{definition*}
  设函数\(f\)的定义域关于原点对称．对于定义域上的任意\(x\)，函数\(f\)都满足\(f(-x) = -f(x)\)，这时\(f\)叫做奇函数．对于定义域上的任意\(x\)，函数\(f\)都满足\(f(-x) = f(x)\)，这时\(f\)叫做偶函数．
\end{definition*}

\hypertarget{T:evenodd}{}
\begin{theorem*}
  若一个函数的定义域对于原点对称，则这个函数可以唯一地分解成一个奇函数和一个偶函数的和的形式．

  \begin{proof}
    设函数\(f\)的定义域关于原点对称．易证\(\dfrac{f(x)+f(-x)}{2}\)是偶函数、\(\dfrac{f(x)-f(-x)}{2}\)是奇函数且
    \[
      \frac{f(x)+f(-x)}{2} + \frac{f(x)-f(-x)}{2} = f(x).
    \]
    这就证明了分解的存在性．此外，设偶函数\(s\)和奇函数\(t\)且\(f = s + t\)．那么
    \[
      f(x) + f(-x) = 2\fn s(x),
      \qquad
      f(x) - f(-x) = 2\fn t(x).
    \]
    这就证明了唯一性．
  \end{proof}
\end{theorem*}

\begin{example*}
  设函数\(f\)是奇函数，函数\(g(x) = \ln\paren[\big]{\,f(x) + \sqrt{\,f^2(x)+1}}\)．试讨论函数\(g\)的奇偶性．

  \begin{remark}
    因为
    \[
      \begin{split}
        g(-x)
        &= \ln\paren[\big]{\,f(-x) + \sqrt{\,f^2(-x)+1}} \\
        &= \ln\paren[\big]{\sqrt{\paren[\big]{-f(x)}^2+1} - f(x)} \\
        &= \ln\paren[\big]{\sqrt{\,f^2(x)+1} - f(x)} \\
        &= \ln{\frac{\paren[\big]{\sqrt{\,f^2(x)+1} + f(x)}\paren[\big]{\sqrt{\,f^2(x)+1} - f(x)}}{\sqrt{\,f^2(x)+1} + f(x)}} \\
        &= \ln \frac1{\sqrt{\,f^2(x)+1} + f(x)} \\
        &= -\ln{\,f(-x) + \sqrt{\,f^2(-x)+1}} \\
        &= -g(x),
      \end{split}
    \]
    所以\(g\)是奇函数．

    事实上，本例中的\(g\)和\(f\)的关系，可以用\(g(x) = \arcsinh f(x)\)来表示．那么自然有\(g(-x) = \arcsinh f(-x) = \arcsinh\paren[\big]{-f(x)} = - \arcsinh f(x) = -g(x)\)．
  \end{remark}
\end{example*}

\begin{definition*}
  设\(\,f\)是一个定义在\(\R\)上的函数．若存在正数\(T\)使得\(f(x+T) = f(x)\)恒成立，这时我们称\(f\)为周期函数．

  \begin{remark}
    通常我们提到函数的周期，是指函数的最小正周期，如果存在的话．并不是每个周期函数都有最小正周期的，比方说常函数和狄利克雷函数．
  \end{remark}
\end{definition*}

\begin{example*}
  设函数\(f\)的周期是\(2\)且\(g(x) = f\,\paren[\Big]{\dfrac{x+1}{2}}\)．试问函数\(g\)是否为周期函数？如果是，它的周期是多少？\rule{0ex}{3.5ex}

  \begin{remark}
    函数\(g\)的周期是\(4\)．
  \end{remark}
\end{example*}

\begin{definition}
  \label{defn:funcmono}
  对于任意的\(x_1 < x_2 \in D\)都有\(\,f(x_1) < f(x_2)\)成立，则称\(f\)单调递增（单增）．对于任意的\(x_1 < x_2 \in D\)都有\(\,f(x_1) > f(x_2)\)成立，则称\(f\)单调递减（单减）．
\end{definition}

\begin{theorem*}
  函数\(\,f\)单增的充要条件是：对于任意的\(x_1, x_2 \in D\)，当\(x_1 \ne x_2\)时，都有\(\paren[\big]{x_1 - x_2}\paren[\big]{\,f(x_1) - f(x_2)} > 0\)．
  函数\(\,f\)单减的充要条件是：对于任意的\(x_1, x_2 \in D\)，当\(x_1 \ne x_2\)时，都有\(\paren[\big]{x_1 - x_2}\paren[\big]{\,f(x_1) - f(x_2)} < 0\)．
\end{theorem*}

\begin{example*}
  证明\(f(x) = x^3\)是单调递增函数．

  \begin{proof}
    对于任意的\(x_1, x_2 \in D\)，当\(x_1 \ne x_2\)时，都有
    \[
      \begin{split}
        (x_1 - x_2) \paren[\big]{\,f(x_1) - f(x_2)}
        &= (x_1 - x_2) (x_1^3 - x_2^3) \\
        &= (x_1 - x_2)^2 (x_1^2 + x_1 x_2 + x_2^2) \\
        &> 0.
      \end{split}
    \]
    所以\(f\)是单增函数．
  \end{proof}
\end{example*}

\begin{definition*}
  设函数\(f\)是在\(\paren{a,b}\)上有定义．若对任意的\(x_1, x_2 \in \paren{a,b}\)和\(\alpha \in \paren{0,1}\)，当\(x_1 \ne x_2\)时都有
  \[
    f\,\paren[\big]{\alpha x_1 + (1-\alpha) x_2} < \alpha\,f(x_1) + (1-\alpha)\,f(x_2),
  \]
  则称\(f\)在\(\paren{a,b}\)上是下凸的．若对任意的\(x_1, x_2 \in \paren{a,b}\)和\(\alpha \in \paren{0,1}\)，当\(x_1 \ne x_2\)时都有
  \[
    f\,\paren[\big]{\alpha x_1 + (1-\alpha) x_2} > \alpha\,f(x_1) + (1-\alpha)\,f(x_2),
  \]
  则称\(f\)在\(\paren{a,b}\)上是上凸的．
\end{definition*}

\begin{example*}
  证明函数\(f(x) = x^2\)在\(\R\)上是下凸的．

  \begin{proof}
    对于任意的\(x_1, x_2 \in \R\)和\(\alpha \in \paren{0,1}\)，当\(x_1 \ne x_2\)时都有
    \[
      \begin{split}
        f\,\paren[\big]{\alpha x_1 + (1-\alpha) x_2}
        &= \paren[\big]{\alpha x_1 + (1-\alpha) x_2}^2 \\
        &= \alpha^2 x_1^2 + (1-\alpha)^2 x_2^2 + 2 \alpha (1-\alpha) x_1 x_2 \\
        &< \alpha^2 x_1^2 + (1-\alpha)^2 x_2^2 + \alpha (1-\alpha) (x_1^2 + x_2^2) \\
        &= \alpha x_1^2 + (1-\alpha) x_2^2 \\
        &= \alpha\,f(x_1) + (1-\alpha)\,f(x_2). \qedhere
      \end{split}
    \]
  \end{proof}
\end{example*}

\begin{example*}
  函数\(f\)在\(\paren{a,b}\)上下凸的充分必要条件是：对于任意互异的\(x, y, z \in \paren{a,b}\)和正数\(\alpha, \beta, \gamma\)，当\(\alpha+\beta+\gamma=1\)时都有
  \[
    f\paren{\alpha x + \beta y + \gamma z} < \alpha\,f(x) + \beta\,f(y) + \gamma\,f(z).
  \]

  \begin{proof}
    先证充分性．对于任意的\(x_1, x_2\)和满足\(\alpha+\beta=1\)的正数\(\alpha, \beta\)．三个点
    \[
      A\colon \paren[\big]{x_1, f(x_1)},\quad B\colon \paren[\big]{\alpha x_1 + \beta x_2, f(\alpha x_1 + \beta x_2)},\quad C\colon \paren[\big]{x_2, f(x_2)}
    \]
    必然不共线．因为当共线时，存在无数多组满足\(a+b+c=1\)的正数\(a, b, c\)使得
    \[
      f\,\paren[\big]{a x_1 + b\paren{\alpha x_1 + \beta x_2}  + c x_2} = a\,f(x_1) + b\,f(\alpha x_1 + \beta x_2) + c\,f(x_2).
    \]
    那么就可以在这三个点围成的三角形里面找到一个点\(D\)使得它的横坐标是\(\alpha x_1 + \beta x_2\)（这样的点有无数个）．选择一组满足\(a+b+c=1\)的正数\(a, b, c\)使得\(a x_1 + b\paren{\alpha x_1 + \beta x_2}  + c x_2 = \alpha x_1 + \beta x_2 \)，也就是
    \[
      D\colon \paren[\big]{\alpha x_1 + \beta x_2, a\,f(x_1) + b\,f(\alpha x_1 + \beta x_2) + c\,f(x_2)}.
    \]
    那么就有
    \[
      \begin{split}
        f(\alpha x_1 + \beta x_2)
        &= f\,\paren[\big]{a x_1 + b\paren{\alpha x_1 + \beta x_2}  + c x_2} \\
        &< a\,f(x_1) + b\,f(\alpha x_1 + \beta x_2) + c\,f(x_2) \\
        &< \alpha\,f(x_1) + \beta\,f(x_2).
      \end{split}
    \]
    这时可以判断点\(B\)位于线段\(\overline{AC}\)的下方，因为\(B\)的纵坐标小于\(D\)的纵坐标．因此，上面最后一个小于号成立．正数\(a, b, c\)可能的一组选择是
    \[
      a = \frac\alpha2,\ b = \frac12(\alpha x_1 + \beta x_2),\ c = \frac\beta2.
    \]

    再证必要性．对于任意互异的\(x, y, z \in \paren{a,b}\)和满足\(\alpha+\beta+\gamma=1\)的正数\(\alpha, \beta, \gamma\)，都有
    \[
      \begin{split}
        f(\alpha x + \beta y + \gamma z)
        &= f\,\brkt[\Big]{\paren{\alpha+\beta}\paren[\Big]{\frac{\alpha}{\alpha+\beta} x + \frac{\beta}{\alpha+\beta} y} + \gamma z} \\
        &< \paren{\alpha+\beta}\,f\,\paren[\Big]{\frac{\alpha}{\alpha+\beta} x + \frac{\beta}{\alpha+\beta} y} + \gamma\,f(z) \\
        &< \paren{\alpha+\beta}\paren[\Big]{\frac{\alpha}{\alpha+\beta}\,f(x) + \frac{\beta}{\alpha+\beta}\,f(y)} + \gamma\,f(z) \\
        &= \alpha\,f(x) + \beta\,f(y) + \gamma\,f(z). \qedhere
      \end{split}
    \]

    % 不失一般地，假设\(x < y < z\)．记\(\alpha x + \beta y + \gamma z\)为\(u\)．这时\(u\)不是落在区间\(\paren{x,y}\)就是落在\(\paren{y,z}\)上．无论落在哪个区间，都可以找到一组满足\(a+b=1\)的正数\(a, b\)，将\(u\)表示成\(a x + b y\)或者\(a y + b z\)的形式．又因为函数是下凸的，所以有
    % \[
    %   f(a x + b y) < a\,f(x) + b\,f(y)
    %   \quad
    %   \text{或者}
    %   \quad
    %   f(a y + b z) < a\,f(y) + b\,f(z).
    % \]
  \end{proof}
\end{example*}

\subpdfbookmark{思考}{B1.1.4.P}
\subsection*{思考}

\begin{enumerate}
\item 将任意一个定义在实数域上的函数\(f(x)\)分解成一个奇函数和一个偶函数之和．

  \ifshowsolp
  参见奇偶性定义后面的\hyperlink{T:evenodd}{定理}．
  \fi

\item 函数单调性是否是函数存在反函数的必要条件？

  \ifshowsolp
  不是．反例：函数\(y = 1/x\)在定义域上不是单调的，但是存在反函数且反函数就是它自己．
  \fi
\end{enumerate}

\ifshowex
\currentpdfbookmark{练习}{B1.1.4.E}
\subsection*{练习}

\begin{enumerate}
\item 下列函数中，在定义域上无界的是\uline{\makebox[4em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(f(x) = \dfrac1x \sin x\)
    \ifshowsol
  \item[\faCircle] \(f(x) = x^2 \sin \dfrac1x\)
    \else
  \item \(f(x) = x^2 \sin \dfrac1x\)
    \fi
  \item \(f(x) = \dfrac{\ln x}{1 + \ln^2 x}\)
  \item \(f(x) = \dfrac1{e^x + e^{-x}}\)
  \end{itemize}

\item 函数\(f(x) = x e^{\sin x} \tan x\)在其定义域上是\uline{\makebox[3em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 偶函数
    \ifshowsol
  \item[\faCircle] 无界函数
    \else
  \item 无界函数
    \fi
  \item 周期函数
  \item 单调函数
  \end{itemize}

\item 函数\(f\)的周期为\(T\)．那么函数\(h(x) = f(x+a)\)和\(g(x) = f(ax)\ (a > 0）\)的周期分别为
  \ifshowsol
  \uline{\makebox[3em]{\(T\)}}和\uline{\makebox[3em]{\(T/a\)}}．
  \else
  \uline{\makebox[3em]{}}和\uline{\makebox[3em]{}}．
  \fi

\item 设函数
  \[
    f(x) =
    \begin{cases}
      \sin x - x^2, & -\pi \le x < 0, \\
      \sin x + x^2, & 0 \le x \le \pi.
    \end{cases}
  \]
  那么\(f\)是一个\uline{\makebox[4em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
    \ifshowsol
  \item[\faCircle] 奇函数
    \else
  \item 奇函数
    \fi
  \item 无界函数
  \item 单调减函数
  \item 周期函数
  \end{itemize}

\item 设函数\(f, g\)都在\(\R\)上单调增加．下列函数中，在\(\R\)上单调增加的是\uline{\makebox[3em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(f(x) \cdot g(x)\)
    \ifshowsol
  \item[\faCircle] \(f(\,g(x))\)
    \else
  \item \(f(\,g(x))\)
    \fi
  \item \(f(-g(x))\)
  \item \(f(\,g(-x))\)
  \end{itemize}

\item 在\(\R\)上，\(f\)为奇函数，\(g\)为偶函数，则下列函数为奇函数的是\uline{\makebox[3em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(f(\,g(x))\)
  \item \(g(f(x))\)
    \ifshowsol
  \item[\faCircle] \(f(\,f(x))\)
    \else
  \item \(f(\,f(x))\)
    \fi
  \item \(g(\,g(x))\)
  \end{itemize}

\item 用\(y = \floor x\)表示取整函数．设\(f(x) = \cos\paren{\frac\pi2 \floor x}\)．那么\(f\)是\uline{\makebox[4em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 无界的奇函数
  \item 有界的偶函数
  \item 周期函数和偶函数
    \ifshowsol
  \item[\faCircle] 有界的周期函数
    \else
  \item 有界的周期函数
    \fi
  \end{itemize}

\item 下列函数中，哪一个是无界函数？
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(f(x) = \frac{x^2 + \sqrt{1+x^2}}{2 + x^2},\ x \in \R\)
  \item \(f(x) = \sgn x \cdot \sin \frac1x,\ x \ne 0\)
  \item \(f(x) = \frac{\floor x}{x},\ x > 0\)
    \ifshowsol
  \item[\faCircle] \(f(x) = \frac{x}{\ln x},\ x \in \paren{0,+\infty}\)
    \else
  \item \(f(x) = \frac{x}{\ln x},\ x \in \paren{0,+\infty}\)
    \fi
  \end{itemize}

\item 函数\(f\)和\(g\)是在\(\paren{a,b}\)上的单增函数．那么\(h_1(x) = \max\brce{\,f(x), g(x)},\ h_2(x) = -\min\brce{\,f(x), g(x)}\)分别为\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 单增函数，单增函数
    \ifshowsol
  \item[\faCircle] 单增函数，单减函数
    \else
  \item 单增函数，单减函数
    \fi
  \item 单减函数，单增函数
  \item 单减函数，单减函数
  \end{itemize}

\item 设函数\(f\)的定义域是\(\paren{0,+\infty}\)．若\(f(x)/x\)单调减少且\(a > 0,\ b > 0\)，则\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(f(a+b) < f(a)\)
    \ifshowsol
  \item[\faCircle] \(f(a+b) \le f(a) + f(b)\)
    \else
  \item \(f(a+b) \le f(a) + f(b)\)
    \fi
  \item \(f(a+b) \le a + b\)
  \item \(f(a+b) > f(a) + f(b)\)
  \end{itemize}
\end{enumerate}
\fi

\section{初等函数}

\begin{definition*}
  常函数、幂函数、指数函数、对数函数、三角函数、反三角函数，这六类函数叫做基本初等函数．
\end{definition*}

% http://projecteuclid.org/euclid.pjm/1102991609
% https://muleshko.faculty.unlv.edu/handouts/Elementary%20Functions%20(1).pdf
\begin{definition*}
  由基本初等函数经过有限次四则运算或函数复合得到的函数叫做初等函数\footnote{初等函数的概念最早是由法国数学家Joseph Liouville在讨论不定积分的代数解时引入的．}．
\end{definition*}

\begin{remark}
  常见的非初等函数有：分段函数、隐函数、参数方程确定的函数、变限定积分函数、参变量积分函数、函数项级数的和函数．
\end{remark}

\begin{definition*}
  双曲正弦、双曲余弦、双曲正切函数的定义分别是
  \[
    \sinh x \coloneq \frac{e^x-e^{-x}}{2},
    \quad
    \cosh x \coloneq \frac{e^x+e^{-x}}{2},
    \quad
    \tanh x \coloneq \frac{\sinh x}{\cosh x}.
    \rule[-2ex]{0pt}{0pt}
  \]
\end{definition*}

\begin{remark}
  关于双曲函数常见的关系式有：
  \begin{gather*}
    \cosh^2 x - \sinh^2 x = 1,
    \quad
    \sech^2 x + \tanh^2 x = 1, \\
    \cosh(x+y) = \cosh x \cosh y + \sinh x \sinh y, \\
    \sinh(x+y) = \sinh x \cosh y + \cosh x \sinh y.
  \end{gather*}
\end{remark}

\begin{remark}
  双曲线的一个分支可以用含双曲函数的参数方程来表示：
  \[
    \setlength{\abovedisplayskip}{.8ex}
    \setlength{\belowdisplayskip}{.8ex}
    x = a \cosh t,
    \quad
    y = b \sinh t.
  \]
\end{remark}

\hypertarget{defn:inversehyper}{}
\begin{definition*}
  双曲函数的反函数有：
  \[
    \addtolength{\jot}{.8ex}
    \begin{split}
      \arccosh x &\coloneq \ln\paren[\big]{x + \sqrt{x^2-1}}
      \quad\text{对于}\quad
      x \ge 1, \\
      \arcsinh x &\coloneq \ln\paren[\big]{x + \sqrt{x^2+1}}
      \quad\text{对于}\quad
      x \in \R, \\
      \arctanh x
      &\coloneq \frac12 \ln\frac{1+x}{1-x}
      = \frac12\brkt*{\ln(1+x) - \ln(1-x)}
      \quad\text{对于}\quad
      x^2 < 1, \\
      \arccoth
      &\coloneq \frac12 \ln\frac{1+x}{x-1}
      = \frac12 \brkt[\Big]{\ln\paren[\Big]{1+\frac1x} - \ln\paren[\Big]{1-\frac1x}}
      \quad\text{对于}\quad
      x^2 > 1.
      \rule[-2.5ex]{0ex}{0ex}
    \end{split}
  \]
\end{definition*}

\subpdfbookmark{思考}{B1.1.5.P}
\subsection*{思考}

\begin{enumerate}
\item 画出三角函数、反三角函数、双曲函数、反双曲函数的图像．

  \ifshowsolp
  \begin{figure}[H]
    \centering
    \begin{minipage}{2.5in}
      \tikzsetnextfilename{B1.1.5.P.1.1}
      \begin{tikzpicture}[smooth,domain=-6.6:6.6,samples=50,scale=0.4,font=\small]
        \draw[->] (-8,0) -- (8,0) node[right] {\(x\)};
        \draw[->] (0,-8) -- (0,8) node[above] {\(y\)};
        \draw[color=Dark2-A] plot (\x,{sin(\x r)}) node[right,color=.,yshift=.8ex] {\(y = \sin x\)};
        \draw[color=Dark2-B] plot (\x,{cos(\x r)}) node[right,color=.,yshift=1ex] {\(y = \cos x\)};
        \draw[color=Dark2-C,domain=-pi-1.4:-pi+1.4] plot (\x,{tan(\x r)});
        \draw[dotted] (-.5*pi,-6) -- (-.5*pi,6);
        \draw[color=Dark2-C,domain=-1.4:1.4] plot (\x,{tan(\x r)});
        \draw[dotted] (.5*pi,-6) -- (.5*pi,6);
        \draw[color=Dark2-C,domain=pi-1.4:pi+1.4] plot (\x,{tan(\x r)}) node[right,color=.] {\(y = \tan x\)};
      \end{tikzpicture}
      \caption*{三角函数}
    \end{minipage}
    \hfill
    \begin{minipage}{2.5in}
      \tikzsetnextfilename{B1.1.5.P.1.2}
      \begin{tikzpicture}[smooth,domain=-1:1,samples=50,scale=.8,font=\small]
        \draw[->] (-4,0) -- (4,0) node[right] {\(x\)};
        \draw[->] (0,-4) -- (0,4) node[above] {\(y\)};
        \draw[color=Dark2-A] plot (\x,{rad(asin(\x))}) node[anchor=south west,color=.,xshift=-2.2ex] {\(y = \arcsin x\)};
        \draw[color=Dark2-B] plot (\x,{rad(acos(\x))}) node[above,color=.,xshift=-1.2ex] at (-1,pi) {\(y = \arcsin x\)};
        \draw[dotted] (-3.5,-.5*pi) -- (3.5,-.5*pi);
        \draw[color=Dark2-C,domain=-3.5:3.5] plot (\x,{rad(atan(\x))}) node[anchor=north west,color=.,xshift=-2ex] {\(y = \arctan x\)};
        \draw[dotted] (-3.5,.5*pi) -- (3.5,.5*pi);
      \end{tikzpicture}
      \caption*{反三角函数}
    \end{minipage}
    \hspace*{.5in}
  \end{figure}
  \begin{figure}[H]
    \centering
    \begin{minipage}{2.5in}
      \tikzsetnextfilename{B1.1.5.P.1.3}
      \begin{tikzpicture}[smooth,domain=-2.7:2.7,samples=50,scale=0.4,font=\small]
        \draw[->] (-8,0) -- (8,0) node[right] {\(x\)};
        \draw[->] (0,-8) -- (0,8) node[above] {\(y\)};
        \draw[color=Dark2-A] plot (\x,{sinh(\x)}) node[anchor=south east,color=.] at (-2.7,{sinh(-2.7)}) {\(y = \sinh x\)};
        \draw[color=Dark2-B] plot (\x,{cosh(\x)}) node[anchor=north east,color=.] at (-2.7,{cosh(-2.7)}) {\(y = \cosh x\)};
        \draw[dotted] (-3.8,-1) -- (3.8,-1);
        \draw[color=Dark2-C,domain=-3.8:3.8] plot (\x,{tanh(\x)}) node[right,color=.] {\(y = \tanh x\)};
        \draw[dotted] (-3.8,1) -- (3.8,1);
      \end{tikzpicture}
      \caption*{双曲函数}
    \end{minipage}
    \hfill
    \begin{minipage}{2.5in}
      \tikzsetnextfilename{B1.1.5.P.1.4}
      \begin{tikzpicture}[smooth,domain=-7.4:7.4,samples=50,scale=0.4,font=\small]
        \draw[->] (-8,0) -- (8,0) node[right] {\(x\)};
        \draw[->] (0,-8) -- (0,8) node[above] {\(y\)};
        \draw[color=Dark2-A] plot (\x,{ln(\x+sqrt(\x*\x+1))}) node[below,color=.,xshift=2ex] at (-7.4,-2.7) {\(y = \arcsinh x\)};
        \draw[color=Dark2-B,domain=1:7.4] plot (\x,{ln(\x+sqrt(\x*\x-1))}) node[anchor=south west,color=.,xshift=1ex] at (1,0) {\(y = \arccosh x\)};
        \draw[dotted] (-1,-3.8) -- (-1,3.8);
        \draw[color=Dark2-C,domain=-.999:.999] plot (\x,{ln((1+\x)/(1-\x))/2}) node[anchor=south west,color=.,xshift=-1.5ex] {\(y = \arctanh x\)};
        \draw[dotted] (1,-3.8) -- (1,3.8);
      \end{tikzpicture}
      \caption*{反双曲函数}
    \end{minipage}
    \hspace*{.5in}
  \end{figure}
  \fi

\item 能否写出反双曲函数与对数函数的关系式．

  \ifshowsolp
  参见反双曲函数的\hyperlink{defn:inversehyper}{定义}．
  \fi
\end{enumerate}

\ifshowex
\currentpdfbookmark{练习}{B1.1.5.E}
\subsection*{练习}

\begin{enumerate}
\item 下列各组函数中，两个函数相同的一组是\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(y = \arcsin(\cos x),\ y = \arccos(\sin x)\)
    \ifshowsol
  \item[\faCircle] \(y = \sin(\arccos x),\ y = \cos(\arcsin x)\)
    \else
  \item \(y = \sin(\arccos x),\ y = \cos(\arcsin x)\)
    \fi
  \item \(y = \arctan x,\ y = \arccot\frac1x\)
  \item \(y = \sin(\arcsin x),\ y = \tan(\arctan x)\)
  \end{itemize}

  \ifshowsol
  选项~C和~D中的函数都是因为定义域的不同而导致函数不同的．
  \fi

\item 函数\(y = \cos x\ (\pi \le x \le 2\pi)\)的反函数是\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(y = \pi + \cos x\)
  \item \(y = \frac52\pi - \arcsin x\)
    \ifshowsol
  \item[\faCircle] \(y = \frac32\pi + \arcsin x\)
    \else
  \item \(y = \frac32\pi + \arcsin x\)
    \fi
  \item \(y = \pi - \arccos x\)
  \end{itemize}

\item 设\(f\)是在\(\R\)上的减函数．若\(a + b \le 0\)，则\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(f(a) + f(b) \le -\paren[\big]{\,f(a) + f(b)}\)
  \item \(f(a) + f(b) \le f(-a) + f(-b)\)
  \item \(f(a) + f(b) \ge -\paren[\big]{\,f(a) + f(b)}\)
    \ifshowsol
  \item[\faCircle] \(f(a) + f(b) \ge f(-a) + f(-b)\)
    \else
  \item \(f(a) + f(b) \ge f(-a) + f(-b)\)
    \fi
  \end{itemize}

  \ifshowsol
  选项~A和~C都可以通过举反例来证伪，比方说\(f(x) = \arccot x\)证伪了~A，\(f(x) = -\pi + \arccot x\)证伪了~C．对于~B和~D，可以根据\(a + b \le 0\)的性质来说明．两个数的和非正，这就说明至少其中有一个数非正．当另外一个数也是非正的时候，易证~D成立．当另外一个数是正数的时候，不失一般地，不妨假设\(a \le 0 < b\)，那么有\(a \le -b < 0 < b \le -a\)．所以有
  \[
    f(a) \ge f(-b) > f(b) \ge f(-a).
  \]
  因此~D成立．
  \fi

\item 曲线\(y = \frac{2^x-2^{-x}}{2^x+2^{-x}}\)与曲线\(y = f(x)\)的图像关于直线\(y = x\)对称．求\(f(x) =\)
  \ifshowsol
  {\setlength{\ULdepth}{1.5ex}\uline{\makebox[6em]{\(\frac12 \log_2\frac{1+x}{1-x}\)}}}．
  \else
  \uline{\makebox[6em]{}}．
  \fi

\item 设
  \[
    f(x) =
    \begin{cases}
      \log_2 (4-x), & x \le 0, \\
      \,f(x-1) - f(x-2), & x > 0.
    \end{cases}
  \]
  求\(f(3) =\)\uline{\makebox[3em]{\ifshowsol\(-2\)\fi}}．

\item 下列恒等式中，不正确的是\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(\sinh(x \pm y) = \sinh x \cosh y \pm \cosh x \sinh y\)
  \item \(\arcsinh x = \ln\paren[\big]{x + \sqrt{1+x^2}}\)
  \item \(\tanh x = \frac{e^x-e^{-x}}{e^x+e^{-x}}\)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(\arctanh x = \frac12 \ln\frac{1-x}{1+x}\)
  \end{itemize}
\end{enumerate}
\fi

\section{极坐标方程与参数方程表示的几种曲线}

\begin{definition*}
  平面上任意一点，除了可以用直角坐标系来表示，也可由极坐标系来表示．极坐标由半径坐标\(r\)和角坐标\(\theta\)构成，它们和直角坐标的关系可以用等式
  \[
    x = r \cos\theta \quad \text{和} \quad y = r \sin \theta
  \]
  来确定\footnote{极坐标的概念最早可以追溯到古希腊，文艺复兴以来通过类似极坐标变换的方法来求阿基米德螺线面积的方法，最早可以追溯到Cavalieri和Gregory of St.~Vincent．}\textsuperscript{,}\footnote{有些人也会用\(\rho\)来表示半径坐标，用\(\phi,\ \varphi\)或\(t\)来表示角坐标．角坐标又叫作极角．}．
  其中\(r\)表示点到原点的半径距离，\(\theta\)表示点到\(x\)轴正方向上逆时针的角度．
\end{definition*}

一般来说，如果不加任何限制，平面上一点的极坐标不唯一．可以通过
\[
  r = \sqrt{x^2 + \smash{y^2}} \quad \text{和} \quad \theta = \atantwo(y,x)
\]
将直角坐标转换成极坐标．

\begin{definition*}
  圆的极坐标方程是
  \[
    r = a
  \]
  其中\(a\)为圆的半径．
\end{definition*}

\begin{definition*}
  心形线\footnote{心形线的概念最早是由Ole Rømer于1674年在研究齿轮轮齿的最优形状时提出来的．}（cardioid）的极坐标方程是
  \[
    \setlength{\abovedisplayskip}{.8ex}
    \setlength{\belowdisplayskip}{.8ex}
    r = 2a (1-\cos\theta).
  \]
\end{definition*}

\begin{remark}
  这个心形线的开口向着\(x\)轴的正方向，如下图．
\end{remark}

\begin{figure}[H]
  \centering
  \tikzsetnextfilename{B1.1.6.1}
  \begin{tikzpicture}[domain=0:360,smooth,samples=50]
    \draw[->] (-3,0) -- (3,0) node[right] {\(x\)} node[left] at (-3,0) {\hphantom{\(x\)}};
    \draw[->] (0,-3) -- (0,3) node[above] {\(y\)};
    \draw[color=Dark2-C] (-1,0) circle (1);
    \draw[color=Dark2-B] plot (\x:{2*(1-cos(\x))});
    \path plot (\x:{2*(1+cos(\x))});
    \draw[dotted] (1,0) circle (1);
    \draw[dotted] ({2*cos(70)-1},{2*sin(70)}) circle (1);
    \draw[dotted] ({2*cos(135)-1},{2*sin(135)}) circle (1);
    \draw[dotted] ({2*cos(210)-1},{2*sin(210)}) circle (1);
    \fill[color=Dark2-D] (0,0) circle (1pt)
    (70:{2*(1-cos(70))}) circle (1pt)
    (135:{2*(1-cos(135))}) circle (1pt)
    (210:{2*(1-cos(210))}) circle (1pt);
  \end{tikzpicture}
  \caption*{心形线}
\end{figure}

\begin{definition*}
  伯努利双纽线\footnote{Jacob Bernoulli于1694年在\textit{Acta Eruditorum}上发表的一篇文章描述了这种曲线．}（lemniscate of Bernoulli）的极坐标方程是
  \[
    r^2 = a^2 \cos 2\theta, \quad a = \sqrt2\,c.
  \]
  其中\(c\)是焦点到原点的距离，\(a\)是双纽线的半宽度．
\end{definition*}

\begin{figure}[H]
  \centering
  \tikzsetnextfilename{B1.1.6.2}
  \begin{tikzpicture}[smooth,samples=50]
    \draw[->] (-3,0) -- (3,0) node[right] {\(x\)} node[left] at (-3,0) {\hphantom{\(x\)}};
    \draw[->] (0,-3) -- (0,3) node[above] {\(y\)};
    \draw[color=Dark2-C] plot[domain=-45:45] (\x:{2*sqrt(2)*sqrt(cos(2*\x))})
    plot[domain=135:225] (\x:{2*sqrt(2)*sqrt(cos(2*\x))});
    \draw[dashed] (-2,0) -- (20:{2*sqrt(2)*sqrt(cos(2*20))}) -- (2,0);
    \fill[color=Dark2-D]
    (-2,0) circle (1pt)
    node[below,color=.] {\(F_1\)}
    (2,0) circle (1pt)
    node[below,color=.] {\(F_2\)}
    (20:{2*sqrt(2)*sqrt(cos(2*20))}) circle (1pt)
    node[above,color=.] {\(P\)};
    \node at (-1.75,2) {\(PF_1 \cdot PF_2 = c^2\)};
  \end{tikzpicture}
  \caption*{伯努利双纽线}
\end{figure}

\begin{definition*}
  阿基米德螺线\footnote{阿基米德（Archimedes of Syracuse）在公元前约225年的著作《论螺线》上研究了这种由Conon发现的曲线．}（Archimedean spiral）的参数方程是
  \[
    \setlength{\abovedisplayskip}{.8ex}
    \setlength{\belowdisplayskip}{.8ex}
    x = at \cos t, \quad y = at \sin t.
  \]

  \begin{remark}
    实际上，它的极坐标方程更为简洁\(r = a \theta\)．
  \end{remark}
\end{definition*}

\begin{figure}[H]
  \centering
  \tikzsetnextfilename{B1.1.6.3}
  \begin{tikzpicture}[smooth,samples=50]
    \draw[->] (-4,0) node[left] {\hphantom{\(x\)}} -- (4,0) node[right] {\(x\)};
    \draw[->] (0,-4) -- (0,4) node[above] {\(y\)};
    \draw[dotted] plot[domain=0:-1080] (\x:{.2*rad(\x)});
    \draw[color=Dark2-C] plot[domain=0:1080] (\x:{.2*rad(\x)});
  \end{tikzpicture}
  \caption*{阿基米德螺线}
\end{figure}

\begin{definition*}
  摆线\footnote{旋轮线的概念是由Charles de Bovelles于1501年在做化圆为方的时候提出来的．伽利略最早严肃地研究了这种曲线．笛卡尔、费马、帕斯卡、惠更斯、莱布尼茨、伯努利兄弟等17世纪的数学大师们都研究过这种曲线，还由此生出种种龃龉．}（又称旋轮线、圆滚线）（cycloid）的参数方程是
  \[
    \setlength{\abovedisplayskip}{.8ex}
    x = a (t - \sin t), \quad y = a (1 - \cos t).
  \]
\end{definition*}

\begin{figure}[H]
  \centering
  \tikzsetnextfilename{B1.1.6.4}
  \begin{tikzpicture}[smooth,samples=50]
    \draw (-1,0) -- (4*pi+1,0);
    \foreach \x in {0,.8,1.6,2.4,3.2,4} {
      \pgfmathsetmacro\theta{\x*pi}
      \draw[dotted] (\theta,1) circle (1);
      \draw ({\theta - sin(\theta r)},{1 - cos(\theta r)}) -- (\theta,1);
      \fill[color=Dark2-D]
      ({\theta - sin(\theta r)},{1 - cos(\theta r)}) circle (1pt)
      (\theta,1) circle (1pt);
    }
    \draw[color=Dark2-C,domain=0:4*pi] plot ({\x - sin(\x r)},{1 - cos(\x r)});
  \end{tikzpicture}
  \caption*{旋轮线}
\end{figure}

\begin{definition*}
  星形线\footnote{星形线的概念最早也是由Ole Rømer于1674年在研究齿轮轮齿的最优形状时提出来的．后来的伯努利父子、莱布尼茨、达朗贝尔都研究过这种曲线．}（astroid）的参数方程是
  \[
    \left\{
      \addtolength{\jot}{1ex}
      \begin{alignedat}{2}
        x &= a \cos^3 t &&= \frac a4 \paren{3 \cos t + \cos 3t}, \\
        y &= a \sin^3 t &&= \frac a4 \paren{3 \sin t - \sin 3t}.
      \end{alignedat}
    \right.
  \]
\end{definition*}

\begin{remark}
  莱布尼茨1715年给出了这个曲线的标准方程\(x^{2/3} + y^{2/3} = a^{2/3}\)．
\end{remark}

\begin{figure}[H]
  \centering
  \tikzsetnextfilename{B1.1.6.5}
  \begin{tikzpicture}[smooth,samples=50]
    \draw[color=Dark2-C] circle (4);
    \foreach \x in {0,1,2,3,4,5,-3,-2,-1} {
      \pgfmathsetmacro\theta{\x*acos(7/9)}
      \draw[dotted] ({3*cos(\theta)},{3*sin(\theta)}) circle (1);
      \draw ({3*cos(\theta)},{3*sin(\theta)})
      -- ({4*pow(cos(\theta),3)},{4*pow(sin(\theta),3)});
      \fill[color=Dark2-D]
      ({3*cos(\theta)},{3*sin(\theta)}) circle (1pt)
      ({4*pow(cos(\theta),3)},{4*pow(sin(\theta),3)}) circle (1pt);
    }
    \draw[color=Dark2-B,domain=0:360]
    plot ({4*pow(cos(\x),3)},{4*pow(sin(\x),3)});
  \end{tikzpicture}
  \caption*{星形线}
\end{figure}

\chapter{极限论}

\section{数列极限的概念与性质}

\begin{definition*}
  将一些数编好号后，按其编号从小到大排成一列，称为数列，记作\(a_1, a_2, \dots, a_n, \dots\)或\(\Seq{a_n}\)．
\end{definition*}

\begin{definition*}
  从数列\(\Seq{a_n}\)中取出某些项后，按原来的顺序排成一个新的数列，称此数列为原数列\(\brce{a_n}\)的一个子列，记作\(\Seq{a_{n_k}}\)，其中\(n_k \ge k,\ n_{k+1} > n_k\)．
\end{definition*}

\begin{definition*}
  设\(\Seq{a_n}\)是一个数列，\(A\)是一个常数．对于任意的\(ε > 0\)都存在正整数\(N > 0\)使得当\(n > N\)时都有\(\abs*{a_n - A} < ε\)成立．这时，我们称\(A\)是数列\(\Seq{a_n}\)的极限，记作\(\displaystyle \lim_{n\to\infty} a_n = A\)．

  \begin{remark}
    可以用形式化的符号来表示上述定义，即
    \[
      \lim_{n\to\infty} a_n = A \iff
      \paren[\big]{\forall ε > 0}
      \paren[\big]{\exists N > 0}
      \paren[\big]{\forall n > N}
      \paren[\big]{\abs[\big]{a_n - A} < ε}.
    \]
    它的否定形式就是
    \[
      \lim_{n\to\infty} a_n \ne A \iff
      \paren[\big]{\exists ε > 0}
      \paren[\big]{\forall N > 0}
      \paren[\big]{\exists n > N}
      \paren[\big]{\abs[\big]{a_n - A} \ge ε}.
    \]
  \end{remark}
\end{definition*}

\begin{example*}
  \(\displaystyle \lim_{n\to\infty} \paren[\Big]{1+\frac1n} = 1\).

  \begin{proof}
    取\(N = \ceil{\frac1ε}\)即可．
  \end{proof}
\end{example*}

\begin{example*}
  \(\displaystyle \lim_{n\to\infty} q^n = 0\ (\abs{q} < 1)\).

  \begin{proof}
    取\(N = \maxb*{1, \ceil*{\ln ε /\! \ln\abs q}}\)即可．
  \end{proof}
\end{example*}

\begin{example*}
  \(\displaystyle \lim_{n\to\infty} a^{1/n} = 1\ (a > 1)\).

  \begin{proof}
    取\(N = \ceil*{\ln a /\! \lnp{1+ε}}\)即可．
  \end{proof}

  \begin{proof}
    第二种方法就是把\(a^{1/n}\)分解成一个常数与一个无穷小量和的形式．因为\(a > 1\)，所以\(a^{1/n} > 1\)．令\(ε_n = a^{1/n} - 1\)，就有
    \begin{align*}
      a^{1/n}
      &= 1 + ε_n
      && \reason{移项} \\
      a
      &= (1 + ε_n)^n
      && \reason{取\(n\)次幂} \\
      &= 1 + nε_n + \sum_{k=2}^n \binom{n}{k} ε_n^k
      && \reason{二项式定理} \\
      &> nε_n.
    \end{align*}
    因此，
    \begin{equation*}
      \paren[\big]{\forall ε > 0}
      \paren[\big]{\exists N = \ceil*{\frac aε} > 0}
      \paren[\big]{\forall n > N}
      \paren[\big]{\abs[\big]{a^{1/n} - 1} = ε_n < \frac an < ε}.
      \qedhere
    \end{equation*}
  \end{proof}
\end{example*}

\begin{example*}
  若\(\displaystyle \lim_{n\to\infty} a_n = A\)，则\(\displaystyle \lim_{n\to\infty} \abs*{a_n} = \abs*{A}\)．

  \begin{proof}
    因为\(\displaystyle \lim_{n\to\infty} a_n = A\)，所以
    \begin{equation*}
      \paren[\big]{\forall ε > 0}
      \paren[\big]{\exists N > 0}
      \paren[\big]{\forall n > N}
      \paren[\big]{\abs[\big]{a_n - A} < ε}.
    \end{equation*}
    由反三角不等式
    \begin{equation*}
      \abs*{\abs{a_n} - \abs A} \le \abs*{a_n - A}
    \end{equation*}
    可知，取同样的\(N\)即可．
  \end{proof}
\end{example*}

\begin{example}
  \label{eg:limavg}
  若\(\displaystyle \lim_{n\to\infty} a_n = A\)，则\(\displaystyle \lim_{n\to\infty} \frac{a_1 + a_2 + \dots + a_n}{n} = A\)．

  \begin{proof}
    对于任意的\(ε > 0\)，因为\(\displaystyle \lim_{n\to\infty} a_n = A\)，所以存在正整数\(N_0\)使得当\(n > N_0\)时都有
    \begin{align*}
      \abs[\bigg]{\frac{a_1 + a_2 + \dots + a_n}{n} - A}
      &= \abs[\bigg]{\frac{a_1 + a_2 + \dots + a_n - nA}{n}} \\
      &= \abs[\bigg]{\frac{(a_1-A) + (a_2-A) + \dots + (a_n-A)}{n}} \\
      &\le \frac{\abs*{a_1-A} + \abs*{a_2-A} + \dots + \abs*{a_n-A}}{n} \\
      &= \frac{\abs*{a_1-A} + \dots + \abs*{a_{N_0}-A}}{n}
        + \frac{\abs*{a_{N_0+1}-A} + \dots + \abs*{a_n-A}}{n} \\
      &< \frac{N_0 \maxb{a_1-A, \dots, a_{N_0}-A}}{n} + \frac{(n-N_0)ε}{n} \\
      &< \frac{N_0 \maxb{a_1-A, \dots, a_{N_0}-A}}{n} + ε.
    \end{align*}
    此时，取\(N = \maxb[\Big]{N_0, \ceil[\Big]{\frac{N_0 \maxb{a_1-A, \dots, a_{N_0}-A}}{ε}}}\)，当\(n > N\)时都有
    \begin{equation*}
      \abs*{\frac{a_1 + a_2 + \dots + a_n}{n} - A}
      < 2ε. \qedhere
    \end{equation*}
  \end{proof}
\end{example}

\begin{theorem*}
  若极限\(\displaystyle \lim_{n\to\infty} a_n\)存在，则其值唯一．

  \begin{proof}
    假设\(A_1\)和\(A_2\)都是数列\(\Seq{a_n}\)的极限且\(A_1 \ne A_2\)．那么对于任意的\(ε > 0\)，就可以找到正整数\(N_1\)和\(N_2\)，当\(n > N_1\)时都有\(\abs*{a_n - A_1} < ε\)，当\(n > N_2\)时都有\(\abs*{a_n - A_2} < ε\)．这时，取\(N = \maxb{N_1, N_2}\)，当\(n > N\)时都有
    \begin{gather*}
      2\abs[\bigg]{a_n - \frac{A_1+A_2}{2}} = \abs[\big]{2a_n - (A_1+A_2)} \le \abs[\big]{a_n - A_1} + \abs[\big]{a_n - A_2} < 2ε, \\
      \intertext{即}
      \abs[\bigg]{a_n - \frac{A_1+A_2}{2}} < ε.
    \end{gather*}
    这就说明\(\frac{A_1+A_2}{2}\)也是数列\(a_n\)的一个极限．那么对于任意的\(0 < ε \le \frac{\abs*{A_1-A_2}}{2}\)，也能找到这样的正整数\(N\)使得当\(n > N\)时上述几个不等式都成立．但是这是不可能的，因为不论\(a_n\)多大，到\(A_1\)和\(A_2\)的距离，其中之一必然大于\(ε\)．因此，\(A_1 = A_2\)．
  \end{proof}
\end{theorem*}

\begin{theorem}
  \label{thm:cvgbnd}
  若数列\(\Seq{a_n}\)收敛，则其有界．

  \begin{proof}
    假设数列\(\Seq{a_n}\)收敛于\(A\)．任取一个\(ε > 0\)，则存在正整数\(N\)使得当\(n > N\)时都有\(\abs*{a_n - A} < ε\)，即
    \begin{equation*}
      A - ε < a_n < A + ε
    \end{equation*}
    此时，\(\maxb*{\abs{A+ε}, \abs{A-ε}, \abs{a_1}, \dots, \abs{a_N}}\)就是数列\(\Seq{a_n}\)的一个界．
  \end{proof}
\end{theorem}

\begin{theorem*}[保号性]
  若\(\displaystyle \lim_{n\to\infty} a_n = A\)且\(A > 0\)，则存在正整数\(N\)使得当\(n > N\)时都有\(a_n > 0\)； 若\(a_n \ge 0\)且\(\displaystyle \lim_{n\to\infty} a_n\)存在，则\(\displaystyle \lim_{n\to\infty} a_n \ge 0\)．

  \begin{proof}
    对前一个命题的证明：取\(ε = A\)时，能找到一个正整数\(N\)使得当\(n > N\)时都有\(\abs*{a_n - A} < A\)，即\(0 < a_n < 2\,A\)．对后一个命题的证明：假设\(\displaystyle \lim_{n\to\infty} a_n < 0\)，那么根据前一个命题，就存在正整数\(N\)使得当\(n > N\)时都有\(a_n < 0\)，这和\(a_n \ge 0\)是矛盾的，所以\(\displaystyle \lim_{n\to\infty} a_n \ge 0\)．
  \end{proof}
\end{theorem*}

\begin{theorem}[数列极限的四则运算]
  \label{thm:seq4ops}
  设\(\displaystyle \lim_{n\to\infty} a_n = A\)和\(\displaystyle \lim_{n\to\infty} a_n = A\)，则
  \begin{enumerate}
    \renewcommand{\labelenumi}{\enumparen{\arabic{enumi}}}
  \item \(\displaystyle \lim_{n\to\infty} \paren{a_n \pm b_n} = A \pm B\)；
  \item \(\displaystyle \lim_{n\to\infty} a_n b_n = AB\)；
  \item \(\displaystyle \lim_{n\to\infty} \tfrac{a_n}{b_n} = \tfrac AB\ (B \ne 0)\)．
  \end{enumerate}

  \begin{proof}
    对加减法的证明：利用绝对值的三角不等式．对于任意的\(ε\)都能找到\(N_1\)和\(N_2\)使得当\(n > N_1\)时都有\(\abs*{a_n-A} < ε\)和当\(n > N_2\)时都有\(\abs*{b_n-B} < ε\)．取\(N = \maxb{N_1, N_2}\)，就有
    \begin{equation*}
      \abs*{\paren{a_n \pm b_n} - \paren{A \pm B}}
      = \abs*{a_n - A \pm b_n \mp B}
      = \abs*{\paren{a_n - A} \pm \paren{b_n - B}}
      \le \abs*{a_n - A} + \abs*{b_n - B}
      < 2ε.
    \end{equation*}
    对乘法的证明：由于定理~\ref{thm:cvgbnd}，可以找到数列\(b_n\)的一个界\(M > 0\)．对于任意的\(ε\)都能找到\(N_1\)和\(N_2\)使得当\(n > N_1\)时都有\(\abs*{a_n-A} < ε\)和当\(n > N_2\)时都有\(\abs*{b_n-B} < ε\)．取\(N = \maxb{N_1, N_2}\)，就有
    \begin{align*}
      \abs*{a_n b_n - AB}
      &= \abs*{a_n b_n - Ab_n + Ab_n - AB} \\
      &= \abs*{\paren{a_n - A}b_n + A\paren{b_n - B}} \\
      &\le \abs*{a_n-A}\abs*{b_n} + \abs*{A}\abs*{b_n-B} \\
      &\le M\abs*{a_n-A} + \abs*{A}\abs*{b_n-B} \\
      &< \paren*{M + \abs*{A}}ε.
    \end{align*}
    对除法的证明：只需证明\(\lim\limits_{n\to\infty} \frac1{b_n} = \frac1B\)，再利用一次极限的乘法运算即可．对于任意的\(ε\)都能找到一个\(N_1\)使得当\(n > N_1\)时都有\(\abs*{b_n-B} < ε\)．又由于\(B \ne 0\)，可以找到一个正整数\(N_2\)使得\(\inf\limits_{\,\mathclap{n > N_2}}\Set*{\abs{b_n}} > 0\)．取\(N = \maxb{N_1, N_2}\)，就有
    \begin{equation*}
      \abs[\bigg]{\frac1{b_n} - \frac1B}
      = \abs[\bigg]{\frac{B - b_n}{b_n B}}
      \le \frac{\abs*{b_n - B}}{\abs*{B}
        \cdot \inf\limits_{\,\mathclap{n > N_2}}\Set*{\abs{b_n}}}
      < \frac{ε}{\abs*{B} \cdot \inf\limits_{\,\mathclap{n > N_2}}\Set*{\abs{b_n}}}.
      \qedhere
    \end{equation*}
  \end{proof}
\end{theorem}

\begin{definition*}
  对于任意的正数\(M\)都有正整数\(N\)使得当\(n > N\)时都有\(\abs*{a_n} > M\)．这时，我们称数列\(\Seq{a_n}\)为无穷大量，记作\(\lim\limits_{n\to\infty} a_n = \infty\)．
\end{definition*}

可以用形式化的符号来表示无穷大量的定义，即
\begin{alignat*}{2}
  \lim_{n\to\infty} a_n &= \infty &{}\iff{}
  &\paren[\big]{\forall M > 0}
  \paren[\big]{\exists N > 0}
  \paren[\big]{\forall n > N}
  \paren[\big]{\abs[\big]{a_n} > M}, \\
  \lim_{n\to\infty} a_n &= +\infty &{}\iff{}
  &\paren[\big]{\forall M > 0}
  \paren[\big]{\exists N > 0}
  \paren[\big]{\forall n > N}
  \paren[\big]{a_n > M}, \\
  \lim_{n\to\infty} a_n &= -\infty &{}\iff{}
  &\paren[\big]{\forall M > 0}
  \paren[\big]{\exists N > 0}
  \paren[\big]{\forall n > N}
  \paren[\big]{-a_n > M}.
\end{alignat*}
其中，\(+\infty\)叫作正无穷大量，\(-\infty\)叫作负无穷大量．

\begin{definition*}
  极限为\(0\)的数列叫作无穷小量．
\end{definition*}

\begin{example*}
  非零无穷小量的倒数是无穷大量．

  \begin{proof}
    设\(\lim\limits_{n\to\infty} a_n = 0\)且\(a_n \ne 0\)．对于任意的\(M > 0\)，取\(ε = 1/M > 0\)，能找到一个正整数\(N\)使得当\(n > N\)时都有
    \begin{equation*}
      \abs*{a_n} < ε
      \implies
      \abs[\bigg]{\frac{1}{a_n}} = \frac{1}{\abs*{a_n}} > \frac1ε = M.
      \qedhere
    \end{equation*}
  \end{proof}
\end{example*}

\begin{example*}
  无界数列存在为无穷大量的子列．

  \begin{proof}
    设数列\(\Seq{a_n}\)无界．证明分为两步，首先构造一个子列\(\Seq{a_{n_k}}\)，然后说明这个子列是无穷大量．子列的构造过程是递推的．因为数列无界，所以能找到一个\(n_1\)使得\(\abs[\big]{a_{n_1}} > 1\)．假设子列的前\(k\)项都已经构造好了．因为数列无界，所以能找到一个\(n_{k+1} > n_k\)使得\(\abs[\big]{a_{n_{k+1}}} > k+1\)．如果不是这样，\(\maxb*{\abs[\big]{a_1}, \abs[\big]{a_2}, \dots, \abs[\big]{a_{n_k}}, k+1}\)就是原数列的一个界，矛盾．子列构造完毕．下面证明这个子列是无穷大量．对于任意的\(M > 0\)都能找到一个\(K = \ceil{M}\)使得当\(k > K\)时都有\(\abs[\big]{a_{n_k}} > k > K \ge M\)．
  \end{proof}
\end{example*}

\subpdfbookmark{思考}{B1.2.1.P}
\subsection*{思考}

\begin{enumerate}
\item 在数列极限的定义中，\(ε\)是不是一个无限小的正数？正整数\(N\)的选取是不是与\(ε\)有关？

  \ifshowsolp
  对\(ε\)来讲，就是一个任意的正实数，一旦给定，就确定下来了．题目中的无限小的正数，在标准实分析里是不存在的．正整数\(N\)的选取当然是和\(ε\)有关，有时候为了分析方便，还会给\(N\)标上下标\(N_ε\)．
  \fi

\item 在数列极限的定义中，如果将\(n > N\)改成\(n \ge N\)，是否有影响？如果将\(\forall ε > 0\)改成\(\forall ε \in \paren{0,1}\)，是否有影响？

  \ifshowsolp
  都不影响．
  \fi
\end{enumerate}

\ifshowex
\currentpdfbookmark{练习}{B1.2.1.E}
\subsection*{练习}

\begin{enumerate}
\item 下列说法中，与\(\lim\limits_{n\to\infty} a_n = A\)不等价的是\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(
    \paren[\big]{\forall ε > 0}
    \paren[\big]{\exists N \in \N^+}
    \paren[\big]{\forall n > N}
    \paren[\big]{\abs[\big]{a_n - A} < \sqrt ε}
    \)
  \item \(
    \paren[\big]{\forall k \in \N}
    \paren[\big]{\exists N_k \in \Z^+}
    \paren[\big]{\forall n > N_k}
    \paren[\big]{\abs[\big]{a_n - A} < 1/2^k}
    \)
  \item \(
    \paren[\big]{\forall ε > 0}
    \paren[\big]{\exists N \in \N^+}
    \paren[\big]{\forall n > N}
    \paren[\big]{\abs[\big]{a_n - A} < 2ε}
    \)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(
    \paren[\big]{\forall ε > 0}
    \paren[\big]{\exists N \in \N^+}
    \paren[\big]{\forall n > N}
    \paren[\big]{\abs[\big]{a_n - A} < ε/\!\sqrt n}
    \)
  \end{itemize}

  \ifshowsol
  一个反例是\(\lim\limits_{n\to\infty}\paren*{1 + 1/\!\sqrt n} = 1\)，但是按照选项~D，它并不收敛．实际上，选项~D是数列收敛的充分不必要条件．
  \fi

\item 下列说法中，与“数列\(\Seq{a_n}\)不收敛于\(A\)”等价的是\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    存在\(ε_0 > 0\)使得数列\(\Seq{a_n}\)中有无穷多项满足\(\abs*{a_n - A} \ge ε_0\)
  \item \(
    \paren[\big]{\exists ε_0 > 0}
    \paren[\big]{\exists N \in \Z^+}
    \paren[\big]{\forall n > N}
    \paren[\big]{\abs[\big]{a_n - A} \ge ε_0}
    \)
  \item \(
    \paren[\big]{\forall ε > 0}
    \paren[\big]{\exists N}
    \paren[\big]{\forall n > N}
    \paren[\big]{\abs[\big]{a_n - A} \ge ε_0}
    \)
  \item 数列\(\Seq{a_n}\)中，除有限项外，都满足\(\abs*{a_n - A} \ge ε_0\)，其中\(ε_0\)是某个正数
  \end{itemize}

  \ifshowsol
  选项~B、C和~D都是题干的充分不必要条件．例如数列\(\Seq[\big]{A + \frac{1+(-1)^n}{2}}\)不收敛于\(A\)，但是不满足选项~B、C、D．实际上，选项~B和~D是等价的，然后选项~C是选项~B的充分不必要条件．
  \fi

\item 下列说法中，正确的是\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 数列\(\Seq{a_n}\)是否收敛与其前\(1000\)项有关
  \item 数列\(\Seq{a_n}\)是否收敛与其所有项均有关
  \item 数列\(\Seq{a_n}\)是否收敛仅与\(n\)充分大以后的某些项有关
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    数列\(\Seq{a_n}\)是否收敛仅与\(n\)充分大以后的所有项有关
  \end{itemize}

\item 下列数列中，极限为\(0\)的是\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(e^n/2^n\)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(\paren{-1}^n/n\)
  \item \(n - 1/n\)
  \item \(n \sinp{1/n}\)
  \end{itemize}

\item 下列数列中，极限为\(1\)的是\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(n/a^n\ \paren{a > 1}\)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(a^{1/n}\ \paren{a > 1}\)
  \item \(\paren[\big]{\sin n^2}\big/{n}\)
  \item \(\paren[\big]{n \sqrt{n+1}}\big/\brkt[\big]{\sqrt n \paren{2n-1}}\)
  \end{itemize}

\item 下列说法中，正确的是\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 收敛数列的子列极限不一定相同
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    收敛数列的极限与其前有限项无关
  \item 数列不收敛则必无收敛子列
  \item 若收敛数列的极限大于零，则数列恒大于零
  \end{itemize}

\item 下列数列中，不是无穷大量的是\uline{\makebox[8em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(n/\!\ln n\)
  \item \(-n^2 + n\)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(\brkt{n\paren{n^{7/3}+1}}/n^{15/4}\)
  \item \(\paren{-1}^n n^3 + n^2 - 10n\)
  \end{itemize}

\item 下列数列中，无界但不是无穷大量的是\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(n/\!\ln n\)
  \item \(\paren{-1}^n n^2 + n\)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(n \sinp{n^n\!/2}\)
  \item \(e^n\!/n!\)
  \end{itemize}

\item 与命题“当\(n\to\infty\)时，\(a_n\to\infty\)”等价的是\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(
    \paren[\big]{\forall M > 0}
    \paren[\big]{\forall N > 0}
    \paren[\big]{\exists n > N}
    \paren[\big]{\abs[\big]{a_n} > M}
    \)
  \item \(
    \paren[\big]{\exists M > 0}
    \paren[\big]{\exists N > 0}
    \paren[\big]{\forall n > N}
    \paren[\big]{\abs[\big]{a_n} > M}
    \)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(
    \paren[\big]{\forall M > 0}
    \paren[\big]{\exists N > 0}
    \paren[\big]{\forall n > N}
    \paren[\big]{\abs[\big]{a_n} > M}
    \)
  \item \(
    \paren[\big]{\exists N > 0}
    \paren[\big]{\forall M > 0}
    \paren[\big]{\forall n > N}
    \paren[\big]{\abs[\big]{a_n} > M}
    \)
  \end{itemize}

  \ifshowsol
  选项~A其实相当于是说数列\(\Seq{a_n}\)无界，选项~D是一个不可满足的命题．
  \fi

\item 下列说法中，正确的是\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 一个数列如果不收敛，则它一定无界
  \item 若\(\lim\limits_{n\to\infty} a_n = A\)且\(A \ge 0\)，则存在正整数\(N\)使得当\(n > N\)时都有\(a_n \ge 0\)
  \item 设有两个数列\(\Seq{a_n}\)和\(\Seq{b_n}\)，那么\(\lim\limits_{n\to\infty} \paren{a_n - b_n} = \lim\limits_{n\to\infty} a_n - \lim\limits_{n\to\infty} b_n\)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    存在发散数列\(\Seq{a_n}\)使得\(\Seq{\abs{a_n}}\)收敛
  \end{itemize}

  \ifshowsol
  对于选项~C，加上一个限制条件就成立了，就是这两个数列都收敛．设\(a_n = n + \frac1n, b_n = n\)，那么\(\lim\limits_{n\to\infty} \paren{a_n - b_n} = \lim\limits_{n\to\infty} \frac1n = 0 \ne \infty - \infty = \lim\limits_{n\to\infty} a_n - \lim\limits_{n\to\infty} b_n\)．
  \fi

\item 设\(a_k \ge 0,\ k = 1, 2, \dots, m\)．求\(\lim\limits_{n\to\infty} \paren{a_1^n + a_2^n + \dots + a_m^n}^{1/n} =\)\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(\max_{1 \le k \le m} \Set{a_k}\)
  \item \(\min_{1 \le k \le m} \Set{a_k}\)
  \item \(\paren{a_1 + a_2 + \dots + a_m}/{m}\) % report
  \item \(1\)
  \end{itemize}

  \ifshowsol
  \begin{proof}
    令\(A = \max_{1 \le k \le m} \Set{a_k}\)．若\(A = 0\)，则说明\(a_k = 0\)对于所有的\(1 \le k \le m\)，所求极限自然也就等于零．若\(A > 0\)，就有
    \begin{align*}
      \abs[\big]{\paren{a_1^n + a_2^n + \dots + a_m^n}^{1/n} - A}
      &= A \abs[\bigg]{\brkt[\Big]{\paren[\Big]{\frac{a_1}{A}}^n + \paren[\Big]{\frac{a_1}{A}}^n + \dots + \paren[\Big]{\frac{a_1}{A}}^n}^{\frac1n} - 1} \\
      &\le A \paren{m^{1/n} - 1}.
    \end{align*}
    对于任意的\(ε > 0\)取\(N = \ceil*{\ln m/\!\lnp{1+ε/A}}\)就可使得当\(n > N\)时都有
    \begin{align*}
      \frac{\ln m}{\lnp{1+ε/A}}
      &\le N < n
      && \iff \\
      \ln m
      &< n \lnp{1+ε/A}
      && \iff \\
      m
      &< \paren{1+ε/A}^n
      && \iff \\
      A \paren{m^{1/n} - 1}
      &< ε.
      &&\qedhere
    \end{align*}
  \end{proof}
  \fi
\end{enumerate}
\fi

\section{数列极限存在的充分条件}

\begin{theorem*}[数列极限的夹逼定理]
  若数列\(\Seq{a_n}, \Seq{b_n}, \Seq{c_n}\)满足：
  \begin{enumerate}[topsep=0ex,itemsep=0ex]
    \renewcommand{\labelenumi}{\enumparen{\arabic{enumi}}}
  \item 存在正整数\(N\)使得当\(n > N\)时都有\(a_n \le b_n \le c_n\)，
  \item \(\lim\limits_{n\to\infty} a_n = \lim\limits_{n\to\infty} c_n = A\)；
  \end{enumerate}
  则\(\lim\limits_{n\to\infty} b_n = A\)．

  \begin{proof}
    对于任意的\(ε > 0\)都存在正整数\(N_1\)和\(N_2\)使得当\(n > N_1\)时都有\(\abs*{a_n - A} < ε\)和当\(n > N_2\)时都有\(\abs*{c_n - A} < ε\)．取\(N = \maxb{N_1, N_2}\)，当\(n > N\)时就有
    \begin{equation*}
      A - ε < a_n \le b_n \le c_n < A + ε
      \iff
      \abs*{b_n - A} < ε.
      \qedhere
    \end{equation*}
  \end{proof}
\end{theorem*}

\begin{example}
  \label{eg:factexp}
  求\(\displaystyle \lim_{n\to\infty} \frac{a^n}{n!}\)．\rule[-2ex]{0ex}{0ex}

  \begin{remark}
    当\(a = 0\)时，极限显然是零．当\(a \ne 0\)时，我们构造数列\(a_n\)和\(c_n\)使得\(a_n \le a^n\!/n! \le c_n\)且\(\lim\limits_{n\to\infty} a_n = \lim\limits_{n\to\infty} c_n = 0\)．令\(n_a = \ceil{\abs a},\ C_a = \frac{a^{n_a}}{n_a!}\)，构造数列
    \begin{equation*}
      d_n =
      \begin{cases}
        C_a, & n \le n_a, \\
        C_a \cdot \paren[\bigg]{\dfrac{a}{n_a + 1}}^{n-n_a}, & n > n_a,
      \end{cases}
    \end{equation*}
    易知\(\lim\limits_{n\to\infty} d_n = 0\)．当\(a > 0\)时，只要构造数列\(a_n = 0\)和\(c_n = d_n\)即可．当\(a < 0\)时，只有构造数列
    \begin{equation*}
      a_n =
      \begin{cases}
        0, & \text{\(n\)是偶数时}, \\
        d_n, & \text{\(n\)是奇数时},
      \end{cases}
      \quad\text{和}\quad
      c_n =
      \begin{cases}
        d_n, & \text{\(n\)是偶数时}, \\
        0, & \text{\(n\)是奇数时},
      \end{cases}
    \end{equation*}
    就有\(a_n \le a^n\!/n! \le c_n\)且\(\lim\limits_{n\to\infty} a_n = \lim\limits_{n\to\infty} c_n = 0\)．综上所述，\(\displaystyle \lim_{n\to\infty} \frac{a^n}{n!} = 0\)．\rule[-2ex]{0ex}{0ex}

    上面是为了直接套用夹逼定理的形式，实际上一种常见的方法是：欲证\(\lim\limits_{n\to\infty} a_n = A\)，只需证明\(0 \le \abs*{a_n - A} \le b_n\)且\(\lim\limits_{n\to\infty} b_n = 0\)即可．
  \end{remark}
\end{example}

\begin{example*}
  求\(\displaystyle \lim_{n\to\infty} \sum_{k=1}^n \frac{k}{n^2+k}\)．

  \begin{remark}
    构造数列
    \begin{equation*}
      a_n
      = \sum_{k=1}^n \frac{k}{n^2 + n}
      = \frac{1}{n^2 + n} \cdot \frac{n(n+1)}{2}
      = \frac12
      \quad\text{和}\quad
      c_n
      = \sum_{k=1}^n \frac{k}{n^2}
      = \frac{1}{n^2} \cdot \frac{n(n+1)}{2}
      = \frac{1 + 1/n}{2},
    \end{equation*}
    易知\(\displaystyle a_n \le \sum\limits_{k=1}^n \frac{k}{n^2+k} \le c_n\)且\(\displaystyle \lim_{n\to\infty} a_n = \lim_{n\to\infty} c_n = \frac12\)．\rule[-3ex]{0ex}{0ex}
  \end{remark}
\end{example*}

\begin{theorem*}[单调有界收敛定理]
  若数列\(\Seq{a_n}\)单调增加且有上界，则\(\Seq{a_n}\)收敛且\(\lim\limits_{n\to\infty} a_n = \sup\Set{a_n}\)； 若数列\(\Seq{a_n}\)单调减少且有下界，则\(\Seq{a_n}\)收敛且\(\lim\limits_{n\to\infty} a_n = \inf\Set{a_n}\)．

  \begin{proof}
    只证单增的情况，单减的情况类似．因为数列有界，根据确界存在公理，数列有上确界\(M = \sup\Set{a_n}\)．那么对于任意的\(ε > 0\)都存在一个\(N\)使得\(a_N > M - ε\)．当\(n > N\)时，自然有
    \begin{gather*}
      M - ε < a_N \le a_n \le M < M + ε, \\
      \shortintertext{即}
      \abs*{a_n - M} < ε.
      \qedhere
    \end{gather*}
  \end{proof}
\end{theorem*}

\begin{theorem}
  \label{thm:seqe}
  证明\(\displaystyle \lim_{n\to\infty} \paren[\bigg]{1 + \frac1n}^n\)存在．

  \begin{proof}
    记\(a_n = \paren{1+1/n}^n\)．根据单调有界收敛定理，只需证明对于所有的正整数\(n\)都有\(a_n \le a_{n+1}\)且\(a_n < 3\)即可．根据二项式定理，有
    \begin{align*}
      a_n
      &= \paren[\bigg]{1+\frac1n}^n
        = 1 + \binom{n}{1} \frac1n  + \binom{n}{2} \frac1{n^2} + \dots + \binom{n}{n} \frac1{n^n} \\
      &= 1 + 1 + \frac{n(n-1)}{2!\,n^2} + \dots + \frac{n(n-1)\dotsm1}{n!\,n^n} \\
      &= 2 + \frac1{2!} \cdot 1 \cdot \paren[\bigg]{1 - \frac1n} + \dots
        + \frac1{n!} \cdot 1 \cdot \paren[\bigg]{1 - \frac1n} \dotsm \paren[\bigg]{1 - \frac{n-1}n} \\
      &< 2 + \frac1{2!} \cdot 1 \cdot \paren[\bigg]{1 - \frac1{n+1}} + \dots
        + \frac1{(n+1)!} \cdot 1 \cdot \paren[\bigg]{1 - \frac1{n+1}} \dotsm \paren[\bigg]{1 - \frac{n}{n+1}} \\
      &= a_{n+1}.
    \end{align*}
    要证明\(a_n < 3\)，只需证明\(1/2! + 1/3! + \dots + 1/n! < 1\)即可．有
    \begin{align*}
      \frac1{2!} + \frac1{3!} + \dots + \frac1{n!}
      &\le \frac{1}{1 \cdot 2} + \frac{1}{2 \cdot 3} + \dots + \frac{1}{\paren{n-1}n} \\
      &= \paren[\bigg]{1 - \frac12} + \paren[\bigg]{\frac12 - \frac13} + \dots + \paren[\bigg]{\frac1{n-1} - \frac1n} \\
      &= 1 - \frac1n < 1. \qedhere
    \end{align*}
  \end{proof}

  \begin{remark}
    实际上，这个极限就是自然常数\(e\)．
  \end{remark}
\end{theorem}

\begin{example*}
  令\(\displaystyle a_n = 1 + \frac12 + \dots + \frac1n - \ln n\)．证明数列\(\Seq{a_n}\)的极限存在．\rule{0ex}{3.5ex}

  \begin{proof}
    当\(x > 0\)时，有
    \begin{equation*}
      \frac{x}{1+x} < \lnp{1+x} < x.
    \end{equation*}
    因此有
    \begin{align*}
      a_{n+1} - a_n
      &= \frac{1}{1+n} - \lnp{1+n} + \ln n \\
      &= \frac{1/n}{1+1/n} - \lnp[\bigg]{1+\frac1n} < 0
    \end{align*}
    和
    \begin{align*}
      a_n
      &= 1 + \frac12 + \dots + \frac1n - \ln n \\
      &> \lnp{1+1} + \lnp[\bigg]{1+\frac12} + \dots + \lnp[\bigg]{1+\frac1n} - \ln n \\
      &= \lnp[\bigg]{2 \cdot \frac32 \dotsm \frac{n+1}{n}} - \ln n \\
      &= \lnp{n + 1} - \ln n > 0. \qedhere
    \end{align*}
  \end{proof}
\end{example*}

\begin{example*}
  证明极限\(\displaystyle \lim_{n\to\infty} \sum_{k=1}^n \frac1k\)不存在．

  \begin{proof}
    实际上，\(\displaystyle \lim_{n\to\infty} \sum_{k=1}^n \frac1k = \infty\)．对于任意的\(M > 0\)都存在正整数\(N = \ceil[\big]{e^M-1}\)使得当\(n > N\)时都有
    \begin{equation*}
      \abs[\Bigg]{\sum_{k=1}^n \frac1k}
      = \sum_{k=1}^n \frac1k
      > \sum_{k=1}^n \lnp[\bigg]{1+\frac1k}
      = \lnp{n+1} > M.
      \qedhere
    \end{equation*}
  \end{proof}
\end{example*}

\begin{example*}
  令\(\displaystyle a_n = \sum_{k=1}^n \frac1{k^p}\)．试讨论当\(p > 0\)时数列\(\Seq{a_n}\)的敛散性．

  \begin{remark}
    当\(0 < p \le 1\)时，有\(k^p \le k\)．所以
    \begin{equation*}
      a_n = \sum_{k=1}^n \frac1{k^p} \ge \sum_{k=1}^n \frac1{k}
      > \sum_{k=1}^n \lnp[\bigg]{1+\frac1k} = \lnp{n+1}.
    \end{equation*}
    对于任意的\(M > 0\)，取\(N = \ceil[\big]{e^M - 1}\)，那么当\(n > N\)时，自然有\(a_n > \lnp{n+1} > M\)．所以有
    \begin{equation*}
      \lim_{n\to\infty} a_n = +\infty
    \end{equation*}
    当\(0 < p \le 1\)时，由\(a_{n+1} - a_n = 1/(n+1)^p > 0\)可知数列单调增加，只需证明数列有上界即可．取\(\ell = \floor[\big]{\log_2 n} + 1\)，有
    \begin{equation*}
      a_n
      = \sum_{k=1}^n \frac1{k^p}
      \le \sum_{k=1}^{2^\ell-1} \frac1{k^p}
      = \sum_{m=0}^{\ell-1} \sum_{j=2^m}^{2^{m+1}-1} \frac{1}{j^p}
      \le \sum_{m=0}^{\ell-1} \frac{2^m}{\paren{2^m}^p}
      = \sum_{m=0}^{\ell-1} \paren[\big]{2^{1-p}}^m
      = \frac{1-\paren{2^{1-p}}^\ell}{1-2^{1-p}}
      < \frac{1}{1-2^{1-p}}.
    \end{equation*}
    由单调有界收敛定理可知，数列\(\Seq{a_N}\)收敛．
  \end{remark}
\end{example*}

\subpdfbookmark{思考}{B1.2.2.P}
\subsection*{思考}

\begin{enumerate}
\item 若单调递增的数列\(\Seq{a_n}\)没有上界，这个数列是不是无穷大量？能否给出严格证明？

  \ifshowsolp
  是无穷大量，证明如下．

  \begin{proof}
    因为数列\(\Seq{a_n}\)没有上界，所以对任意的\(M > 0\)都存在一个正整数\(N\)使得\(a_N > M\)．这时，对于所有的\(n > N\)，因为数列\(\Seq{a_n}\)单调递增，所以
    \begin{equation*}
      a_n \ge a_N > M. \qedhere
    \end{equation*}
  \end{proof}
  \fi

\item 若数列\(\Seq{a_n}\)是正无穷大量，则\(\Seq{a_n}\)一定单调增加吗？

  \ifshowsolp
  未必．\(a_n = n + (-1)^n\)，易证\(\lim\limits_{n\to\infty} a_n = +\infty\)．此时，对于任意的正偶数\(k\)都有
  \begin{equation*}
    a_{k+1} = (k+1) + (-1)^{k+1} = k < k + 1 = k + (-1)^k = a_k.
  \end{equation*}
  \fi
\end{enumerate}

\ifshowex
\currentpdfbookmark{练习}{B1.2.2.E}
\subsection*{练习}

\begin{enumerate}
\item 下列数列中，收敛但极限不为\(1\)的是\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(\paren{2+1/n}^{1/n}\)
  \item \(n^{1/n}\)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(\frac{1}{n^2+1} + \frac{2}{n^2+2} + \dots + \frac{n}{n^2+n}\)
  \item \(\paren{n!}^2\!/n^n\)
  \end{itemize}

  \ifshowsol
  对选项~B的证明：
  \begin{proof}
    对于任意的\(ε > 0\)，取\(N = \ceil[\big]{2/ε^2 + 1}\)，那么当\(n > N\)时都有
    \begin{gather*}
      n
      < \frac{n(n-1)}{2} ε^2
      < 1 + nε + \frac{n(n-1)}{2} ε^2 + \dots + ε^n
      = (1+ε)^n \\
      \shortintertext{即}
      n^{1/n} < 1 + ε.
      \qedhere
    \end{gather*}
  \end{proof}
  对选项~D的证明：
  \begin{proof}
    当\(n \ge 2\)时，有
    \begingroup
    \addtolength{\jot}{1ex}
    \begin{align*}
      \frac{(n!)^2}{n^n}
      &= \frac{n}{n} \cdot \frac{2(n-1)}{n} \cdot \frac{3(n-2)}{n}
      \dotsm \frac{2(n-1)}{n} \cdot \frac{n}{n} \\
      &=
        \begin{dcases}
          \brkt[\bigg]{2\paren[\bigg]{1-\frac1n} \cdot 3\paren[\bigg]{1-\frac2n}
            \dotsm \floor*{\frac{n}{2}} \paren[\bigg]{1-\frac{\floor{n/2}-1}{n}}}^2,
          & \text{\(n\)是偶数时,} \\
          \brkt[\bigg]{2\paren[\bigg]{1-\frac1n} \cdot 3\paren[\bigg]{1-\frac2n}
            \dotsm \floor*{\frac{n}{2}} \paren[\bigg]{1-\frac{\floor{n/2}-1}{n}}}^2
          \cdot \paren[\bigg]{\frac{\ceil{n/2}}{n}}^2,
          & \text{\(n\)是奇数时,}
        \end{dcases} \\
      &> \frac{\floor{n/2}!}{2^{\floor{n/2}}}.
    \end{align*}
    \endgroup
    易知\(\displaystyle \lim_{n\to\infty} \frac{(n!)^2}{n^n} = +\infty\)．
  \end{proof}

  选项~A和~C可以直接套用夹逼定理．
  \fi

\item 以下说法中，错误的是\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
    \addtolength{\itemsep}{1ex}
  \item 设\(x_1 > 0,\ y_1 > 0,\ x_{n+1} = \sqrt{x_n y_n}\,,\ y_{n+1} = (x_n+y_n)/2 \; (n \in \N^+)\)．那么数列\(\Seq{x_n}\)与\(\Seq{y_n}\)收敛于同一个实数
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    若对所有的\(p \in \N^+\)都有\(\lim\limits_{n\to\infty} \abs*{a_{n+p}-a_n} = 0\)，则数列\(\Seq{a_n}\)是柯西数列． % report
  \item 极限\(\displaystyle \lim_{n\to\infty} \sum_{k=1}^n \frac{\sin k}{2^k}\)存在
  \item 若\(\displaystyle \lim_{n\to\infty} \abs[\bigg]{\frac{a_{n+1}}{a_n}} = q < 1\)，则\(\lim\limits_{n\to\infty} a_n = 0\)
  \end{itemize}

\item 下列说法中，错误的是\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
    \addtolength{\itemsep}{.67ex}
  \item 若\(k\)是某一个正整数，则\(\lim\limits_{n\to\infty} x_n = a\)的充分必要条件是\(\lim\limits_{n\to\infty} x_{n+k} = a\)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    若\(\displaystyle \lim_{n\to\infty} a_n = A,\ b_n = \frac{a_1 + a_2 + \dots + a_n}{n}\)，则数列\(\Seq{b_n}\)不一定收敛．
  \item 若\(\lim\limits_{n\to\infty} a_n = a > 0,\ b_n = \sqrt[n]{a_1 a_2 \dotsm a_n}\)且所有的\(a_n \ne 0\)，则\(\lim\limits_{n\to\infty} b_n = a\)
  \item 单调有界数列是柯西数列
  \end{itemize}

\item 下列说法中，正确的是\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    单调递增数列要么收敛，要么是无穷大量
  \item 数列若不单调有界，则必不收敛
  \item 存在不收敛的柯西数列
  \item 收敛数列不一定有界
  \end{itemize}

\item 已知\(\displaystyle \lim_{n\to\infty} a_n = 1,\ \lim_{n\to\infty} b_n = 2\)，求\(\displaystyle \lim_{n\to\infty} \frac{a_1 b_n + a_2 b_{n-1} + \dots + a_n b_1}{n}\)．

  \ifshowsol
  可以模仿例~\ref{eg:limavg}的思路来证明这个极限的值是\(2\)．
  \fi
\end{enumerate}
\fi

\section{Bolzano--Weierstrass定理与Cauchy收敛准则}

\begin{theorem}
  \label{thm:seqcvgsubseq}
  数列\(\Seq{a_n}\)收敛的充分必要条件是它的所有子列都收敛．

  \begin{remark}
    易证必要性；至于充分性，可以先证明所有子列都收敛于同一个数，然后通过反证法得到．
  \end{remark}
\end{theorem}

\begin{example*}
  设\(a_1 = 2,\ a_{n+1} = 2 + {1}/{a_n}\)．试讨论数列\(\Seq{a_n}\)的敛散性. % https://mathworld.wolfram.com/ContinuedFraction.html

  \begin{remark}
    子列\(a_{2n}\)单调递减有下界，子列\(a_{2n-1}\)单调递增有上界．然后证明这两个子列的极限相等．这就说明原数列收敛．
  \end{remark}
\end{example*}

\begin{definition*}
  若闭区间\(\Seq{\brkt{a_n, b_n}}\)对于所有的\(n\)满足\(\brkt{a_{n+1}, b_{n+1}} ⊂ \brkt{a_n, a_n}\)且\(\lim\limits_{n\to\infty} (b_n - a_n) = 0\)，则称\(\Seq{\brkt{a_n, b_n}}\)是一个区间套．
\end{definition*}

\begin{theorem*}[区间套定理]
  若\(\Seq{\brkt{a_n, b_n}}\)是一个区间套，则存在唯一的实数\(ξ\)使得\(ξ \in \brkt{a_n, b_n}\)对于所有的\(n\)都成立．

  \begin{remark}
    可以考虑使用单调有界收敛定理来证明此定理．
  \end{remark}
\end{theorem*}

\begin{example*}
  从区间套定理可以推出确界存在公理．

  % TODO: Complete the proof
  \begin{remark}
    可以通过二分法来构造区间套从而推出确界存在公理．这就说明确界存在公理、单调有界定理、区间套定理在逻辑上是等价的．
  \end{remark}
\end{example*}

\begin{theorem}[Bolzano--Weierstrass定理]
  \label{thm:bw}
  若数列\(\Seq{a_n}\)有界，则存在子列\(\Seq{a_{n_k}}\)收敛．

  % TODO: Complete the proof
  \begin{remark}
    还是可以通过二分法构造区间套来证明此定理的．
  \end{remark}
\end{theorem}

\begin{example}
  \label{eg:seqbndcmnidx}
  数列\(\Seq{a_n}\)和\(\Seq{b_n}\)都是有界的，可以找到一个共同的下标集\(\Set{n_k}\)使得子列\(\Seq{a_{n_k}}\)和\(\Seq{b_{n_k}}\)都收敛．

  \begin{proof}
    由上述定理可知，能找到一个下标集\(\Set{\bar n_k}\)使得子列\(\Seq{a_{\bar n_k}}\)收敛．再对有界子列\(\Seq{b_{\bar n_k}}\)使用一次这个定理，就能得到一个下标集\(\Set{n_k}\)使得子列\(\Seq{a_{n_k}}\)和\(\Seq{b_{n_k}}\)都收敛．
  \end{proof}
\end{example}

\begin{definition*}
  对于任意的\(ε > 0\)都存在正整数\(N\)使得当\(m > N,\ n > N\)时都有\(\abs*{a_n - a_m} < ε\)．这时我们称数列\(\Seq{a_n}\)是一个柯西列（Cauchy sequence）．
\end{definition*}

\begin{definition*}[柯西列的定价定义]
  \begin{math}
    \paren[\big]{\forall ε > 0}
    \paren[\big]{\exists N > 0}
    \paren[\big]{\forall n > N}
    \paren[\big]{\forall p > 0}
    \paren[\big]{\abs[\big]{a_{n+p} - a_n} < ε}.
  \end{math}
\end{definition*}

\begin{example*}
  证明数列\(\Seq{q^n}\)在\(\abs*{q} < 1\)条件下是柯西列．

  \begin{proof}
    对于任意的\(ε > 0\)，取\(N = \maxb*{\ceil*{\ln ε /\!\ln\abs*q}, 1}\)，那么当\(n > N\)时，对于所有的正整数\(p\)都有
    \begin{equation*}
      \abs*{q^{n+p} - q^n}
      = \abs*q^n \abs*{q^p - 1}
      < \abs*q^n
      < ε.
      \qedhere
    \end{equation*}
  \end{proof}
\end{example*}

\begin{example*}
  证明数列\(\Seq[\big]{\sum_{k=1}^n 1/k}\)不是柯西列．

  \begin{proof}
    前面我们已经证明了这个数列单调递增且为无穷大量．将这个数列记为\(\Seq{a_n}\)．取\(ε = 1\)，对于任意的正整数\(N\)，先取\(n = N+1\)，因为数列\(\Seq{a_n}\)单调递增且是无穷大量，所以一定能找到一个正整数\(p\)使得\(a_{n+p} > 2\,a_n \)， 那么就有\(\abs[\big]{a_{n+p} - a_n} = a_{n+p} - a_n > a_n > 1\)．
  \end{proof}
\end{example*}

% https://mathworld.wolfram.com/CauchyCriterion.html
% https://hsm.stackexchange.com/a/2861/13364
% https://en.wikipedia.org/wiki/Cauchy%27s_convergence_test
% https://personal.math.ubc.ca/~cass/courses/m220-00/cauchy.pdf
\begin{theorem}[柯西收敛准则]
  \label{thm:seqcvgcauchy}
  数列收敛的充分必要条件是它为柯西列．

  \begin{proof}
    易证必要性，用一次三角不等式即可．下面证明一下充分性．易从柯西列的定义推出柯西列一定是有界列．根据定理~\ref{thm:bw}，有界列必有收敛子列， 将这个子列记为\(\Seq{a_{n_k}}\)，其极限记为\(A\)．那么对于任意的\(ε > 0\)，都存在一个正整数\(K\)使得当\(k > K\)时都有\(\abs[\big]{a_{n_k} - A} < ε\)，也存在一个正整数\(N_0\)使得当\(n > N_0,\ m > N_0\)时都有\(\abs*{a_n - a_m} < ε\)．取\(N = 1 + \maxb*{K, N_0}\)，当\(n > N\)时就有
    \begin{equation*}
      \abs[\Big]{a_n - A}
      \le \abs[\Big]{a_n - a_{n_N}} + \abs[\Big]{a_{n_N} - A}
      < 2ε.
      \qedhere
    \end{equation*}
  \end{proof}
\end{theorem}

\begin{example*}
  设\(b_n = \sum_{k=1}^n \abs*{a_{k+1} - a_k} \le C\)．试证明数列\(\Seq{a_n}\)收敛．

  \begin{proof}
    数列\(\Seq{b_n}\)单调递增且有界，那么自然也就收敛，因而也是柯西列．所以对于任意的\(ε > 0\)都存在正整数\(N_0\)使得当\(n > N_0,\ p > 0\)时都有
    \begin{align*}
      ε
      &> \abs[\big]{b_{n+p} - b_{n}} \\
      &= \abs[\Bigg]{\,\sum_{k=1}^{n+p} \abs*{a_{k+1} - a_k} - \sum_{k=1}^n \abs*{a_{k+1} - a_k}\,} \\
      &= \abs[\Bigg]{{}\smashoperator[r]{\sum_{k=n+1}^{n+p}} \abs*{a_{k+1} - a_k}\,} = \smashoperator{\sum_{k=n+1}^{n+p}} \abs*{a_{k+1} - a_k} \\
      &\ge \abs[\Bigg]{{}\smashoperator[r]{\sum_{k=n+1}^{n+p}} \paren*{a_{k+1} - a_k}\,}
        = \abs[\big]{a_{n+p+1} - a_{n+1}}.
    \end{align*}
    取\(N = N_0 + 1\)，当\(n > N,\ p > 0\)时就有\(\abs[\big]{a_{n+p} - a_n} < ε\)．这就说明数列\(\Seq{a_n}\)是一个柯西列，自然也就收敛．
  \end{proof}
\end{example*}

\subpdfbookmark{思考}{B1.2.3.P}
\subsection*{思考}

\begin{enumerate}
\item 在闭区间套定理中，如果将闭区间改成开区间，结论是否成立？

  \ifshowsolp
  不成立，最终可能是一个空集．设\(a_n = 0,\ b_n = 1/n\)，显然有\(\paren{a_{n+1}, b_{n+1}} \subset \paren{a_n, b_n}\)且\(\lim_{n\to\infty} \paren{b_n - a_n} = 0\)．但是,
  \begin{equation*}
    \bigcap_{n=1}^\infty \paren{a_n, b_n} = \bigcap_{n=1}^\infty \paren[\Big]{0, \frac1n} = \emptyset.
  \end{equation*}
  \fi

\item 如何利用数列收敛与子列收敛的关系来证明一个数列非收敛？

  \ifshowsolp
  只要找到该数列的一个不收敛子列即可．
  \fi
\end{enumerate}

\ifshowex
\currentpdfbookmark{练习}{B1.2.3.E}
\subsection*{练习}

\begin{enumerate}
\item 若数列\(\Seq{a_n}\)满足条件\(\abs*{a_{n+1} - a_n} \le 1/2^n\)，则\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(\lim_{n\to\infty} a_n = 0\)
  \item 数列\(\Seq{a_n}\)不一定收敛
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(\lim_{n\to\infty} a_n = A\)且\(\abs*{A - a_1} \le 1\)
  \item \(\lim_{n\to\infty} a_n = A\)且\(\abs*{A - a_1} > 1\)
  \end{itemize}

  \ifshowsol
  选项~A可以有反例\(a_n = 1\)来说明．选项~B可以由三角不等式推出这个数列是柯西列，进而收敛．选项~C可以先推出\(\abs*{a_n - a_1} \le 1 - 1/2^{n-1}\)，然后用反证法说明\(\abs*{A - a_1} \ngtr 1\)．
  \fi

\item 设\(\Seq*{\paren{a_n, b_n}}\)是一个开区间序列且满足：\enumparen{1}\(a_1 < a_2 < \dots < a_n < \dots < b_n < \dots < b_2 < b_1\) \enumparen{2}\(\lim_{n\to\infty} \paren{b_n - a_n} = 0\)．那么就有\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    存在唯一的实数\(ξ\)属于所有开区间\(\paren{a_n, b_n}\)且\(ξ = \lim_{n\to\infty} a_n\)
  \item 存在唯一的实数\(ξ\)属于所有开区间\(\paren{a_n, b_n}\)且\(ξ \ne \lim_{n\to\infty} a_n\)
  \item 至少存在两个不同的实数\(ξ\)和\(η\)属于所有开区间\(\paren{a_n, b_n}\)
  \item 不存在实数\(ξ\)属于所有开区间\(\paren{a_n, b_n}\)
  \end{itemize}

  \ifshowsol
  可以参考区间套定理的证明方式．
  \fi

\item 关于数列，下列四个结论中，正确的有\uline{\makebox[6em]{%
      \ifshowsol
      \enumparen{1}%
      \enumparen{2}
      \fi}}．
  \begin{enumerate}
    \renewcommand{\labelenumii}{\enumparen{\arabic{enumii}}}
  \item 单调的无界数列一定为无穷大量
  \item 无界数列存在无穷大量子列
  \item 数列收敛等价于有无穷多个子列收敛
  \item 发散数列存在无穷大量子列
  \end{enumerate}

\item 下面四个数列中，是柯西列的有\uline{\makebox[6em]{%
      \ifshowsol
      \enumparen{2}%
      \enumparen{3}
      \fi}}．
  \begin{enumerate}
    \renewcommand{\labelenumii}{\enumparen{\arabic{enumii}}}
  \item \(\Seq[\big]{1 + \frac12 + \dots + \frac1n}\)
  \item \(\Seq[\big]{1 + \frac1{2^2} + \dots + \frac1{n^2}}\)
  \item \(\Seq[\big]{\frac{n!}{n^n}}\)
  \item \(\Seq[\big]{\sin\frac{n^n}{4}}\)
  \end{enumerate}

\item 关于区间\(\paren{0,1}\)中所有的有理点排成的点列\(\Seq[\big]{\frac12, \frac13, \frac23, \frac14, \frac34, \frac15, \frac25, \frac35, \frac45, \dots}\)，下列四个结论中，正确的有\uline{\makebox[6em]{%
      \ifshowsol
      \enumparen{1}
      \fi}}．
  \begin{enumerate}
    \renewcommand{\labelenumii}{\enumparen{\arabic{enumii}}}
  \item 对于任意的\(x \in [0,1]\)都存在该点列的一个子列收敛于\(x\)
  \item 不存在\(x \in [0,1]\)使得该点列的一个子列收敛于\(x\)
  \item 仅存在有限个\(x \in [0,1]\)使得该点列的一个子列收敛于\(x\)
  \item 至少存在有限个\(x \in [0,1]\)使得该点列的任何一个子列都不收敛于\(x\)
  \end{enumerate}

\item 下列说法，错误的是\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 数列\(\Seq{a_n}\)单调，则\(\lim_{n\to\infty} a_n = A\)的充要条件是存在子列\(\Seq{a_{n_k}}\)满足\(\lim_{n\to\infty} a_{n_k} = A\)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    若数列\(\Seq{a_n}\)不收敛，则必存在两个子列\(\Seq{a_{n_k}^{(1)}}\)和\(\Seq{a_{n_k}^{(2)}}\)分别收敛于两个不同的值
  \item 若数列\(\Seq{a_n}\)无界但非无穷大量，则必存在一个无穷大量子列和一个收敛子列
  \item 设\(S\)为非空有上界的实数集．若\(\sup S = A \notin S\)，则存在单调递增数列\(\Seq{a_n} \subset S\)使得\(\lim_{n\to\infty} a_n = A\)．
  \end{itemize}
\end{enumerate}
\fi

\section{函数极限的概念与性质}

\begin{definition*}
  \label{defn:limfunc}
  函数\(f\)在点\(x_0\)附近\footnote{在点\(x_0\)附近是指在这个点某个去心邻域上，也就是说在集合\(\paren{x_0 - δ, x_0 + δ} \setminus \Set{x_0}\)上，其中\(δ\)是某个正数．}有定义，\(A\)是某个常数．对于任意的\(ε > 0\)，存在\(δ > 0\)使得当\(0 < \abs*{x-x_0} < δ\)时都有\(\abs*{\,f(x) - A} < ε\)．这时，我们称\(A\)是函数\(f\)在\(x\)趋向于\(x_0\)时的极限，记作
  \begin{equation*}
    \setlength{\abovedisplayskip}{.5ex}
    \lim_{x \to x_0}\,f(x) = A.
  \end{equation*}
\end{definition*}

\begin{example*}
  证明\(\lim_{x\to1} x^2 = 1\)．

  \begin{proof}
    对于任意的\(ε > 0\)，取\(δ = \minb[\big]{\frac12, \frac23ε}\)，当\(0 < \abs*{x - 1} < δ\)时就有
    \begin{equation*}
      \setlength{\abovedisplayskip}{.8ex}
      \abs[\big]{\,f(x) - 1}
      = \abs[\big]{x^2 - 1}
      = \abs[\big]{x-1} \abs[\big]{x+1}
      < δ \abs[\big]{x+1}
      < \frac32 δ
      \le ε.
      \rule[-2ex]{0ex}{0ex}
      \qedhere
    \end{equation*}
  \end{proof}
\end{example*}

\begin{example*}
  证明\(\lim_{x\to0} \cos x = 1\)．

  \begin{proof}
    对于任意的\(ε > 0\)，若使\(\abs[\big]{\cos x - 1} < ε\)成立，只需使\(1 - ε < \cos x\)成立即可，也就是\(1 - \cos x < ε\)．考虑到
    \begin{equation*}
      1 - \cos x = 2 \sin^2 \frac{x}{2} \le \frac{x^2}{2},
    \end{equation*}
    这时只需取\(δ = \sqrt{2ε}\)，就能使当\(0 < \abs{x} < δ\)时都有\(1 - \cos x < ε\)．
  \end{proof}
\end{example*}

\begin{definition*}[单侧极限]
  对于任意的\(ε > 0\)都存在\(δ > 0\)使得当\(0 < x_0 - x < δ\)时都有\(\abs*{\,f(x) - A} < ε\)．这时，我们称\(A\)是函数\(f\)在\(x\)从左侧趋向于\(x_0\)的极限，简称左极限，记作\(\lim_{x \to x_0^-} f(x) = A\)或\(f(x_0-0) = A\)．

  对于任意的\(ε > 0\)都存在\(δ > 0\)使得当\(0 < x - x_0 < δ\)时都有\(\abs*{\,f(x) - A} < ε\)．这时，我们称\(A\)是函数\(f\)在\(x\)从右侧趋向于\(x_0\)的极限，简称右极限，记作\(\lim_{x \to x_0^+} f(x) = A\)或\(f(x_0+0) = A\)．
\end{definition*}

\begin{theorem}
  \label{thm:limfuncsided}
  函数极限存在的充分必要条件是它的左极限和右极限都存在且相等．

  \begin{proof}
    易证必要性．关于充分性，只需取\(δ = \minb{δ_1, δ_2}\)即可，其中\(δ_1\)和\(δ_2\)分别是左右极限所取的德尔塔．
  \end{proof}
\end{theorem}

\begin{example*}
  函数
  \begin{equation*}
    f(x) =
    \begin{cases}
      x+1, & x \ge 0, \\
      x-1, & x < 0
    \end{cases}
  \end{equation*}
  在\(x = 0\)处的极限不存在．
\end{example*}

\begin{example*}
  函数\(f(x) = \arctan\dfrac1x\)在\(x = 0\)处的极限不存在．\rule[-2ex]{0ex}{5.5ex}
\end{example*}

\begin{example*}
  函数\(f(x) = \dfrac{x}{\abs x + 1}\)在无穷处的极限不存在．\rule[-2ex]{0ex}{0ex}
\end{example*}

\begin{theorem*}[唯一性]
  函数的极限若存在则唯一．
\end{theorem*}

\begin{theorem*}[有界性]
  若函数\(f\)在\(x \to x_0\)时的极限存在，则其在\(x_0\)附近有界．
\end{theorem*}

\begin{theorem*}[保号性]
  若函数\(f\)在\(x \to x_0\)时收敛于某个非零数\(A\)，则其在\(x_0\)附近拥有与\(A\)相同的正负号．
\end{theorem*}

% https://gallica.bnf.fr/ark:/12148/bpt6k3116z/f688.item
% https://zbmath.org/46.0295.04
\begin{theorem}
  \label{thm:limequiv}
  函数\(f\)在\(x \to x_0\)时收敛于\(A\)的充分必要条件\footnote{这个条件又叫作极限的Heine定义．Sierpiński在1916年发现证明这两个定义等价，其实暗含了弱形式的选择公理．}是：对于任意的非\(x_0\)数列\(\Seq{x_n}\)，当它收敛于\(x_0\)时，就一定有数列\(\Seq{\,f(x_n)}\)收敛于\(A\)．

  \begin{proof}
    易证必要性．关于必要性，可以通过反证法证明．假设函数\(f\)在\(x \to x_0\)时不收敛于\(A\)，则能构造一个数列\(\Seq{x_n}\)使得它收敛于\(x_0\)但是数列\(\Seq{\,f(x_n)}\)不收敛于\(A\)．
  \end{proof}
  \begin{remark}
    实际上，对于单侧极限，也有类似的结论．只需把上面的非\(x_0\)数列\(\Seq{x_n}\)改成小于\(x_0\)的数列\(\Seq{x_n}\)（左侧极限）和大于\(x_0\)的数列\(\Seq{x_n}\)（右侧极限）即可．
  \end{remark}
\end{theorem}

\begin{example*}
  函数\(f\)在\(\brktparen{a, +\infty}\)上有定义，在\(\brkt{a, A}\)上有界，其中\(A\)是任意一个大于等于\(a\)的数，并且在趋向于正无穷时极限存在．证明函数\(f\)在\(\brktparen{a, +\infty}\)上有界．

  \begin{proof}
    记\(B\)为函数在趋向正无穷时的极限．那么对于任意的\(ε > 0\)都存在\(δ > 0\)使得当\(x > δ\)时都有\(\abs*{\,f(x) - B} < ε\)，所以\(\abs[\big]{\,f(x)} < \abs[\big]{B} + ε\)．因此，函数\(f\)在\(\paren{δ, +\infty}\)上有界．又因为函数\(f\)在\(\brkt{a, δ}\)上也有界，所以它在\(\brktparen{a, +\infty}\)上有界．
  \end{proof}
\end{example*}

\begin{example*}
  试判断极限\(\lim_{x\to0} \cos\frac1x\)存在与否．

  \begin{remark}
    不存在．下面给出两种证明．
  \end{remark}

  \begin{proof}
    对于任意的\(A \in \R\)，都存在\(ε > 0\)使得当\(δ > 0\)时都能找到一个\(x\)满足\(0 < \abs{x} < δ\)且\(\abs[\big]{\cos\frac1x - A} \ge ε\)．当\(A \notin \brkt{-1, 1}\)时，只需取\(ε = \abs{A} - 1\)即可．当\(A \in \paren{-1, 1}\)时，取\(ε = \frac{1-\abs{A}}{2}\)和\(x = \frac{1}{2\pi\paren*{\ceil{1/2\piδ}+1}}\)即可．当\(A \in \Set{-1, 1}\)时，取\(ε = 1/2\)和\(x = \frac{1}{\pi/2 + 2\pi\ceil*{1/2\piδ}}\)即可．
  \end{proof}

  \begin{proof}
    令\(x_n = \frac1{2n\pi},\ \bar x_n = \frac1{\pi/2 + 2n\pi}\)．显然有非零数列\(\Seq{x_n}\)和数列\(\Seq{\bar x_n}\)都收敛于\(0\)，但数列\(\Seq{\,f(x_n)}\)和\(\Seq{\,f(\bar x_n)}\)收敛于不同的值．
  \end{proof}
\end{example*}

\begin{example*}[Thomae函数]
  设\(x_0\)是一个实数．试证明函数
  \begin{equation*}
    f(x) =
    \begin{cases}
      \frac1q, & \text{\(x = \frac pq\)，其中\(p \in \Z\)与\(q \in \N^+ \)互质，} \\
      1, & x = 0, \\
      0, & \otherwise
    \end{cases}
  \end{equation*}
  在\(x \to x_0\)时收敛于\(0\)．

  \begin{remark}
    下面给出两种证明．
  \end{remark}

  \begin{proof}
    我们可以将此函数看成直尺上的刻度．可以先考察的此函数的一些性质，易知\(1\)和\(0\)分别是它的上下界，它是一个周期为\(1\)的函数．那么只需证明它在区间\(\paren{0,1}\)上的极限、在\(0\)处的右极限、在\(1\)处的左极限都是\(0\)即可．对于任意的\(ε > 0\)，大于\(ε\)的刻度精度集合\(Q_ε^* = \Set[\big]{\,1/q \mid q \in \N^+ \tand 1/q \ge ε\,}\)显然是有限的．又因为由刻度精度\(1/p\)派生出来的刻度集合\(P_{1/q} = \Set[\big]{\,p/q \mid p \in \N^+ \tand p < q\,}\)也是有限的，那么刻度集合
    \begin{equation*}
      P_{Q_ε^*}
      = {}\smashoperator{\bigcup_{1/q \in Q_ε^*}} P_{1/q}
      = \Set[\big]{\,p/q \mid p,q \in \N^+,\ 1/q \ge ε,\  p < q\,}
    \end{equation*}
    也是有限的．当\(x_o \in \paren{0,1}\)时，令\(X = \paren[\big]{P_{Q_ε^*} \!\setminus \Set{x_0}} \cup \Set{0,1}\)，取
    \begin{equation*}
      δ = \min\Set[\big]{\,\abs{x - x_0} \mid x \in X\,}
    \end{equation*}
    即可使当\(0 < \abs*{x - x_0} < δ\)时都有\(f(x) < ε\)．同理，可证函数\(f\)在\(0\)处的右极限和在\(1\)处的左极限也是\(0\)，从而它在\(\R\)上的所有极限都是\(0\)．
  \end{proof}
  % TODO: Tidy up the proof
  \begin{proof}
    对于任意的收敛于\(x_0\)的非\(x_0\)数列\(\Seq{x_n}\)，它一定能分割成有理数和无理数两个部分，这两个部分不可能都是有限的，也就是说这两个部分当中，至少有一个部分是无限的．若无理数的那个部分是无限的，将这个部分构成的子列记为\(\Seq{x_{n_k}}\)．那么数列\(\Seq{\,f(x_{n_k})}\)自然收敛于\(0\)．若有理数的那个部分是无限的，将这个部分构成的子列记为\(\Seq{\bar x_{n_k}}\)．只要说明数列\(\Seq{\,f(\bar x_{n_k})}\)也收敛于\(0\)，就能说明数列\(\Seq{\,f(x_n)}\)也收敛于\(0\)，从而函数在\(x \to x_0\)时也收敛于\(0\)．

    接下来，我们来证明数列\(\Seq{\,f(\bar x_{n_k})}\)确实收敛于\(0\)．只需证明，对于任意的\(ε > 0\)，只存在有限个项\(\bar x_{n_k}\)满足\(\,f(\bar x_{n_k}) \ge ε\)即可．因为取\(K = \max\Set[\big]{\,k \mid \,f(\bar x_{n_k}) \ge ε\,}\)，就能使得当\(k > K\)时都有\(f(\bar x_{n_k}) < ε\)．因为\(\bar x_{n_k}\)是有理数，必然能写成\(\bar x_{n_k} = p_k/q_k\)的形式．令
    \begin{equation*}
      P = \Set[\big]{\, p_k \mid \,f(p_k/q_k) \ge ε\,}, \quad
      Q = \Set[\big]{\, q_k \mid \,f(p_k/q_k) \ge ε\,}, \quad
      R = \Set[\big]{\, p_k/q_k \mid \,f(p_k/q_k) \ge ε\,}.
    \end{equation*}
    易证\(\card*Q \in \N\)，从而\(\card*P \in \N\)，所以\(\card*R \in \N\)．若有无穷多项\(\bar x_{n_k}\)满足\(f(\bar x_{n_k}) \ge ε\)，则对于任意的正整数\(K\)都存在一个\(k > K\)满足
    \begin{equation*}
      \abs[\big]{\bar x_{n_k} - x_0} \ge \min\Set[\big]{\,\abs{r - x_0} \mid r \in R \,} > 0.
    \end{equation*}
    这与子列\(\Seq[\big]{\bar x_{n_k}}\)收敛于\(x_0\)是矛盾的．因此只存在有限个项\(\bar x_{n_k}\)满足\(f(\bar x_{n_k}) \ge ε\)．
  \end{proof}
\end{example*}

\subpdfbookmark{思考}{B1.2.4.P}
\subsection*{思考}

\begin{enumerate}
\item 用\(ε\)--\(N\)语言给出\(\lim_{x\to\infty} f(x) = A\)的定量描述．

  \ifshowsolp
  用形式语言的来定义，就是
  \begin{equation*}
    \paren[\big]{\forall ε > 0}
    \paren[\big]{\exists N > 0}
    \paren[\big]{\forall \abs{x} > N}
    \paren[\big]{\abs[\big]{\,f(x) - A} < ε}.
  \end{equation*}
  \fi

  % https://math.stackexchange.com/q/419909/147999
\item 思考函数极限与数列极限之间的关系，并尝试通过数列极限给出各种函数极限存在的柯西收敛原理．

  \ifshowsolp
  设函数\(f\)在点\(a\)附近有定义，当
  \begin{equation*}
    \paren[\big]{\forall ε > 0}
    \paren[\big]{\exists δ > 0}
    \paren[\big]{\forall \abs[\big]{x - a} < δ}
    \paren[\big]{\forall \abs[\big]{y - a} < δ}
    \paren[\big]{\abs[\big]{\,f(x) - f(y)} < ε}
  \end{equation*}
  时，我们称\(f\)在点\(a\)处柯西收敛．

  函数的柯西收敛原理无非是说：函数\(f\)在点\(a\)处极限存在的充分必要条件是它在点\(a\)处柯西收敛．

  \begin{proof}
    易证必要性．下面来证一下充分性．对于任意的\(ε > 0\)都存在\(δ > 0\)使得当\(\abs{x - a} < δ,\ \abs{y - a} < δ\)时都有\(\abs*{\,f(x) - f(y)} < ε\)．这时，对于任何收敛于\(a\)的非\(a\)数列\(\Seq{x_n}\)，自然存在一个正整数\(N\)使得：当\(n\)和\(m\)大于\(N\)时，都有\(\abs*{x_n - a} < δ\)和\(\abs*{x_m - a} < δ\)．所以有\(\abs*{\,f(x_n) - f(x_m)} < ε\)．这就说明数列\(\Seq{\,f(x_n)}\)是柯西列，从而收敛．与不同的数列\(\Seq{x_n}\)所对应的数列\(\Seq{\,f(x_n)}\)必然收敛于同一个数．因为假设收敛于不同的两个数，将不同的两个数列可以合并成一个新的数列\(\Seq{\bar x_n}\)，从而推出\(\Seq{\,f(\bar x_n)}\)发散．这和前面的结论时矛盾的．因此，函数\(f\)在点\(a\)处的极限存在．
  \end{proof}
  \fi
\end{enumerate}

\ifshowex
\currentpdfbookmark{练习}{B1.2.4.E}
\subsection*{练习}

\begin{enumerate}
\item 若\(\lim_{x\to0} \,f(x) = 1\)，则必定\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(f(0) = 1\)
  \item 函数\(f\)在原点没定义．
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    函数\(f\)在原点附近大于\(0\)
  \item 函数\(f\)在原点附近不等于\(1\)
  \end{itemize}

\item 函数\(f(x) = \abs x / x\)在原点处\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 极限存在且为\(1\)
  \item 极限存在但不为\(1\)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    极限不存在但在该点附近有界
  \item 极限不存在且在该点附近无界
  \end{itemize}

\item 函数
  \begin{equation*}
    f(x) =
    \begin{cases}
      \sin\frac1x, & x > 0, \\
      x \sin\frac1x, & x < 0
    \end{cases}
  \end{equation*}
  在原点处\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 左右极限均存在且都为\(0\)
  \item 左右极限均不存在
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    左极限存在，但右极限不存在
  \item 左右极限都存在但不相同
  \end{itemize}

\item 函数
  \begin{equation*}
    f(x) =
    \begin{cases}
      2x, & x > 0, \\
      a \cos x + b \sin x, & x < 0
    \end{cases}
  \end{equation*}
  在原点处\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 极限存在
  \item 极限不存在
  \item 当且仅当\(a = 0,\ b = 0\)时极限存在
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    当且仅当\(a = 0\)时极限存在
  \end{itemize}

\item 关于函数极限，下列结论中，正确的有\uline{\makebox[6em]{%
      \ifshowsol
      \enumparen{2}%
      \enumparen{4}
      \fi}}．
  \begin{enumerate}
    \renewcommand{\labelenumii}{\enumparen{\arabic{enumii}}}
  \item 若\(\lim_{x\to0} \,f(x^2) = A\)，则\(\lim_{x\to0} \,f(x) = A\)
  \item 若\(\lim_{x\to0} \,f(x^3) = A\)，则\(\lim_{x\to0} \,f(x) = A\)
  \item 若函数\(f\)是周期函数且\(\lim_{x\to0} \,f(x) = A\)，则\(f(x) \equiv A\)
  \item 若函数\(f\)是周期函数且\(\lim_{x\to\infty} \,f(x) = A\)，则\(f(x) \equiv A\)
  \end{enumerate}

\item 狄利克雷函数（定义~\ref{defn:dirichlet}）\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 在任意点处的极限都存在
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    在任意点处的极限都不存在
  \item 仅在有理点处的极限存在
  \item 仅在无理点处的极限存在
  \end{itemize}

\item 下列说法中，正确的是\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item
    \begin{math}
      \paren[\big]{\exists ε > 0}
      \paren[\big]{\forall δ > 0}
      \paren[\big]{\forall 0 < \abs{x} < δ}
      \paren[\big]{\abs[\big]{\,f(x) - A} < ε}
      \implies
      \lim_{x\to0} \,f(x) = A
    \end{math}
  \item
    \begin{math}
      \paren[\big]{\exists ε > 0}
      \paren[\big]{\exists δ > 0}
      \paren[\big]{\forall 0 < \abs{x} < δ}
      \paren[\big]{\abs[\big]{\,f(x) - A} < ε}
      \implies
      \lim_{x\to0} \,f(x) = A
    \end{math}
  \item
    \begin{math}
      \lim_{x\to0} \,f(x) = A
      \implies
      \paren[\big]{\forall ε > 0}
      \paren[\big]{\forall δ > 0}
      \paren[\big]{\forall 0 < \abs{x} < δ}
      \paren[\big]{\abs[\big]{\,f(x) - A} < ε}
    \end{math}
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \begin{math}
      \paren[\big]{\forall ε > 0}
      \paren[\big]{\forall δ > 0}
      \paren[\big]{\forall 0 < \abs{x} < δ}
      \paren[\big]{\abs[\big]{\,f(x) - A} < ε}
      \implies
      \lim_{x\to0} \,f(x) = A
    \end{math}
  \end{itemize}
\end{enumerate}
\fi

\section{函数极限的运算}

% TODO: Expatiate on tending to infinity
\begin{theorem}[函数极限的四则运算]
  \label{thm:limfunc4ops}
  若\(\lim_{x \to x_0} \,f(x) = A,\ \lim_{x \to x_0} \,g(x) = B\)，则
  \begin{enumerate}
    \renewcommand{\labelenumi}{\enumparen{\arabic{enumi}}}
  \item \(\displaystyle \lim_{x \to x_0} \paren*{\,f(x) \pm g(x)} = A \pm B\)；
  \item \(\displaystyle \lim_{x \to x_0} \,f(x)\,g(x) = AB\)；
  \item \(\displaystyle \lim_{x \to x_0} \tfrac{f(x)}{g(x)} = \tfrac AB\ (B \ne 0)\)．
  \end{enumerate}

  \begin{proof}
    应用定理~\ref{thm:seq4ops}和定理~\ref{thm:limequiv}即可得证．
  \end{proof}
\end{theorem}

\begin{example*}
  求\(\!\lim\limits_{x\to+\infty} \dfrac{5a^x - 3b^x}{5a^x + 3b^x}\ (a > 0,\ b > 0)\)．\rule{0ex}{4ex}

  \begin{remark}
    当\(a = b\)时，有\(\lim_{x\to+\infty} \frac{5a^x - 3b^x}{5a^x + 3b^x} = \lim_{x\to+\infty} \frac{5a^x - 3a^x}{5a^x + 3a^x} = \frac14\)．当\(a > b\)时，有
    \begin{align*}
      \lim_{x\to+\infty} \frac{5a^x - 3b^x}{5a^x + 3b^x}
      &= \lim_{x\to+\infty} \frac{5 - 3(b^x\!/a^x)}{5 + 3(b^x\!/a^x)}
        = \lim_{x\to+\infty} \frac{5 - 3(b/a)^x}{5 + 3(b/a)^x}
      && \reason{变形} \\
      &= \frac{\lim_{x\to+\infty} \paren*{5 - 3(b/a)^x}}{\lim_{x\to+\infty} \paren*{5 + 3(b/a)^x}}
      && \reason{除法规则} \\
      &= \frac{\lim_{x\to+\infty} 5 - \lim_{x\to+\infty} 3(b/a)^x}{\lim_{x\to+\infty} 5 + \lim_{x\to+\infty} 3(b/a)^x}
      && \reason{加减法规则} \\
      &= \frac{5 - 3 \lim_{x\to+\infty} (b/a)^x}{5 + 3 \lim_{x\to+\infty} (b/a)^x}
      && \reason{乘法规则} \\
      &= 1.
    \end{align*}
    同理可知，当\(a < b\)时，有\(\lim_{x\to+\infty} \frac{5a^x - 3b^x}{5a^x + 3b^x} = -1\)．所以,
    \begin{equation*}
      \lim_{x\to+\infty} \frac{5a^x - 3b^x}{5a^x + 3b^x} =
      \begin{cases}
        \dfrac14, & a = b, \\
        1, & a > b, \\
        -1, & a < b.
      \end{cases}
    \end{equation*}
  \end{remark}
\end{example*}

\begin{example*}
  求\(\displaystyle \lim_{x\to2} \frac{x^2 + x - 6}{\sqrt{x\mathstrut} - \sqrt{4-x\mathstrut}}\)．

  \begin{remark}
    分母有理化后，得到
    \begin{equation*}
      \lim_{x\to2} \frac{x^2 + x - 6}{\sqrt{x\mathstrut} - \sqrt{4-x\mathstrut}}
      = \lim_{x\to2} \frac{%
        \paren[\big]{x^2 + x - 6}
        \paren[\big]{\sqrt{x\mathstrut} + \sqrt{4-x\mathstrut}}}{%
        x - 4 + x}
      = \lim_{x\to2} \frac{%
        \paren[\big]{x-2}
        \paren[\big]{x+3}
        \paren[\big]{\sqrt{x\mathstrut} + \sqrt{4-x\mathstrut}}}{%
        2(x-2)}
      = 5\sqrt2\,.
    \end{equation*}
  \end{remark}
\end{example*}

\begin{theorem}[复合函数的极限]
  \label{thm:limfunccomp}
  若函数\(f\)在点\(B\)处的极限是\(A\)，函数\(g\)在点\(x_0\)处的极限是\(B\)且在点\(x_0\)附近不等于\(B\)，则复合函数\(f \circ g\)在点\(x_0\)的极限是\(A\)．

  \begin{proof}
    应用定理~\ref{thm:limequiv}即可得证．
  \end{proof}
\end{theorem}

\begin{example*}
  令\(f(u) = \abs*{\sgn x}\,,\ g(x) = x \Fn D(x)\)．复合函数\(f \circ g\)在原点处的极限存在吗？

  \begin{remark}
    不存在．若“生吞活剥”地套用上述定理，就可能得出极限存在且为\(1\)的结论．实际上，
    \begin{equation*}
      (\,f \circ g)(x)
      = \abs[\Big]{\sgn\paren[\big]{x \Fn D(x)}} =
      \begin{cases}
        \Fn D(x), & x \ne 0, \\
        0, & x = 0.
      \end{cases}
    \end{equation*}
    函数的极限在某点处的极限和它在这点的取值无关，狄利克雷函数在实轴上处处极限不存在，因此该复合函数在原点自然也不存在．误用上述定理的原因是：函数\(g\)在原点附近总是能取到\(0\)，由于无理数是稠密的．
  \end{remark}
\end{example*}

\begin{theorem}
  \label{thm:limfuncpowexp}
  在同一个极限过程中，若函数\(f\)的极限是正数\(A\)且函数\(g\!\)的极限是\(B\)，则函数\(\,f^g\!\)的极限是\(A^B\)．

  \begin{proof}
    运用两次定理~\ref{thm:limfunccomp}和一次定理~\ref{thm:limfunc4ops}，有
    \begin{align*}
      \lim_{x \to x_0\!} \,f(x)^{g(x)}
      &= {}\smashoperator{\lim_{x \to x_0\!}} \expb[\Big]{\ln \,f(x)^{g(x)}}
        = {}\smashoperator{\lim_{x \to x_0\!}} \expb[\Big]{g(x) \ln \,f(x)}
        = \expb[\Big]{\lim_{x \to x_0\!} g(x) \ln \,f(x)} \\
      &= \expb[\Big]{\lim_{x \to x_0\!} g(x) \smashoperator[r]{\lim_{x \to x_0\!}} \ln \,f(x)}
        = \expb[\Big]{B \ln {}\smashoperator{\lim_{x \to x_0\!}} \,f(x)} \\
      &= \expb[\big]{B \ln A} = \expb[\big]{\ln A^B} = A^B.
    \end{align*}
    注意，在使用定理~\ref{thm:limfunccomp}的时候，用到了指数函数和对数函数都是连续函数（见\hyperref[chap:cont]{下章}）的事实．
  \end{proof}
\end{theorem}

\begin{theorem}[函数极限的夹逼定理]
  \label{thm:funcsqueeze}
  若函数\(f,\ g,\ h\)满足：
  \begin{enumerate}[topsep=0ex,itemsep=0ex]
    \renewcommand{\labelenumi}{\enumparen{\arabic{enumi}}}
  \item 在点\(x_0\)附近有\(f \le g \le h\)，
  \item \(\lim\limits_{x \to x_0} \,f(x) = \lim\limits_{x \to x_0} h(x) = A\)，
  \end{enumerate}
  则\(\lim\limits_{x \to x_0} g(x) = A\)．

  \begin{proof}
    应用定理~\ref{thm:limequiv}即可得证．
  \end{proof}
\end{theorem}

\begin{example*}
  求\(\lim\limits_{x\to0} x \floor[\bigg]{\dfrac1x}\)．

  \begin{remark}
    实际上，当\(x > -1\)时，有
    \begin{equation*}
      \Fn H(-x) + \frac{\floor{1/x}}{\floor{1/x}+1} \Fn H(x)
      \le
      x \floor[\bigg]{\dfrac1x}
      \le
      \frac{\floor{1/x}}{\floor{1/x}+1} \Fn H(-x) + \Fn H(x),
    \end{equation*}
    其中\(\Fn H\)为单位阶跃函数（定义~\ref{defn:heaviside}）．所以，\(\lim\limits_{x\to0} x \floor[\bigg]{\dfrac1x} = 1\)．
  \end{remark}
\end{example*}

\begin{theorem*}
  \(\lim\limits_{x\to0} \dfrac{\sin x}{x} = 1\).

  \begin{proof}
    根据三角函数在几何上的意义，当\(0 < x < \pi/2\)时，有
    \begin{equation*}
      \sin x < x < \tan x
      \iff
      1 < \frac{x}{\sin x} < \sec x
      \iff
      \cos x < \frac{\sin x}{x} < 1.
    \end{equation*}
    使用一次夹逼定理，得
    \begin{equation*}
      \lim_{x\to0^+\negthickspace} \frac{\sin x}{x} = 1,
    \end{equation*}
    又因为这个函数是偶函数，所以\(\lim\limits_{x\to0} \dfrac{\sin x}{x} = 1\)．
  \end{proof}
\end{theorem*}

\begin{example*}
  常见的极限结论：
  \begin{equation*}
    \lim_{x\to0} \frac{\tan x}{x} = 1,
    \quad
    \lim_{x\to0} \frac{1 - \cos x}{x^2} = \frac12,
    \quad
    \lim_{x\to0} \frac{\arcsin x}{x} = 1,
    \quad
    \lim_{x\to0} \frac{\arctan x}{x} = 1.
  \end{equation*}
\end{example*}

\begin{example*}
  求\(\lim\limits_{x\to0} \dfrac{\sin ax}{\sin bx}\ (b \ne 0)\)．

  \begin{remark}
    当\(a \ne 0\)时，有
    \begin{equation*}
      \lim_{x\to0} \frac{\sin ax}{\sin bx}
      = \lim_{x\to0} \frac{\sin ax}{ax} \frac{ax}{bx} \frac{bx}{\sin bx}
      = \frac ab.
    \end{equation*}
    当\(a = 0\)时，有\(\lim\limits_{x\to0} \dfrac{\sin ax}{\sin bx} = 0 = \dfrac ab\)．所以，无论\(a\)的取值，都有\(\lim\limits_{x\to0} \dfrac{\sin ax}{\sin bx} = \dfrac ab\)．
  \end{remark}
\end{example*}

\begin{example*}
  求\(\lim\limits_{x\to1} \dfrac{\sinp{1-x}}{\sqrt x - 1}\)．\rule{0ex}{3.5ex}

  \begin{equation*}
    \lim_{x\to1} \frac{\sinp{1-x}}{\sqrt x - 1}
    = \lim_{x\to1} \frac{-\paren{\sqrt x + 1} \sinp{x-1}}{x - 1}
    = -2.
  \end{equation*}
\end{example*}

\begin{example*}
  求\(\;\smashoperator[l]{\lim\limits_{x\to\pi/2}} \dfrac{\cos x}{\pi/2 - x}\)．\rule{0ex}{3.5ex}

  \begin{equation*}
    \lim_{x\to\pi/2} \frac{\cos x}{\pi/2 - x}
    = - \smashoperator{\lim_{x\to\pi/2}} \frac{\cosp{x-\pi/2+\pi/2}}{x - \pi/2}
    = - \smashoperator{\lim_{x\to\pi/2}} \frac{-\sinp{x-\pi/2}}{x-\pi/2}
    = 1.
  \end{equation*}
\end{example*}

\begin{theorem*}
  \(\!\lim\limits_{x\to\infty} \paren[\bigg]{1 + \dfrac1x}^x = e\).\rule{0ex}{3.5ex}

  \begin{proof}
    应用定理~\ref{thm:seqe}和定理~\ref{thm:funcsqueeze}即可得证．
  \end{proof}
\end{theorem*}

\begin{example*}
  求\(\lim\limits_{x\to0} \dfrac{\ln(1+x)}{x} = 1\)．\rule{0ex}{3.5ex}

  \begin{remark}
    令\(t = 1/x\)，有
    \begin{equation*}
      \lim_{x\to0} \frac{\ln(1+x)}{x}
      = \lim_{x\to0} \ln(1+x)^{1/x}
      = \lim_{t\to\infty} \lnp[\bigg]{1 + \frac1t}^t
      = \ln e
      = 1.
    \end{equation*}
  \end{remark}
\end{example*}

\begin{example*}
  求\(\lim\limits_{x\to0} \dfrac{e^x-1}{x}\)．

  \begin{remark}
    令\(t = e^x - 1\)，有
    \begin{equation*}
      \lim_{x\to0} \frac{e^x-1}{x}
      = \lim_{t\to0} \frac{t}{\ln(1+t)}
      = 1.
    \end{equation*}
  \end{remark}
\end{example*}

\begin{example*}
  求\(\lim\limits_{x\to0} \dfrac{a^x-1}{x}\ (a > 0)\)．

  \begin{remark}
    当\(a \ne 1\)时，有
    \begin{equation*}
      \lim_{x\to0} \frac{a^x-1}{x}
      = \lim_{x\to0} \frac{e^{x \ln a}-1}{x \ln a} \ln a
      = \ln a.
    \end{equation*}
    当\(a = 1\)时，有
    \begin{equation*}
      \lim_{x\to0} \frac{a^x-1}{x}
      = \lim_{x\to0} \frac{0}{x}
      = 0 = \ln a.
    \end{equation*}
    所以，\(\lim\limits_{x\to0} \dfrac{a^x-1}{x} = \ln a\)．
  \end{remark}
\end{example*}

\begin{example*}
  求\(\lim\limits_{x\to\infty} \paren[\bigg]{\dfrac{x+5}{x+2}}^{\mathrlap{x+3}}\)．

  \begin{remark}
    稍作变形，有
    \begin{align*}
      \lim_{x\to\infty} \paren[\bigg]{\frac{x+5}{x+2}}^{x+3}\negthickspace
      &= \lim_{x\to\infty} \paren[\bigg]{1 + \frac{3}{x+2}}^{x+2} \paren[\bigg]{%
        1 + \frac{3}{x+2}} \\
      &= \lim_{x\to\infty} \paren[\bigg]{1 + \frac{1}{(x+2)/3}}^{(x+2)/3\cdot3} \paren[\bigg]{%
        1 + \frac{3}{x+2}} \\
      &= e^3.
    \end{align*}
  \end{remark}
\end{example*}

\begin{example*}
  求\(\lim\limits_{x\to0} (\cos x)^{1/\!\sin^2 x}\)．

  \begin{remark}
    稍作变形，有
    \begin{align*}
      \lim_{x\to0} (\cos x)^{1/\!\sin^2 x}
      &= \lim_{x\to0} \expb[\Bigg]{\frac{\ln \cos x}{\sin^2 x}} \\
      &= \lim_{x\to0} \expb[\Bigg]{
        \frac{\lnp{1 - 2 \sin^2 \frac x2}}{
        \paren{2 \sin\frac x2 \cos\frac x2}^2}} \\
      &= \lim_{x\to0} \expb[\Bigg]{
        \frac{\lnp{1 - 2 \sin^2 \frac x2}}{-2 \sin^2 \frac x2}
        \cdot \frac{1}{-2 \cos^2 \frac x2}} \\
      &= e^{-1/2} = \frac1{\!\sqrt e\,}.
    \end{align*}
  \end{remark}
\end{example*}

\subpdfbookmark{思考}{B1.2.5.P}
\subsection*{思考}

复合函数求极限的条件是什么？若不满足该条件，会出现什么问题？

\ifshowsolp
\pskip
要在自变量趋向的点附近存在一个去心邻域，使得内部函数在此邻域上不等于所趋向的极限值．若不满足，则可能所求的极限不存在，或者等于其他值．
\fi

\ifshowex
\currentpdfbookmark{练习}{B1.2.5.E}
\subsection*{练习}

\begin{enumerate}
\item 函数
  \begin{equation*}
    f(x) = \frac{2+e^{1/x}}{1+e^{4/x}} + \frac{\sin x}{\abs x}
  \end{equation*}
  在原点处\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    极限存在
  \item 左极限存在，右极限不存在
  \item 左极限不存在，右极限存在
  \item 左右极限都存在但不相等
  \end{itemize}

  \ifshowsol
  实际上，有
  \begin{gather*}
    \lim_{\,x\to0^+} \,f(x)
    = {}\smashoperator[l]{\lim_{\,x\to0^+}} \paren[\bigg]{\frac{2/e^{1/x} + 1}{1/e^{1/x} + e^{3/x}} + \frac{\sin x}{x}}
    = 1
    \siand
    \lim_{\,x\to0^-} \,f(x)
    = {}\smashoperator[l]{\lim_{\,x\to0^-}} \paren[\bigg]{\frac{2+e^{1/x}}{1+e^{4/x}} - \frac{\sin x}{x}}
    = 1.
  \end{gather*}
  所以函数\(f\)在原点处的极限是\(1\)．
  \fi

\item 若\(\lim\limits_{x \to x_0} \,f(x)\)存在且\(\lim\limits_{x \to x_0} g(x)\)不存在，则\uline{\makebox[10em]{}}．
  \begin{itemize}[itemsep=1ex]
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(\lim\limits_{x \to x_0} \,f(x)\,g(x)\)和\(\lim\limits_{x \to x_0} \dfrac{g(x)}{f(x)}\)一定都不存在
  \item \(\lim\limits_{x \to x_0} \,f(x)\,g(x)\)和\(\lim\limits_{x \to x_0} \dfrac{g(x)}{f(x)}\)一定都存在
  \item 在\(\lim\limits_{x \to x_0} \,f(x)\,g(x)\)和\(\lim\limits_{x \to x_0} \dfrac{g(x)}{f(x)}\)中恰有一个存在
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(\lim\limits_{x \to x_0} \paren*{\,f(x)+g(x)}\)和\(\lim\limits_{x \to x_0} \paren*{\,f(x)-g(x)}\)一定都不存在
  \end{itemize}

  \ifshowsol
  令\(f(x) = x\)和\(g(x) = 1/x\)，可以证伪选项~A和~B．在此基础上，令\(g(x) = 1/x^2\)，可以证伪选项~C．实际上，在题干的条件下，\(\lim\limits_{x \to x_0} \paren*{\,f(x)+g(x)}\)、\(\lim\limits_{x \to x_0} \paren*{\,f(x)-g(x)}\)和\(\lim\limits_{x \to x_0} \dfrac{g(x)}{f(x)}\)一定都不存在．当\(\lim\limits_{x \to x_0} \,f(x) \ne 0\)时，\(\lim\limits_{x \to x_0} \,f(x)\,g(x)\)一定不存在．当\(\lim\limits_{x \to x_0} \,f(x) = 0\)时，\(\lim\limits_{x \to x_0} \,f(x)\,g(x)\)可能存在也可能不存在．
  \fi

\item 若\(\lim_{x\to\infty} \paren[\bigg]{\dfrac{x^2+1}{x+1} - ax -b} = 0\)，则\(a\)和\(b\)的值分别为\uline{\makebox[3em]{%
      \ifshowsol
      \(-1\)
      \fi}}和\uline{\makebox[3em]{%
      \ifshowsol
      \(1\)
      \fi}}．

\item 求\(\lim\limits_{n\to\infty} \sin^2 \pi\sqrt{n^2+1}\)．

  \ifshowsol
  稍作变形，有
  \begin{align*}
    \lim_{n \to \infty} \sin^2 \pi\sqrt{n^2+1}
    &= \lim_{n \to \infty} \sin^2 \brce[\big]{\paren[\big]{\sqrt{n^2+1} - \sqrt{n^2} + \sqrt{n^2}} \pi} \\
    &= \lim_{n \to \infty}
      \bigl\lbrace
      \sin\brkt[\big]{\paren[\big]{\sqrt{n^2+1} - \sqrt{n^2}}\pi}
      \cos\pi\sqrt{n^2} \\
    &\hphantom{= \lim_{n \to \infty} \lbrace} +
      \cos\brkt[\big]{\paren[\big]{\sqrt{n^2+1} - \sqrt{n^2}}\pi}
      \sin\pi\sqrt{n^2}
      \bigr\rbrace^2 \\
    &= \lim_{n \to \infty}
      \sin^2\brkt[\big]{\paren[\big]{\sqrt{n^2+1} - \sqrt{n^2}}\pi}
      \cos^2\pi\sqrt{n^2} \\
    &= \lim_{n \to \infty} \sin^2\brkt[\big]{\paren[\big]{\sqrt{n^2+1} - \sqrt{n^2}}\pi} \\
    &= 0.
  \end{align*}
  \fi

\item 若\(\!\lim\limits_{x\to-\infty} \paren[\big]{\sqrt{x^2 - x + 1} - ax - b} = 0\)，则\(a\)和\(b\)的值分别为\uline{\makebox[3em]{%
      \ifshowsol
      \(-1\)
      \fi}}和\uline{\makebox[3em]{%
      \ifshowsol
      \(1/2\)
      \fi}}．

\item 求\(\lim\limits_{x\to0} \paren{2 \sin x + \cos x}^{1/x}\)．

  \ifshowsol
  稍作变形，有
  \begin{align*}
    \lim_{x\to0} \paren{2 \sin x + \cos x}^{1/x}
    &= \lim_{x\to0} \expb[\bigg]{
      \frac{\lnp{1 + 2 \sin x + \cos x - 1}}{2 \sin x + \cos x - 1}
      \cdot
      \frac{2 \sin x + \cos x - 1}{x}} \\
    &= e^2.
  \end{align*}
  \fi

\item 若函数
  \begin{equation*}
    f(x) =
    \begin{dcases}
      \frac{\sin x}{x}, & x \ne 0, \\
      0, & x = 0
    \end{dcases}
    \txt{且}
    g(t) = t \sin\frac1t,
    \qquad
  \end{equation*}
  则\(\lim\limits_{t\to0} \,f\,\paren*{g(t)}\)\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 等于\(1\)
  \item 等于\(0\)
  \item 等于\(-1\)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    不存在
  \end{itemize}

  \ifshowsol
  若令\(t_n = 1/n\pi\)，则\(\lim\limits_{n\to\infty} \,f\,\paren*{g(t_n)} = 0\)．若令\(t_n = 1/(n\pi+1)\)，则\(\lim\limits_{n\to\infty} \,f\,\paren*{g(t_n)} = 1\)．根据定理~\ref{thm:limequiv}，所以\(\lim\limits_{t\to0} \,f\,\paren*{g(t)}\)不存在．
  \fi

\item 求\(\!\lim\limits_{\,x\to0^+\!} \paren{\cos\sqrt x}^{\pi/x}\)．

  \ifshowsol
  略作变形，有
  \begin{equation*}
    \lim_{\,x\to0^+\!} \paren{\cos\sqrt x}^{\pi/x}
    = \lim_{\,x\to0^+\!} \expb[\bigg]{\frac{\pi \ln\cos\sqrt x}{x}}
    = \lim_{\,x\to0^+\!} \expb[\bigg]{
      \frac{\pi \lnp{1 + \cos\sqrt x - 1}}{\cos\sqrt x - 1}
      \cdot
      \frac{\cos\sqrt x - 1}{x}}
    = e^{-\pi/2}.
  \end{equation*}
  \fi

\item 求\(\lim\limits_{x\to1} \dfrac{\sinp{x-1}}{\sqrt x - 1}\)．

  \ifshowsol
  \begin{equation*}
    \lim_{x\to1} \frac{\sinp{x-1}}{\sqrt x - 1}
    = \lim_{x\to1} \frac{\sinp{x-1}}{x-1} \cdot \frac{x-1}{\sqrt x - 1}
    = 2\,.
  \end{equation*}
  \fi
\end{enumerate}
\fi

\section{无穷小量及其（阶的）比较}

\begin{definition*}
  若\(\!\lim\limits_{\,x \to x_0\!} \,f(x) = 0\)，则称函数\(f\)在\(x \to x_0\)时是一个无穷小量，记作\(f(x) = \littleo(1)\ (x \to x_0)\)．
\end{definition*}

\begin{definition*}
  对于任意的\(M > 0\)都存在\(δ > 0\)使得当\(0 < \abs*{x - x_0} < δ\)时都有\(\abs*{\,f(x)} > M\)．这时，我们称函数\(f\)在\(x \to x_0\)时是一个无穷大量，记作\(\!\lim\limits_{\,x \to x_0\!} \,f(x) = \infty\)．
\end{definition*}

\begin{theorem*}
  无穷大量的倒数是无穷小量．
\end{theorem*}

\begin{theorem*}
  非零无穷小量的倒数是无穷大量．
\end{theorem*}

\begin{theorem*}
  无穷小量与有界变量的乘积还是无穷小量．
\end{theorem*}

\begin{theorem*}
  函数\(f\)极限是\(A\)，当且仅当它可以写成\(A\)与一个无穷小量之和的形式．
\end{theorem*}

% https://portal.tpu.ru/SHARED/k/KONVAL/Textbooks/Tab1/Konev-Limits_of_Sequences_and_Functions_Textbook.pdf
\begin{definition*}
  在同一个极限过程中，函数\(f\)和\(g\)都是无穷小量．
  \begin{enumerate}[topsep=3pt,itemsep=0ex]
    \renewcommand{\labelenumi}{\enumparen{\arabic{enumi}}}
  \item 若\(f/g\)收敛于某个非零常数，则称\(f\)和\(g\)是\emph{同阶无穷小量}；特别地，若此常数是\(1\)，则称\(f\)和\(g\)是\emph{等价无穷小量}，记作\(f \sim g\)；
  \item 若\(f/g\)也是无穷小量，则称\(f\)是\(g\)的\emph{高阶无穷小量}\footnote{关于小o和大O关系，最常见的定义，除了还要求\(g\)是一个正函数之外，其实并不关心\(f\)和\(g\)是否收敛或者为无穷大量，只要它们的商满足条件即可．若\(f\)是\(g\)的高阶无穷小量，则一定满足\(f = \littleo(\abs{g})\)；反之不然\,．这里的小o和大O记号，其实表达的是一个函数的集合，更严谨的用法应该是\(f \in \littleop g\)和\(f \in \bigOp g\)．}，称\(g\)是\(f\)的\emph{低阶无穷小量}，记作\(f= \littleo(g)\)；特别地，若\(f/g^n\)收敛于某个非零常数，则称\(f\)是\(g\)的\(n\)阶无穷小量．
  \end{enumerate}

  \begin{remark}
    我们简称函数\(x-x_0\)在点\(x_0\)处和函数\(1/x\)在无穷处的\(k\)阶无穷小量为\(k\)阶无穷小量．也就是说，函数\(f\)在点\(x_0\)处是\(k\)阶无穷小量，当且仅当\(0 < \abs[\Big]{\lim\limits_{\,x \to x_0\!} \frac{f(x)}{(x-x_0)^k}} < +\infty\)；函数\(f\)在无穷处是\(k\)阶无穷小量，当且仅当\(0 < \abs[\Big]{\lim\limits_{x\to\infty} x^k\,f(x)} < +\infty\)．
  \end{remark}
\end{definition*}

\begin{definition*}
  在同一个极限过程中，函数\(f\)和\(g\)都是无穷小量．若\(f/g\)有界，则称\(f\)和\(g\)有大O关系\footnote{同上．}，记作\(f = \bigO(g)\)．
\end{definition*}

\begin{example*}
  证明\(\sqrt[\leftroot{-2}\uproot{2}k]{1+x} - 1 \sim \dfrac xk\ (x \to 0)\)．

  \begin{proof}
    利用公式\(a^n-b^n = (a-b)(a^{n-1} + a^{n-2}b + \dots + b^{n-1})\)，稍作变形，有
    \begin{align*}
      \lim_{x\to0} \frac{\sqrt[\leftroot{-2}\uproot{2}k]{1+x} - 1}{x/k}
      &= \lim_{x\to0} \frac{k(1+x-1)}{
        x \sum_{j=0}^{k-1} (1+x)^{(k-1-j)/k}}
      && \reason{分子分母同乘以\(\Sigma\)} \\
      &= k\big/\!\lim_{x\to0} \sum_{j=0}^{k-1} (1+x)^{(k-1-j)/k}
      && \reason{除法法则} \\
      &= k\bigg/\!\sum_{j=0}^{k-1} \lim_{x\to0} (1+x)^{(k-1-j)/k}
      && \reason{加法法则} \\
      &= k/k = 1.
      && \reason{复合法则}
         \qedhere
    \end{align*}
  \end{proof}
\end{example*}

\begin{theorem*}
  若\(f \sim α,\ g \sim β \)，则\(\lim \,f/g = \lim α/β\)．

  \begin{proof}
    \begin{equation*}
      \lim \frac{\,f}{g}
      = \lim \frac{\,f}{α} \cdot \frac{α}{β} \cdot \frac{β}{g}
      = \lim \frac{α}{β}
      \qedhere
    \end{equation*}
  \end{proof}
\end{theorem*}

\begin{example*}
  求\(\lim\limits_{x\to0} \dfrac{\tan x - \sin x}{x^3}\)．\rule[-2ex]{0ex}{0ex}

  \begin{remark}
    稍作变形，有
    \begin{equation*}
      \lim_{x\to0} \frac{\tan x - \sin x}{x^3}
      = \lim_{x\to0} \frac{1}{\cos x} \cdot \frac{1 - \cos x}{x^2} \cdot \frac{\sin x}{x}
      = \frac12.
    \end{equation*}
  \end{remark}
\end{example*}

\begin{example*}
  求\(\lim\limits_{x\to0} \dfrac{e^{1-\cos x}-1}{x^2}\)．\rule[-2ex]{0ex}{3.5ex}

  \begin{remark}
    使用等价无穷小量替换和复合法则，有
    \begin{equation*}
      \lim_{x\to0} \frac{e^{1-\cos x}-1}{x^2}
      = \lim_{x\to0} \frac{e^{1-\cos x}-1}{2(1-\cos x)}
      = \frac12.
    \end{equation*}
  \end{remark}
\end{example*}

\begin{example*}
  求\(\lim\limits_{x\to0} \dfrac{\ln(1+ax^m)}{1-\cos(1-\cos x)}\ (a \ne 0, m > 0)\)．\rule[-2ex]{0ex}{3.5ex}

  \begin{remark}
    使用等价无穷小量替换和复合法则，有
    \begin{equation*}
      \lim_{x\to0} \frac{\ln(1+ax^m)}{1-\cos(1-\cos x)}
      = \lim_{x\to0} \frac{ax^m}{(1-\cos x)^2\!/2}
      = \lim_{x\to0} \frac{ax^m}{x^4\!/8}
      = \lim_{x\to0} 8\,ax^{m-4} =
      \begin{cases}
        0, & m > 4, \\
        8\,a, & m = 4, \\
        \infty, & 0 < m < 4.
      \end{cases}
    \end{equation*}
  \end{remark}
\end{example*}

\subpdfbookmark{思考}{B1.2.6.P}
\subsection*{思考}

\begin{enumerate}
\item 两个无穷小量之和是不是无穷小量？两个无穷大量之和是不是无穷大量？

  \ifshowsolp
  是．不是．前者可由极限的加法法则得出．后者可以构造反例，函数\(f(x) = x,\ g(x) = -x\)．这里的\(f\)和\(g\)在无穷处都是无穷大量，但是\(f+g\)是常函数．
  \fi

\item 任意两个无穷小量是否都可以比阶？试举例说明．

  \ifshowsolp
  不一定．例如，函数\(x \sin\frac1x\)和\(x\)在原点处都是无穷小量，但是它们的商发散．
  \fi
\end{enumerate}

\ifshowex
\currentpdfbookmark{练习}{B1.2.6.E}
\subsection*{练习}

\begin{enumerate}
\item 下列说法中，正确的是\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    无穷小量与无穷大量之和为无穷大量
  \item 无穷小量与无穷大量之积为无穷大量
  \item 无穷小量与无穷大量之差为无穷小量
  \item 无穷小量与无穷大量之积为无穷小量
  \end{itemize}

  \ifshowsol
  令\(f(x) = \sin x,\ g(x) = \frac1x\)，则在原点处\(f\)和\(g\)分别是无穷小量和无穷大量．但是\(f \cdot g\)即不是无穷小量，也不是无穷大量．所以选项~B和~D都错了．设\(f\)和\(g\)在点\(a\)处分别是无穷小量和无穷大量．对于任意的\(M > 0\)都存在一个去心邻域使得当\(x\)在此邻域上时都有
  \begin{gather*}
    \abs*{\,f(x)} < M
    \txt{且}
    2\,M < \abs*{g(x)} \\
    \shortintertext{即}
    \abs*{\,f(x) \pm g(x)}
    \ge \abs[\Big]{\abs*{g(x)} - \abs*{\,f(x)}}
    \ge \abs*{g(x)} - \abs*{\,f(x)}
    > M.
  \end{gather*}
  所以选项~A对了而选项~C错了．
  \fi

\item 当\(x \to 0\)时，下列函数中不是无穷小量的是\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(\sin(\tan x^2)\)
  \item \(x \cos\frac1x\)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(\sin\paren{\cos x}\)
  \item \(\lnp{\sin x + 1}\)
  \end{itemize}

\item 当\(x \to 0^+\)时，下列函数中不是无穷大量的是\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(x - \ln x\)
  \item \(x + \ln x\)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(x \ln x\)
  \item \(\dfrac{\ln x}{x}\)\rule{0ex}{3.5ex}
  \end{itemize}

  \ifshowsol
  对于选项~C，令\(t = -\ln x\)，实际上有
  \begin{equation*}
    \lim_{\,x \to 0^+\!} \!x \ln x
    = - \smashoperator{\lim_{\,t \to +\infty\!}} te^{-t}
    = 0.
  \end{equation*}
  \fi

\item 当\(x \to 0^+\)时，下列无穷小量按照其阶由低到高排列正确的是\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(\sin x^2,\ \sin(\tan x),\ e^{x^3}-1,\ \lnp{1+\sqrt x}\)
  \item \(\lnp{1+\sqrt x},\ \sin x^2,\ \sin(\tan x),\ e^{x^3}-1\)
  \item \(\sin(\tan x),\ \lnp{1+\sqrt x},\ \sin x^2,\ e^{x^3}-1\)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(\lnp{1+\sqrt x},\ \sin(\tan x),\ \sin x^2,\ e^{x^3}-1\)
  \end{itemize}

  \ifshowsol
  实际上，有
  \begin{equation*}
    \lnp{1+\sqrt x} \sim \sqrt x, \quad
    \sin(\tan x) \sim x, \quad
    \sin x^2 \sim x^2, \quad
    e^{x^3}-1 \sim x^3.
  \end{equation*}
  \fi

\item 当\(n \to \infty\)时，下列无穷大量按照其阶由低到高排列正确的是\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(\sqrt n,\ n^2,\ e^n,\ n!,\ n^n\)
  \item \(n^2,\ e^n,\ n!,\ \sqrt n,\ n^n\)
  \item \(\sqrt n,\ n^2,\ n!,\ e^n,\ n^n\)
  \item \(\sqrt n,\ n^2,\ n!,\ n^n,\ e^n\)
  \end{itemize}

  \ifshowsol
  关于\(e^n = \littleop{n!}\)，参见例~\ref{eg:factexp}．下面证明一下，对于给定的数\(a > 1\)和正整数\(k\)，都有\(n^k = \littleop{a^n}\)．

  \begin{proof}
    令\(α = a - 1\)，则
    \begin{gather*}
      a^n = (1+α)^n = \sum_{j=0}^n \binom nj α^j > \binom{n}{k+1} α^{k+1}
      = α^{k+1} n^{k+1} + \bigOp{n^k}, \\
      \shortintertext{所以有}
      0 < \frac{n^k}{a^n} < \frac{n^k}{α^{k+1} n^{k+1} + \bigOp{n^k}}
      = \frac{1}{α^{k+1} n + \bigOp{1}}.
      \qedhere
    \end{gather*}
  \end{proof}
  \fi

\item 当\(x \to 0^+\)时，与\(\sqrt x\)等价的无穷小量是\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(1 - e^{\sqrt x}\)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(\ln \dfrac{1+x}{1-\sqrt x}\)\rule[-2ex]{0ex}{5ex}
  \item \(\sqrt{1 + \sqrt x} - 1\)
  \item \(1 - \cos\sqrt x\)
  \end{itemize}

  \ifshowsol
  实际上，有
  \begin{equation*}
    1 - e^{\sqrt x} \sim -\sqrt x, \quad
    \ln \dfrac{1+x}{1-\sqrt x} \sim \sqrt x, \quad
    \sqrt{1 + \sqrt x} - 1 \sim \frac{\sqrt x}{2}, \quad
    1 - \cos\sqrt x \sim \frac x2.
  \end{equation*}
  \fi

\item 当\(x \to 0\)时，有\(\paren{1-ax^2}^{1/4} - 1 \sim x \sin x\)．求\(a\)的值．

  \ifshowsol
  因为\(x \sin x \sim x^2\)和\(\paren{1-ax^2}^{1/4} - 1 \sim -ax^2/4\)，所以有\(a = 4\)．
  \fi
\end{enumerate}
\fi

\chapter{连续函数\label{chap:cont}}

\section{连续函数的概念与性质}

\begin{definition}[连续]
  \label{defn:cont}
  若\(\lim\limits_{x\to x_0} f(x) = f(x_0)\)，则称函数\(f\)在点\(x_0\)处连续，点\(x_0\)为函数\(f\)的连续点．
\end{definition}

\begin{example*}
  函数\(f(x) = x \Fn D(x)\)．

  \begin{remark}
    易知此函数在\(x \ne 0\)处的极限都不存在，因而都不连续；它在原点处的极限存在且等于函数值，因而在此处连续．
  \end{remark}
\end{example*}

\begin{theorem*}
  函数\(f\)在点\(x_0\)处连续的充分必要条件是：\(\lim\limits_{\fwdf x \to 0} \fwdf\,f(x_0) = 0\)，其中\(\fwdf x = x - x_0,\ \fwdf\,f(x_0) = f(x_0+\fwdf x) - f(x_0)\)．
\end{theorem*}

\begin{definition*}
  若\(\lim\limits_{x\to x_0^-} \,f(x) = f(x_0)\)，则称函数\(f\)在点\(x_0\)处左连续；若\(\lim\limits_{x\to x_0^+} \,f(x) = f(x_0)\)，则称函数\(f\)在点\(x_0\)处右连续．
\end{definition*}

\begin{theorem}
  \label{thm:contsided}
  函数\(f\)在点\(x_0\)处连续的充分必要条件是它在此处左连续且右连续．

  \begin{proof}
    使用上述定义和定理~\ref{thm:limfuncsided}即可得证．
  \end{proof}
\end{theorem}

\begin{theorem}
  \label{thm:contequiv}
  函数\(f\)在点\( x_0\)处连续的充分必要条件是：对于任意的数列\(\Seq{x_n}\)，当它收敛于\(x_0\)时，就一定有数列\(\Seq{\,f(x_n)}\)收敛于\(f(x_0)\)．

  \begin{proof}
    应用定义~\ref{defn:cont}和定理~\ref{thm:limequiv}即可得证．
  \end{proof}
\end{theorem}

\begin{remark}
  当函数\(f\)在开区间\((a,b)\)上的每一点都连续时，我们记作\(f \in C(a, b)\)．类似地，在闭区间或者半开半闭区间上，当它在除去端点的每一点都连续，在闭的左端点右连续，在闭的右端点左连续时，也有类似的记号．此时，我们简称函数\(f\)在此区间上连续．
\end{remark}

\begin{example*}
  证明函数\(f(x) = x^2\)在\(\R\)上连续．

  \begin{proof}
    对于任意的\(ε > 0\)都存在\(0 < δ \le \sqrt{x_0^2+ε} - \abs{x_0}\)使得当\(0 < \abs*{x-x_0} < δ\)时都有
    \begin{equation*}
      \abs*{x^2 - x_0^2}
      = \abs*{x+x_0} \abs*{x-x_0}
      \le (\abs x + \abs{x_0})δ
      < (2\abs{x_0} + δ)δ
      = 2\abs{x_0}δ + δ^2
      \le ε.
      \qedhere
    \end{equation*}
  \end{proof}
\end{example*}

\begin{theorem}
  \label{thm:contsin}
  证明函数\(f(x) = \sin x\)在\(\R\)上连续．

  \begin{proof}
    对于任意的\(ε > 0\)都存在正数\(δ = ε\)使得当\(0 < \abs*{x-x_0} < δ\)时都有
    \begin{align*}
      \abs*{\sin x - \sin x_0}
      &= \abs*{2 \sin\frac{x-x_0}{2} \cos\frac{x+x_0}{2}}
        = 2 \abs*{\sin\frac{x-x_0}{2}} \abs*{\cos\frac{x+x_0}{2}} \\
      &\le 2 \abs*{\sin\frac{x-x_0}{2}}
      < 2 \abs*{\frac{x-x_0}{2}}
      = \abs*{x-x_0}
        < δ = ε.
        \rule[-2ex]{0ex}{0ex}
      \qedhere
    \end{align*}
  \end{proof}
\end{theorem}

% https://en.wikipedia.org/wiki/Classification_of_discontinuities
\begin{definition*}
  点\(x_0\)是函数\(f\)的一个间断点．当它在此处的左极限和右极限均存在时，我们把这样的间断点叫作\emph{第一类间断点}．当它在此处的单侧极限至少有一个不存在时，我们把这样的间断点叫作\emph{第二类间断点}．对于第一类间断点，当它的单侧极限相等时，我们把这样的间断点叫作\emph{可去间断点}；否则，叫作\emph{跳跃间断点}．
\end{definition*}

\begin{theorem}[Bolzano定理]
  \label{thm:bolzano}
  若函数\(f\)在闭区间\(\brkt{a,b}\)上连续且\(f(a)\,f(b) < 0\)，则存在\(ξ \in \paren{a,b}\)使得\(f(ξ) = 0\)．

  % TODO: Complete the proof
  \begin{proof}
    根据二分法来构造区间套即可得证．
  \end{proof}
\end{theorem}

\begin{example*}
  试讨论方程\(2^x + x = 0\)在开区间\(\paren{-1,0}\)上解的个数。

  \begin{remark}
    令\(f(x) = 2^x + x\)，则该方程在此区间上解的个数就等于函数\(f\)在此区间上零点的个数．因为\(f(-1) = -1/2\)且\(f(0) = 1\)，所以\(f\)在此区间上至少有一个零点．又因为\(f\)严格单调递增，所以它在此区间上只有一个零点，即原方程在此区间上只有一个解．
  \end{remark}
\end{example*}

% https://mathworld.wolfram.com/FixedPointTheorem.html
% https://en.wikipedia.org/wiki/Brouwer_fixed-point_theorem
\begin{corollary}[不动点定理]
  \label{cor:fixedpoint}
  若函数\(f\)在闭区间\(\brkt{a,b}\)上连续且有\(f(a) > a\)和\(f(b) < b\)，则存在一点\(ξ\)使得\(f(ξ) = ξ\)．

  \begin{proof}
    构造函数\(\Fn F(x) = f(x) - x\)．因为函数\(\Fn F(x)\)在\(\brkt{a,b}\)上也连续且有\(\Fn F(a) > 0\)和\(\Fn F(b) < 0\)，所以存在\(ξ\)使得\(\Fn F(ξ) = 0\)，即\(f(ξ) = ξ\)．
  \end{proof}
\end{corollary}

% https://mathworld.wolfram.com/IntermediateValueTheorem.html
% https://en.wikipedia.org/wiki/Intermediate_value_theorem
\begin{corollary}[介值定理]
  \label{cor:ivt}
  若函数\(f\)在\(\brkt{a,b}\)上连续，则函数\(f\)在\(\paren{a,b}\)上可以取到\(f(a)\!\)和\(f(b)\)之间（不含）的所有数\footnote{英文叫作intermediate value theorem，简称为IVT．}．

  \begin{proof}
    当\(f(a) = f(b)\)时，此定理空虚地为真．不失一般地，假设\(f(a) < f(b)\)．对于任意的\(μ \in \paren[\big]{\,f(a), f(b)}\)，构造函数\(\Fn F(x) = f(x) - μ\)，那么根据定理~\ref{thm:bolzano}，存在\(ξ \in \paren{a,b}\)使得\(\Fn F(ξ) = 0\)，即\(f(ξ) = μ\)．由于\(μ\)的任意性，此定理得证．
  \end{proof}
\end{corollary}

\begin{corollary*}
  若函数\(f\)在\(\R\)上连续且有界，则函数\(f\)能取到所有在上下确界之间的数（不含）．

  \begin{proof}
    当\(\inf\,f = \sup\,f\)时，此定理空虚地为真．当\(\inf\,f < \sup\,f\)时，对于任意的\(μ \in \paren{\inf\,f, \sup\,f\,}\)，根据确界的定义，存在\(f(x_1) \in \paren{\inf\,f,\,μ}\)和\(f(x_2) \in \paren{μ,\,\sup\,f}\)，又根据推论~\ref{cor:ivt}，存在\(ξ\)位于\(x_1\)和\(x_2\)之间（不含）使得\(f(ξ) = μ\)．由于\(μ\)的任意性，此定理得证．
  \end{proof}
\end{corollary*}

% TODO: Add the example of area of line sliding through a triangle

\begin{theorem}[连续函数的四则运算]
  \label{thm:cont4ops}
  若函数\(f, g\)在点\(x_0\)处都连续，则函数\(f \pm g,\ fg,\ f/g\ (g(x_0) \ne 0)\)在此处也都连续．

  \begin{proof}
    使用定义~\ref{defn:func4ops}和定理~\ref{thm:limfunc4ops}即可得证．
  \end{proof}
\end{theorem}

\begin{theorem}[复合函数的连续性]
  \label{thm:contcomp}
  若函数\(g\)在点\(x_0\)处连续且函数\(f\)在点\(u_0 = g(x_0)\)处连续，则复合函数\(f \circ g\)在点\(x_0\)处连续．

  \begin{proof}
    因为函数\(f\)在点\(u_0\)处连续，所以对于任意的\(ε > 0\)都存在\(δ_1 > 0\)使得当\(\abs*{u - u_0} < δ_1\)时都有\(\abs*{\,f(u)-f(u_0)} < ε\)．又因为函数\(g\)在点\(x_0\)处连续，所以存在\(δ > 0\)使得当\(\abs*{x - x_0} < δ\)时都有\(\abs*{\,g(x) - g(x_0)} = \abs*{\,g(x) - u_0} < δ_1\)，从而\(\abs*{\,f(g(x)) - f(u_0)} = \abs*{\,f(g(x)) - f(g(x_0))} < ε\)．
  \end{proof}
\end{theorem}

\begin{theorem*}
  若函数\(f\)和\(g\)在点\(x_0\)处连续且\(f(x_0) > 0\)，则函数\(\,f^g\!\)在此处也连续．

  \begin{proof}
    仿照定理~\ref{thm:limfuncpowexp}的证明，使用两次定理~\ref{thm:contcomp}和一次定理~\ref{thm:cont4ops}即可得证．
  \end{proof}
\end{theorem*}

\begin{theorem*}
  若函数\(f\)在某个闭（开）区间上严格单调连续，则其反函数\(f^{-1}\negthickspace\)也在某个闭（开）区间上严格同向单调连续．

  \begin{proof}
    对于闭区间的情况，使用定义~\ref{defn:funcinv}和~\ref{defn:funcmono}、推论~\ref{cor:ivt}即可得证．对于开区间的情况，还要再用上公理~\ref{ax:lubglb}、定义~\ref{defn:bnd}和~\ref{defn:supinf}．
  \end{proof}
\end{theorem*}

\begin{theorem*}
  初等函数在定义域内（除去孤立点）连续．
\end{theorem*}

\begin{example*}
  讨论函数\(f(x) = \sqrt{x(x-1)} + \sqrt x\)在其自然定义域上的连续性．

  \begin{remark}
    它的自然定义域是\(\Set{0} \cup \brktparen{1, +∞}\)．显然地，它在\(\paren{1, +∞}\)上的每一点处都连续，在点\(1\)处右连续，在原点处（孤立点）不连续．
  \end{remark}
\end{example*}

\subpdfbookmark{思考}{B1.3.1.P}
\subsection*{思考}

\begin{enumerate}
\item 函数在一点连续与单侧连续之间有什么关系？

  \ifshowsolp
  参见定理~\ref{thm:contsided}．
  \fi

\item 函数在一点连续能否推出函数在此点附近也连续？

  \ifshowsolp
  不能．
  \fi

\item 基本初等函数在其定义域内是连续的，这个结论是如何得到的？

  \ifshowsolp
  其实这要把基本初等函数分成两类来看：一类是超越函数（transcedental functions）、另一类是代数函数（algebraic functions）．代数函数基本上可以由实数公理推出来．超越函数中的指数函数可以定义成
  \begin{equation*}
    \exp x \coloneq \lim_{n\to\infty} \paren*{1 + \frac xn}^n,
  \end{equation*}
  然后通过讨论这个数列的单调性和有界性论证它总是收敛的，并且研究出它的很多性质满足我们中学学过的指数运算法则．由这些结论，我们可以证明指数函数是连续的．再由此定义对数函数为指数函数的反函数，得到它的一系列性质．这样，对于超越的幂函数，例如\(x^π\)，就可以变形成\(\expb{π \ln x}\)，再由定理~\ref{thm:contcomp}和定理~\ref{thm:cont4ops}得出其连续性．

  对于超越函数中的三角函数，正弦函数的连续性已经由定理~\ref{thm:contsin}给出，余弦函数的连续性可由\(\cos x = \sinp{π/2-x}\)再加上定理~\ref{thm:contcomp}得出．剩下的三角函数，对正弦函数和余弦函数使用定理~\ref{thm:cont4ops}即可得到它们的连续性．
  \fi
\end{enumerate}

\ifshowex
\currentpdfbookmark{练习}{B1.3.1.E}
\subsection*{练习}

\begin{enumerate}
\item 原点是函数
  \begin{equation*}
    f(x) =
    \begin{dcases}
      \frac{e^{1/x}-1}{e^{1/x}+1}, & x \ne 0, \\
      1, & x = 0
    \end{dcases}
  \end{equation*}
  的\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 可去间断点
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    跳跃间断点
  \item 第二类间断点
  \item 连续点
  \end{itemize}

  \ifshowsol
  函数\(f\)在原点处的左右极限分别是\(-1\)和\(1\)．
  \fi

\item 令\(f(x) = 1\Big/\paren[\Big]{\expb[\Big]{\frac{x}{x-1}} - 1}\)，则\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 原点和点\(1\)都是第一类间断点
  \item 原点和点\(1\)都是第二类间断点
  \item 原点是第一类间断点，点\(1\)是第二类间断点
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    原点是第二类间断点，点\(1\)是第一类间断点
  \end{itemize}

  \ifshowsol
  函数\(f\)在原点处的左右极限分别是\(+\infty\)和\(-\infty\)，在点\(1\)处的左右极限分别是\(-1\)和\(0\)．
  \fi

\item 求函数
  \begin{equation*}
    f(x) = \frac{(e^x+x) \tan x}{x (e^{1/x}-e)}
  \end{equation*}
  在\(\brkt{-π,π}\)上的第一类间断点．

  \ifshowsol
  函数\(f\)在此区间上有\(4\)个间断点，分别是\(-π/2,\ 0,\ 1,\ π/2\)．它在这\(4\)个间断点处的左右极限分别是\(-\infty\)和\(+\infty\)、\(-e^{-1}\)和\(0\)、\(+\infty\)和\(-\infty\)、\(-\infty\)和\(+\infty\)．所以原点是函数\(f\)的跳跃间断点．
  \fi

\item 求函数
  \begin{equation*}
    f(x) = (1+x)^{x/\!\tanp{x-π/4}}
  \end{equation*}
  在\(\paren{0,2π}\)上的第二类间断点．

  \ifshowsol
  函数\(f\)在此区间上有\(4\)个间断点，分别是\(π/4,\ 3π/4,\ 5π/4,\ 7π/4\)．它在这\(4\)个间断点处的左右极限分别是\(0\)和\(+\infty\)、\(1\)和\(1\)、\(0\)和\(+\infty\)、\(1\)和\(1\)．所以点\(π/4\)和\(5π/4\)是函数\(f\)的无穷间断点．
  \fi

\item 原点是函数\(f(x) = \cos^2 \frac1x\)的\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 可去间断点
  \item 跳跃间断点
  \item 无穷间断点
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    振荡间断点
  \end{itemize}

\item 令\(f(x) = {}\smashoperator[l]{\lim\limits_{n\to\infty}} \dfrac{x^{2n+1}+1}{x^{2n+1}-x^{n+1}+x}\)，则下列说法正确的是\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 原点是可去间断点
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    点\(1\)是可去间断点
  \item 点\(-1\)是可去间断点
  \item 点\(1\)和点\(-1\)均为跳跃间断点
  \end{itemize}

  \ifshowsol
  实际上，有
  \begin{equation*}
    f(x) =
    \begin{dcases}
      1, & \abs{x} > 1, \\
      0, & x = -1, \\
      2, & x = 1, \\
      \frac1x, & \abs{x} < 1 \tand x \ne 0.
    \end{dcases}
  \end{equation*}
  所以点\(-1, 0, 1\)分别是函数\(f\)的跳跃间断点、第二类间断点、可去间断点．
  \fi

\item 原点是函数\uline{\makebox[6em]{}}的可去间断点．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item
    \begin{math}
      f(x) =
      \begin{cases}
        x + 1/x, & x \ne 0, \\
        1, & x = 0
      \end{cases}
    \end{math}
  \item
    \begin{math}
      f(x) =
      \begin{cases}
        (1+x^2)/x^2, & x \ne 0, \\
        1, & x = 0
      \end{cases}
    \end{math}
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(f(x) = \floor{\cos x}\)
  \item \(f(x) = \sgnp x\)
  \end{itemize}

  \ifshowsol
  原点分别是选项~A、B中函数的第二类间断点、选项~C中函数的可去间断点、选项~D中的跳跃间断点．
  \fi

\item 下列说法中，错误的是\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 如果函数\(f\)在点\(a\)处连续，那么函数\(\abs*{\,f\,}\)也在点\(a\)处连续
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    如果函数\(\abs*{\,f\,}\)在点\(a\)处连续，那么函数\(f\)也在点\(a\)处连续
  \item 如果函数\(f\)在点\(a\)处连续，那么函数\(f^3\negthickspace\)也在点\(a\)处连续
  \item 如果函数\(f^3\negthickspace\)在点\(a\)处连续，那么函数\(f\)也在点\(a\)处连续
  \end{itemize}

  \ifshowsol
  由于反三角不等式，选项~A成立；由于定理~\ref{thm:contcomp}，选项~C和~D成立．选项~B的一个反例是函数\(2\fn H - 1\)，其中\(H\)是单位阶跃函数（定义~\ref{defn:heaviside}）．
  \fi

\item 函数\uline{\makebox[10em]{}}在原点处连续．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \begin{math}
      f(x) =
      \begin{dcases}
        e^{-1/x^2}, & x \ne 0, \\
        0, & x = 0
      \end{dcases}
    \end{math}
  \item \(f(x) = \floor x\)
  \item \(f(x) = \sgnp{\sin x}\)
  \item
    \begin{math}
      f(x) =
      \begin{dcases}
        \frac{\sin x}{\abs x}, & x \ne 0, \\
        1, & x = 0
      \end{dcases}
    \end{math}\rule{0ex}{5ex}
  \end{itemize}

  \ifshowsol
  原点是选项~B、C、D中函数的跳跃间断点．选项~A中的函数在原点处的左右极限都是\(0\)且等于此处的函数值，因此连续．
  \fi

\item 若函数\(f\)和\(g\)在点\(x_0\)处均不连续，则\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 函数\(f+g\)在点\(x_0\)处不连续
  \item 函数\(f/g\)在点\(x_0\)处不连续
  \item 函数\(fg\)在点\(x_0\)处不连续
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    函数\(f+g,\ f/g,\ fg\)都可能在点\(x_0\)处连续
  \end{itemize}

  \ifshowsol
  令\(f(x) = \Fn H(x),\ g(x) = 1-\Fn H(x)\)，则\(f + g = 1,\ fg = 0\)，因此选项~A和~C不正确．令
  \begin{equation*}
    f(x) = g(x) = \frac{1}{x \Fn H(x) + \Fn H(-x)},
  \end{equation*}
  则\(f/g = 1\)，因此选项~B不正确．
  \fi
\end{enumerate}
\fi

\section{闭区间上连续函数的性质}

\begin{theorem}
  \label{thm:contclsintvbnd}
  闭区间上的连续函数是有界函数．

  \begin{proof}
    运用反证法．构造一个有界数列\(\Seq{x_n}\)使得数列\(\Seq{\,f(x_n)}\)是无界的．再使用定理~\ref{thm:bw}找到一个收敛于\(L\)的子列\(\Seq{x_{n_k}}\)．又因为函数\(f\)是连续的，所以数列\(\Seq{\,f(x_{n_k})}\)收敛于\(f(L)\)．这与数列\(\Seq{\,f(x_n)}\)的结论是矛盾的．
  \end{proof}
\end{theorem}

\begin{theorem}[最值定理]
  \label{thm:evt}
  闭区间上的连续函数能取到最大值和最小值\footnote{英文叫作extreme value theorem，简称EVT．}．

  \begin{proof}
    使用定理~\ref{thm:contclsintvbnd}和公理~\ref{ax:lubglb}可以得到上确界\(M = \sup\,f\)．令\(ε_0 = \abs*{M - \maxb{a, b}}\)，其中\(a,b\)分别为闭区间的端点．若\(ε_0 = 0\)，则说明区间的端点之一就是最大值．否则，令\(ε_n = ε_0/2^n\)．根据定义~\ref{defn:supinf}，则能找到一个有界数列\(\Seq{x_n}\)使得\(M \ge f(x_n) > M - ε_n\)对于所有的正整数\(n\)都成立．数列\(\Seq{\,f(x_n)}\)收敛于\(M\)．使用定理~\ref{thm:bw}，找到一个收敛于\(L\)的子列\(\Seq{x_{n_k}}\)．又因为函数\(f\)连续，使用定理~\ref{thm:contequiv}即可得到\(f(L) = M\)．类似地，可以证明函数\(f\)能取到最小值．
  \end{proof}
\end{theorem}

% TODO: Add the example of area under a line sliding up through a curve

% https://proofwiki.org/wiki/Continuous_Image_of_Closed_Interval_is_Closed_Interval
% https://en.wikipedia.org/wiki/Intermediate_value_theorem
\begin{theorem*}
  闭区间上的连续函数，其像集也是闭区间．

  \begin{proof}
    应用定理~\ref{thm:evt}和推论~\ref{cor:ivt}即可得证．
  \end{proof}
\end{theorem*}

\subpdfbookmark{思考}{B1.3.2.P}
\subsection*{思考}

\begin{enumerate}
\item 在最值定理中，若将闭区间改成开区间，则结论不再成立．请举例说明．

  \ifshowsolp
  其实对于定义在开区间\(\paren{0,1}\)上的恒等函数\(f(x) = x\)这样的简单函数，既取不到最小值，又取不到最大值．更不用说像定义在开区间上的\(\paren{-π/2,π/2}\)上的正切函数\(f(x) = \tan x\)和定义在开区间\(\paren{-∞,+∞}\)上的反正切函数\(f(x) = \arctan x\)了．
  \fi

\item 函数\(\,f(x) = x^{2m} + x^{2m-1} + \dots + x - 1\)和\(g(x) = x^{2m} + x^{2m-1} + \dots + x + 1\)在\(\R\)上是否存在零点？

  \ifshowsolp
  此处假定\(m \ge 1\)．函数\(f\)在\(\R\)上显然是有零点的；因为\(f(0) = -1\)且\(f(1) = 2m-1 > 0\)，由定理~\ref{thm:bolzano}可知它在\(\paren{-1,1}\)上至少有一个零点．函数\(f\)在\(\R\)上不存在零点，原因如下．有
  \begin{align*}
    g(x)
    &=
      \begin{dcases}
        1 + \sum_{k = 1}^{\smash{2m}} x^k, & x \ne 1, \\
        2m+1, & x = 1,
      \end{dcases} \\
    &=
      \begin{dcases}
        \frac{1-x^{2m+1}\negthickspace}{1-x}, & x \ne 1, \\
        2m+1, & x = 1.
      \end{dcases}
  \end{align*}
  可见函数\(g\)在\(\R\)上都是正数，因此无零点．
  \fi
\end{enumerate}

\ifshowex
\currentpdfbookmark{练习}{B1.3.2.E}
\subsection*{练习}

\begin{enumerate}
\item 下列说法中，正确的是\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 若函数\(f \in C\brkt{a,b}\)且\(f(a)\,f(b) < 0\)，则存在唯一的\(ξ \in \paren{a,b}\)满足\(f(ξ) = 0\)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    若函数\(f \in C\brkt{a,b}\)，则存在\(ξ \in \brkt{a,b}\)满足\(f(ξ) = \frac{f(a) + f(b)}{2}\)  \item 若函数\(f \in C\paren{a,b}\)且\(f(a)\,f(b) < 0\)，则存在唯一的\(ξ \in \paren{a,b}\)满足\(f(ξ) = 0\)
  \item 若\(f \in C\paren{a,b}\)，则存在\(ξ \in \paren{a,b}\)满足\(f(ξ) = \frac{f(a) + f(b)}{2}\)
  \end{itemize}

  \ifshowsol
  令\(a = 0,\ b = 3π\)，余弦函数就是选项~A和~C的反例．令\(a = -1,\ b = 1\)，则函数\(f(x) = x^2\)显然是不满足选项~D的．对于选项~B，当\(f(a) \ne f(b)\)时，使用推论~\ref{cor:ivt}即可；当\(f(a) = f(b)\)时，取\(ξ = a\)或者\(ξ = b\)即可．
  \fi

\item 下列说法中，正确的是\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 若函数\(f \in C\paren{a,b}\)，则函数\(f\)在\(\paren{a,b}\)上一定有最大值和最小值
  \item 若函数\(f \in C\paren{a,b}\)，则函数\(f\)在\(\paren{a,b}\)上一定没有最大值和最小值
  \item 若函数\(f \in C\brkt{a,b}\)，则函数\(f\)在\(\paren{a,b}\)上一定有最大值和最小值
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    若函数\(f \in C\brkt{a,b}\)，则函数\(f\)在\(\brkt{a,b}\)上一定有最大值和最小值
  \end{itemize}

  \ifshowsol
  令\(a = 0,\ b = 2π\)，则函数\(f(x) = x\)在区间\(\paren{a,b}\)上没有最大值和最小值，但函数\(f(x) = \sin x\)在区间\(\paren{a,b}\)上有最大值和最小值．因此，选项~A、B、C都不正确．选项~D就是定理~\ref{thm:evt}．
  \fi

\item 设\(a_1,\ a_2,\ a_3\)均为正数且\(λ_1 < λ_2 < λ_3\)，则关于方程
  \begin{equation*}
    \frac{a_1}{x-λ_1} + \frac{a_2}{x-λ_2} + \frac{a_3}{x-λ_3} = 0
  \end{equation*}
  下列说法正确的是\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 在\(\paren{λ_1,λ_2}\)和\(\paren{λ_2,λ_3}\)内均无实根
  \item 在\(\paren{λ_1,λ_2}\)内有一个实根，在\(\paren{λ_2,λ_3}\)内无实根
  \item 在\(\paren{λ_1,λ_2}\)内无实根，在\(\paren{λ_2,λ_3}\)内又一个实根
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    在\(\paren{λ_1,λ_2}\)和\(\paren{λ_2,λ_3}\)内各有一个实根
  \end{itemize}

  \ifshowsol
  应用定理~\ref{thm:bolzano}即可得知．
  \fi

\item 下列函数中，在区间\(\paren{0,1}\)上必有零点的是\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(f \in C\paren{0,1}\)且\(\,f(0)\,f(1) < 0\)
  \item \(f \in C\paren{0,1}\)且\(\,f(1/2)\,f(1) < 0\)
  \item \(f \in C\paren{0,1}\)且\(\,f(0)\,f(1/2) < 0\)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(f \in C\paren{0,1}\)且\(\,f(1/4)\,f(1/2) < 0\)
  \end{itemize}

  \ifshowsol
  选项~A的一个反例是函数\(f(x) = 1 - 2 \fn H(-x)\)．选项~B、C的一个共同反例是函数\(g(x) = \paren[\big]{1 - 2 \fn H(x-1)}\,f(x)\)．
  \fi

\item 下列函数中，在其定义域上有最大值和最小值的是\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item
    \begin{math}
      f(x) =
      \begin{cases}
        \ln\abs x, & x \ne 0, \\
        0, & x = 0
      \end{cases}
    \end{math}
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \begin{math}
      f(x) = \ln(1 + \abs x),\ x \in \brkt{-1,1}
    \end{math}
  \item
    \begin{math}
      f(x) = \ln\abs x, x \in \brkt{-1,1} ∖ \Set{0}
    \end{math}
  \item
    \begin{math}
      f(x) =
      \begin{cases}
        \ln\abs x, & 0 < \abs x < 1, \\
        0, & x = 0
      \end{cases}
    \end{math}
  \end{itemize}

  \ifshowsol
  选项~A既没最大值也没最小值，选项~C和~D有最大值但没最小值．
  \fi

\item 下列函数中，在其定义域内有最大值的是\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \begin{math}
      f(x) = x/e^x,\ x \in \paren{0,+∞}
    \end{math}
  \item
    \begin{math}
      f(x) = 1/e^x,\ x \in \paren{0,+∞}
    \end{math}
  \item
    \begin{math}
      f(x) = 1/e^x,\ x \in \paren{0,1}
    \end{math}
  \item
    \begin{math}
      f(x) = 1/e^x,\ x \in \parenbrkt{0,1}
    \end{math}
  \end{itemize}

  \ifshowsol
  选项~C和~D既没最大值也没最小值，选项~D有最小值但没有最大值．下面来证明一下选项~A．

  \begin{proof}
    取一个正数\(x_0\)，自然有\(f(x_0) > 0\)．若\(x_0\)是最大值，我们就找到了．若不是，我们可以按照下面的方法来找最大值．因为函数\(f\)在正无穷处的极限是零，所以存在\(δ > 0\)使得当\(x > δ\)时都有\(f(x) < \,f(x_0)\)．显然最大值不可能在区间\(\paren{δ, +∞}\)上．根据定理~\ref{thm:cont4ops}可知，函数\(f\)在\(\R\)上是连续的，所以在\(\brkt{0,δ}\)上也是连续的．再使用定理~\ref{thm:evt}可知函数在此区间上有最大值．又因为~\(f(0) = 0\)，所以原点不可能是函数的最大值．因此，最大值只能在\(\paren{0,δ}\)上了，自然也在\(\paren{0,+∞}\)上．
  \end{proof}
  \fi

\item 下列函数中，在\(\brktparen{0,+∞}\)上有界的是\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(f(x) = x^2 - 1\)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(f(x) = \frac{\ln(1+x)}{1+x}\)
  \item \(f(x) = x^2 \sin\frac1{1+x}\)
  \item
    \begin{math}
      f(x) =
      \begin{cases}
        e^{1/x}, & x > 0, \\
        0, & x = 0
      \end{cases}
    \end{math}
  \end{itemize}

  \ifshowsol
  选项~B参照前一题．关于选项~C，有
  \begin{align*}
    f(x)
    &= x^2 \sin\frac1{1+x} \\
    &= x⋅\frac{\sinp[\big]{1/(1+x)}}{1/(1+x)} - \frac{\sinp[\big]{1/(1+x)}}{1/(1+x)} + \sin\frac1{1+x} \\
    &\ge x \sin1 + \bigO(1)．
  \end{align*}
  可见选项~C中的函数\(f\)有下界但无上界（下界是零）．选项~D中的函数也是有下界但无上界（下界也是零）．
  \fi

\item 下列函数中，在\(\R\)上有界的是\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(f \in C\paren{-∞,+∞}\)且\(\smashoperator[l]{\lim\limits_{\,x\to+∞\!}}\,f(x) = 1\)
  \item \(f \in C\paren{-∞,+∞}\)且\(\smashoperator[l]{\lim\limits_{\,x\to-∞\!}}\,f(x) = 1\)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(f \in C\paren{-∞,+∞}\)且\(\smashoperator[l]{\lim\limits_{x\to∞}}\,f(x) = 1\)
  \item \(f \in C\paren{-∞,+∞}\)且\(\abs*{\,f(x)} \le \abs x / 2\)对于所有的\(x \in \R\)都成立
  \end{itemize}

  \ifshowsol
  函数\(1 + e^{-x}\)是选项~A的反例，函数\(1+e^x\)是选项~B的反例，函数\(x/4\)是选项~D的反例．下面来证明一下选项~C．

  \begin{proof}
    因为函数在无穷处的极限是\(1\)，所以对于正数\(ε\)存在\(δ > 0\)使得当\(\abs{x} > δ\)时都有\(\abs*{\,f(x)-1} < ε\)．因此函数在\(\paren{-∞,-δ} \cup \paren{δ,+∞}\)上有界．又因为函数在\(\brkt{-δ,δ}\)上连续，所以根据定理~\ref{thm:contclsintvbnd}它在此区间上也有界．综上所述，它在\(\R\)上有界．
  \end{proof}
  \fi

\item 下列形结论中，错误的是\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 若函数\(f \in C\brkt{a,b}\)且\(f(a) < a,\ f(b) > b\)，则存在\(ξ \in \paren{a,b}\)满足\(f(ξ)=ξ\)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    若函数\(f \in C\parenbrkt{-∞,a}\)且\(f(a) = 0, \lim\limits_{x\to-∞\!}\,f(x) = 0\)，则函数\(f\)在区间\(\parenbrkt{-∞,a}\)上有正的最大值
  \item 方程\(x^5 - 3x - 1 = 0\)至少有一个根介于\(1\)和\(2\)之间
  \item 方程\(x = a + b \sin x\ (a > 0,\ b > 0)\)至少有一个不大于\(a+b\)的正根
  \end{itemize}

  \ifshowsol
  选项~A可以参照定理~\ref{cor:fixedpoint}的证明．选项~C和~D都可以由定理~\ref{thm:bolzano}得到．关于选项~D，令
  \begin{equation*}
    f(x) = x - a - b \sin x,
  \end{equation*}
  则有\(f(0) = -a < 0,\ f(a+b) = b\paren[\big]{1 - \sinp{a+b}}\)．若\(\sinp{a+b} = 1\)，则\(f(a+b) = 0\)．若\(\sinp{a+b} \ne 1\)，则\(f(a+b) > 0\)．根据定理~\ref{thm:bolzano}，函数\(f\)在区间\(\paren{0,\ a+b}\)上有一个零点．选项~B的一个反例是\(f(x) = (x-a)e^x\)，此函数在区间\(\parenbrkt{-\infty,a}\)上有负的最小值和为零的最大值．
  \fi
\end{enumerate}
\fi

\section{函数的一致连续性}

\begin{example*}
  函数\(f(x) = 1/x\)在区间\(\paren{0,+\infty}\)上处处连续．

  \begin{proof}
    令\(x_0 \in \paren{0,+\infty}\)，则对于任意的正数\(\varepsilon\)都存在\(\delta = \minb[\Big]{\frac{x_0}{2}, \frac{x_0^2}{2} \varepsilon}\)使得当\(\abs*{x - x_0} < \delta\)时都有
    \begin{equation*}
      \abs*{\frac1x - \frac1{x_0}}
      = \abs*{\frac{x_0 - x}{x x_0}}
      < \frac{2}{x_0^2} \abs{x_0 - x}
      = \frac{2}{x_0^2} \delta
      \le \varepsilon.
      \qedhere
    \end{equation*}
  \end{proof}
\end{example*}

\begin{example*}
  参见定理~\ref{thm:contsin}的证明过程．
\end{example*}

\begin{definition}[一致连续]
  \label{defn:unicont}
  设函数\(f\)在区间\(I\)上有定义．对于任意的\(\varepsilon > 0\)都存在\(\delta > 0\)使得：对于\(I\)上的任意两点\(x_1\)和\(x_2\)，当\(\abs*{x_1 - x_2} < \delta\)时都有\(\abs*{\,f(x_1) - f(x_2)} < \varepsilon\)．这时，我们称函数\(f\)在\(I\)上\emph{一致连续}．
\end{definition}

\begin{example*}
  函数\(f(x) = \sqrt x\)在区间\(\brktparen{a,+\infty}\)上一致连续，其中\(a > 0\)．

  \begin{proof}
    对于任意的正数\(\varepsilon\)都存在\(\delta = 2 \varepsilon \sqrt a\)使得：对于\(\brktparen{a,+\infty}\)上的任意两点\(x_1\)和\(x_2\)，当\(\abs*{x_1 - x_2} < \delta\)时都有
    \begin{equation*}
      \abs*{\sqrt{\smash[b]{x_1}\!}\, - \sqrt{\smash[b]{x_2}\!}\,}
      = \abs*{\frac{x_1 - x_2}{\sqrt{\smash[b]{x_1}\!}\, + \sqrt{\smash[b]{x_2}\!}\,}}
      \le \frac{\abs*{x_1 - x_2}}{2 \sqrt a}
      < \frac{\delta}{2 \sqrt a}
      = \varepsilon.
      \qedhere
    \end{equation*}
  \end{proof}
\end{example*}

% https://math.stackexchange.com/q/569928/147999
\begin{example}
  \label{eg:unicontsqrt}
  函数\(f(x) = \sqrt x\)在区间\(\brktparen{0,+\infty}\)上也是一致连续的．

  \begin{remark}
    下面给出两种证明方法．
  \end{remark}
  \begin{proof}
    对于任意的\(\varepsilon > 0\)，令\(\delta = \varepsilon^2\)，则对于区间\(\brktparen{0,+\infty}\)上任意两点\(x_1\)和\(x_2\)，当\(\abs*{x_1 - x_2} < \delta\)时都有
    \begin{gather*}
      \abs*{\sqrt{\smash[b]{x_1}\!}\, - \sqrt{\smash[b]{x_2}\!}\,}^2
      \le \abs*{\sqrt{\smash[b]{x_1}\!}\, - \sqrt{\smash[b]{x_2}\!}\,} \paren*{\abs*{\sqrt{\smash[b]{x_1}\!}\,} + \abs*{\sqrt{\smash[b]{x_2}\!}\,}}
      = \abs*{\sqrt{\smash[b]{x_1}\!}\, - \sqrt{\smash[b]{x_2}\!}\,} \abs*{\sqrt{\smash[b]{x_1}\!}\, + \sqrt{\smash[b]{x_2}\!}\,}
      = \abs*{x_1 - x_2}
      < \delta = \varepsilon^2,
      \shortintertext{即}
      \abs*{\sqrt{\smash[b]{x_1}\!}\, - \sqrt{\smash[b]{x_2}\!}\,}
      < \varepsilon.
      \qedhere
    \end{gather*}
  \end{proof}
  % TODO: Add the following proof to Math.SE
  \begin{proof}
    对于任意的\(\varepsilon > 0\)，令\(\delta = \varepsilon^2\)．定义区间\(I_a = \brktparen{a,a+\delta}\)，我们称\(I_a\)为滑动窗口．对于在滑动窗口上的任意两点\(x_1\)和\(x_2\)都有
    \begin{gather*}
      \sqrt{a\mathstrut} \le \sqrt{\smash[b]{x_1}\mathstrut\!}\, < \sqrt{a+\delta\mathstrut}
      \ \txt{和}
      \sqrt{a\mathstrut} \le \sqrt{\smash[b]{x_2}\mathstrut\!}\, < \sqrt{a+\delta\mathstrut}, \\
      \shortintertext{从而}
      - \paren[\big]{\sqrt{a+\delta\mathstrut} - \sqrt{a\mathstrut}}
      < \sqrt{\smash[b]{x_1}\mathstrut\!}\, - \sqrt{\smash[b]{x_2}\mathstrut\!}\,
      < \sqrt{a+\delta\mathstrut} - \sqrt{a\mathstrut}
      \shortintertext{即}
      \abs[\Big]{\sqrt{\smash[b]{x_1}\mathstrut\!}\, - \sqrt{\smash[b]{x_2}\mathstrut\!}\,}
      < \sqrt{a+\delta\mathstrut}\, - \sqrt{a\mathstrut}
      = \frac{\delta}{\sqrt{a+\delta}\, + \sqrt{a\vphantom{\delta}}}
      \le \frac{\delta}{\sqrt\delta}
      = \varepsilon.
    \end{gather*}
    注意到上面的关系对于所有的\(a \ge 0\)的成立，又因为说区间\(\brktparen{0,+\infty}\)上的任意两点\(x_1\)和\(x_2\)当\(\abs*{x_1 - x_2} < \delta\)时满足某个条件\emph{等价于}说对于所有滑动窗口\(\brktparen{a,a+\delta}\)上的任意两点\(x_1\)和\(x_2\)满足某个条件．
  \end{proof}
\end{example}

\begin{theorem*}[一致连续函数的线性组合]
  \label{thm:unicontlincomb}
  若函数\(f\)和\(g\)在\(I\)上一致连续，则它们的线性组合也在\(I\)上一致连续．

  \begin{proof}
    取\(\delta = \minb{\delta_1, \delta_2}\)，再利用三角不等式即可得证．其中\(\delta_1\)和\(\delta_2\)是函数\(f\)和\(g\)对于同一个\(\varepsilon\)各自取的德尔塔．
  \end{proof}
\end{theorem*}

\begin{theorem*}[复合函数的一致连续性]
  \label{thm:unicontcomp}
  若函数\(f\)在区间\(I_{\text{外}}\)上一致连续、函数\(g\)在区间\(I_{\text{内}}\)上一致连续、\(\ran g \subset I_{\text{外}}\)，则函数\(f \circ g\)在区间\(I_{\text{内}}\)上一致连续．

  \begin{proof}
    因为函数\(f\)在\(I_{\text{外}}\)上一致连续，所以对于任意的\(\varepsilon > 0\)都存在\(\delta_{\text{外}} > 0\)使得：对于\(I_{\text{外}}\)上的任意两点\(u_1\)和\(u_2\)，当\(\abs*{u_1 - u_2} < \delta_{\text{外}}\)时都有\(\abs*{\,f(u_1) - f(u_2)} < \varepsilon\)．又因为函数\(g\)在\(I_{\text{内}}\)上一致连续，所以存在\(\delta_{\text{内}} > 0\)使得：对于\(I_{\text{内}}\)上的任意两点\(x_1\)和\(x_2\)，当\(\abs*{x_1 - x_2} < \delta_{\text{内}}\)都有\(\abs*{\,g(x_1) - g(x_2)} < \delta_{\text{外}}\)，进而有~\(\abs*{\,f\,\paren*{g(x_1)} - f\,\paren*{g(x_2)}} < \varepsilon\)．
  \end{proof}
\end{theorem*}

\begin{theorem}
  \label{thm:unicont2cont}
  一致连续蕴含连续．

  \begin{proof}
    应用定义~\ref{defn:unicont}即可得证．
  \end{proof}
\end{theorem}

\begin{theorem}
  \label{thm:unicontbndintvbnd}
  一致连续函数在有界区间上有界．

  \begin{proof}
    使用反证法．假设一致连续函数在有界区间上无界，那必然可以找到一个有界数列\(\Seq{x_n}\)使得数列~\(\Seq*{\,\abs*{\,f(x_n)} > 2^n}\)．再根据定理~\ref{thm:bw}可以找到一个收敛于\(a\)子列\(\Seq{x_{n_k}}\)．令\(\varepsilon = 2\)，则对于所有的\(\delta > 0\)都能在\(a\)的邻域上找到两点\(x_p\)和\(x_q\)使得\(\abs[\big]{x_p - x_q} < \delta\)且\(\abs[\big]{\,f(x_p) - f(x_q)} \ge \varepsilon = 2\)．
  \end{proof}
  % TODO: Add the proof from the lecture
\end{theorem}

% https://mathworld.wolfram.com/TopologistsSineCurve.html
\begin{example}
  \label{eg:uniconttoposine}
  函数\(f(x) = \sin\frac1x\)在区间\(\paren{0,1}\)上连续且有界，但它在此区间上不是一致连续的．

  \begin{proof}
    令\(\varepsilon = 1\)．对于任意的\(\delta > 0\)，取\(1/x = \pi/2 + 2k\pi,\ 1/y = \pi/2 + (2k+1)\pi\)，则有
    \begin{equation*}
      x - y = xy(1/y - 1/x) = \pi xy = \bigOp{1/k^2}.
    \end{equation*}
    当\(k\)取的足够大时，自然能使\(\abs*{x-y} < \delta\)，但是\(\abs[\big]{\sin\frac1x - \sin\frac1y} = 2 > 1 = \varepsilon\)．
  \end{proof}
\end{example}

\begin{theorem*}
  有界区间上的一致连续函数，其乘积函数也一致连续．

  \begin{proof}
    仿照定理~\ref{thm:seq4ops}中对\enumparen{2}的证明，再使用定理~\ref{thm:unicontbndintvbnd}中的结果来完成放缩，即可得证．
  \end{proof}
\end{theorem*}

\begin{theorem}[Heine--Cantor定理]
  \label{thm:hc}
  函数\(f\)在闭区间上一致连续的充分必要条件是它在此区间上连续．

  \begin{proof}
    必要性见定理~\ref{thm:unicont2cont}．下面使用反证法来证明一下充分性．假设函数\(f\)在闭区间上不是一致连续的，那么就能找到这样的两个有界数列\(\Seq{x_n}\)和\(\Seq{y_n}\)使得\(\abs*{x_n - y_n} < 1/2^n\)但\(\abs*{\,f(x_n) - f(y_n)}\)却大于等于某个正数\(\varepsilon_0\)．由例~\ref{eg:seqbndcmnidx}可知，存在收敛子列\(\Seq{x_{n_k}}\)和\(\Seq{y_{n_k}}\)．它们不可能收敛于两个不同的数，因为~\(\abs[\big]{x_{n_k} - y_{n_k}} < 1/2^{n_k}\)．可见它们只能收敛于同一个数，把这个数记作\(a\)．显然数\(a\)也在闭区间上．又因为函数\(f\)在闭区间上连续，所以存在\(\delta > 0\)使得当\(\abs{x-a} < \delta\)时就有\(\abs*{\,f(x)-f(a)} < \varepsilon_0/2\)．那么根据三角不等式，就能找到正整数\(K\)使得当\(k > K\)时都有\(\abs[\big]{\,f(x_{n_k} - y_{n_k})} < \varepsilon_0\)．这是不可能的．
  \end{proof}
\end{theorem}

\begin{theorem}
  \label{thm:unicontbothlim}
  函数\(f\)在区间上一致连续的充分条件是：它在此区间上连续且左右端点的单侧极限都存在．特别地，当区间为有界区间时，此条件也是必要条件．

  \begin{proof}
    先证对有界区间的必要性．由定理~\ref{thm:unicont2cont}可知，只需证明它在端点处的单侧极限存在即可．实际上，因为区间端点是确定的数且函数在区间上一致连续，所以对于任意在区间上的非端点数列\(\Seq{x_n}\)，当它收敛于端点时，数列\(\Seq{\,f(x_n)}\)就一定是柯西列．由定理~\ref{thm:seqcvgcauchy}和~\ref{thm:seqcvgsubseq}可知，这些柯西列不可能收敛于不同的数，那么只能收敛于同一个数．再由定理~\ref{thm:limequiv}可知，函数在端点的单侧极限存在．

    再证充分性．当区间是独立点时，显然是成立的．下面仅考虑区间不是孤立点的情况．记函数在左右端点处的极限分别为\(A\)和\(B\)．对于任意的正数\(\varepsilon\)，能找到左右端点的单侧邻域使得当\(x\)落在邻域上时都有\(\abs*{\,f(x)-A} < \varepsilon/2\)和\(\abs*{\,f(x) - B} < \varepsilon/2\)．在左端点的邻域上任取一点\(a\)，在右端点的邻域上任取一点\(b\)，就找到了一个闭区间\(\brkt{a,b}\)．由定理~\ref{thm:hc}可知，能找到\(\delta_{\text{闭}} > 0\)使得函数在\(\brkt{a,b}\)上满足一致连续的条件．令\(\delta_{\text{左}}\)为\(a\)到左端点邻域右端的距离，\(\delta_{\text{右}}\)为\(b\)到右端点邻域左侧的距离．取\(\delta = \minb{\delta_{\text{左}}, \delta_{\text{闭}}, \delta_{\text{右}}}\)即可得证．
  \end{proof}
\end{theorem}

\subpdfbookmark{思考}{B1.3.3.P}
\subsection*{思考}

\begin{enumerate}
\item 函数在区间上的处处连续和一致连续有什么区别，有什么联系？

  \ifshowsolp
  一致连续是比处处连续更强的条件，它需要的更多，给出的也更多．一致连续一定有处处连续，但处处连续未必一致连续，需要在加上一些条件才能得到一致连续．
  \fi

\item 在有界开区间或者无穷区间上的连续函数未必是一致连续的．请举例说明．

  \ifshowsolp
  正切函数\(\tan x\)在有界开区间\(\paren{-\pi/2,\pi/2}\)上处处连续，但不是一致连续的．平方函数\(x^2\)在无穷区间\(\paren{-\infty,+\infty}\)上处处连续，但也不是一致连续的．
  \fi
\end{enumerate}

\ifshowex
\currentpdfbookmark{练习}{B1.3.3.E}
\subsection*{练习}

\begin{enumerate}
\item 设函数\(f\)在区间\(I\)上有定义．下列说法中，与函数\(f\)在区间\(I\)上一致连续不等价的是\uline{\hfill}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item
    \begin{math}
      \paren[\big]{\forall ε > 0}
      \paren[\big]{\exists δ > 0}
      \paren[\big]{\forall x,y \in I}
      \paren[\big]{\forall \abs[\big]{x-y} < \delta}
      \paren[\big]{\abs[\big]{\,f(x) - f(y)} < ε}
    \end{math}
  \item
    \begin{math}
      \paren[\big]{\forall ε \in \paren{0,1}}
      \paren[\big]{\exists δ > 0}
      \paren[\big]{\forall x,y \in I}
      \paren[\big]{\forall \abs[\big]{x-y} < \delta}
      \paren[\big]{\abs[\big]{\,f(x) - f(y)} < ε}
    \end{math}
  \item
    \begin{math}
      \paren[\big]{\forall ε > 0}
      \paren[\big]{\exists δ > 0}
      \paren[\big]{\forall x,y \in I}
      \paren[\big]{\forall \abs[\big]{x-y} < \delta}
      \paren[\big]{\abs[\big]{\,f(x) - f(y)} < kε}
    \end{math}，
    其中\(k\)是某个正数
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    对于无穷多个正数\(\varepsilon\)，存在\(\delta > 0\)使得：对于区间\(I\)上的任意两点\(x\)和\(y\)，当\(\abs*{x-y} < \delta\)时都有\(\abs*{\,f(x) - f(y)} < \varepsilon\)
  \end{itemize}

  \ifshowsol
  正弦函数\(\sin x\)是选项~D的一个反例．
  \fi

\item 关于函数的一致连续性，下列说法中，错误的是\uline{\makebox[10em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 若函数\(f\)在\(\brkt{a,b}\)上连续，则函数\(f\)在\(\brkt{a,b}\)上一致连续
  \item 若函数\(f\)在\(\brkt{a,b}\)上连续，则函数\(f\)在\(\paren{a,b}\)上一致连续
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    若函数\(f\)在\(\paren{a,b}\)上连续，则函数\(f\)在\(\paren{a,b}\)上一致连续
  \item 若函数\(f\)在\(\brkt{a,b}\)上一致连续，则函数\(f\)在\(\brkt{a,b}\)上连续
  \end{itemize}

\item 设函数\(f\)在区间\(I\)上有定义．\uline{\hfill}可以表明函数\(f\)在区间\(I\)上不是一致连续的．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item
    \begin{math}
      \paren[\big]{\exists \varepsilon_0 > 0}
      \paren[\big]{\exists \delta > 0}
      \paren[\big]{\exists x,y \in I}
      \paren[\big]{\abs{x-y} < \delta \tand \abs*{\,f(x) - f(y)} \ge \varepsilon_0}
    \end{math}
  \item
    \begin{math}
      \paren[\big]{\forall \varepsilon_0 > 0}
      \paren[\big]{\exists \delta > 0}
      \paren[\big]{\exists x,y \in I}
      \paren[\big]{\abs{x-y} < \delta \tand \abs*{\,f(x) - f(y)} \ge \varepsilon_0}
    \end{math}
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    存在\(\varepsilon_0 > 0\)使得区间\(I\)上除了有限个\(x\)和\(y\)之外都满足\(\abs*{\,f(x) - f(y)} \ge \varepsilon_0\)
  \item 存在\(\varepsilon_0 > 0\)使得区间\(I\)上有无穷多个\(x\)和\(y\)满足\(\abs*{\,f(x) - f(y)} \ge \varepsilon_0\)
  \end{itemize}

  \ifshowsol
  恒等函数\(x\)满足选项~A、B和~D，但却是一致连续的．
  % TODO: report.  Option C is actually unsatisfiable
  \fi

\item 下列函数中，在区间\(\paren{0,+\infty}\)上一致连续的是\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item \(y = x^2\)
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(y = \sqrt x\)
  \item \(y = 1/x\)
  \item \(y = \ln x\)
  \end{itemize}

  \ifshowsol
  存在\(\varepsilon > 0\)使得对于任意的\(2\delta > 0\)都能找到\(x \in \paren{0,+\infty}\)满足\(\paren{x+\delta}^2 - x^2 = 2\delta x + \delta^2 > \varepsilon\)，只要取\(x = \varepsilon/\delta\)即可．因此，选项~A中的函数并不一致连续．选项~B见例~\ref{eg:unicontsqrt}．由定理~\ref{thm:unicontbndintvbnd}可知，选项~C和~D中函数并不一致连续．
  \fi

\item 下列函数中，在区间\(\paren{0,1}\)上一致连续的是\uline{\makebox[6em]{}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \(y = e^{-x}\)
  \item \(y = \ln x\)
  \item \(y = \sin\frac1x\)     % topology's sine curve
  \item \(y = 1/x^2\)
  \end{itemize}

  \ifshowsol
  由定理~\ref{thm:unicontbothlim}可知，选项~A中的函数在此区间上是一致连续的．由定理~\ref{thm:unicontbndintvbnd}可知，选项~B和~D中的函数并不一致收敛．选项~C见例~\ref{eg:uniconttoposine}．
  \fi
  
\item 函数\uline{\hspace{10em}}在区间\(\brkt{0,1}\)上不是一致连续的．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item
    \begin{math}
      f(x) =
      \begin{cases}
        \dfrac{\ln(1+x)}{x}, & x \in \brkt{0,1} \setminus \Set{0}, \\
        1, & x = 0
      \end{cases}
    \end{math}
  \item
    \begin{math}
      f(x) =
      \begin{cases}
        \dfrac{\sin x}{x}, & x \in \brkt{0,1} \setminus \Set{0}, \\
        1, & x = 0
      \end{cases}
    \end{math}
  \item 
    \begin{math}
      f(x) =
      \begin{cases}
        \dfrac{e^x-1}{x}, & x \in \brkt{0,1} \setminus \Set{0}, \\
        1, & x = 0
      \end{cases}
    \end{math}
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    \begin{math}
      f(x) =
      \begin{cases}
        x \sin\dfrac1x, & x \in \brkt{0,1} \setminus \Set{0}, \\
        1, & x = 0
      \end{cases}
    \end{math}
  \end{itemize}

  \ifshowsol
  由定理~\ref{thm:hc}可知，前三个选项中的函数是一致连续的．关于选项~D中的函数，令\(1/x = 2\,k\pi\)，当\(k\)足够大时，自然能使\(\abs{x-0}\)小于任意的\(\delta\)，然而\(\abs*{\,f(x) - f(0)} = 1\)．因此它不是一致连续的．实际上，如果修改定义，让此函数在原点处的值为零，同样可由定理~\ref{thm:hc}得到一致连续性．
  \fi
  
\item 关于函数\(\lnp{1+x}\)的连续性，下列说法中，错误的是\uline{\hspace{10em}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 它在区间\(\paren{-1,+\infty}\)上处处连续
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    它在区间\(\paren{-1,+\infty}\)上一致连续
  \item 它在区间\(\paren{-1,+\infty}\)上没有最大值和最小值
  \item 它在区间\(\brktparen{1,+\infty}\)上一致连续
  \end{itemize}

  \ifshowsol
  取出子区间\(\paren{-1,0}\)，再由定理~\ref{thm:unicontbndintvbnd}可知，选项~B中的函数在此子区间上不是一致连续的，自然在原区间上也不是一致连续的．关于选项~D，对于任意的\(\varepsilon > 0\)，有
  \begin{equation*}
    \lnp{1+x+\fwdf x} - \lnp{1+x} = \lnp[\bigg]{1 + \frac{\fwdf x}{1+x}} \le \frac{\fwdf x}{1+x} \le \frac{\fwdf x}{2} \le \fwdf x,
  \end{equation*}
  取\(\delta = \varepsilon\)，则当\(0 \le \fwdf x < \delta\)时，自然有\(\,f(x+\fwdf x) - f(x) < \delta = \varepsilon\)．因此它在区间\(\brktparen{1,+\infty}\)上是一致连续的．
  \fi
  
\item 已知函数\(f\)和\(g\)在区间\(\brkt{a,b}\)上连续．下列说法中，错误的是\uline{\hspace{8em}}．
  \begin{itemize}
    \renewcommand{\labelitemi}{\faCircleThin}
  \item 函数\(\maxb{\,f, g}\)在区间\(\brkt{a,b}\)上一致连续
  \item 函数\(\minb{\,f, g}\)在区间\(\brkt{a,b}\)上一致连续
  \item 函数\(fg\)在区间\(\brkt{a,b}\)上一致连续
    \ifshowsol
  \item[\faCircle]
    \else
  \item
    \fi
    函数\(\sgnp{\,fg}\)在区间\(\brkt{a,b}\)上一致连续
  \end{itemize}

  \ifshowsol
  令\(f(x) = x,\ g(x) = x^2\)，则选项~D中的函数\(\sgnp[\big]{\,f(x)\,g(x)} = \sgnp{x^3} = \sgnp{x}\)在原点处间断，自然也就不是一致连续的．因为\(\brkt{a,b}\)是个闭区间，所以根据定理~\ref{thm:hc}，只要证明前三个选项中的函数是连续的，就能说明它们也是一致连续的．选项~C中的函数使用定理~\ref{thm:cont4ops}即可．前两个选项中的函数，利用练习~\ref{B1.1.1.E}题~\ref{B1.1.1.E.9}中的公式，再加上定理~\ref{thm:cont4ops}，只需证明：若函数\(f\)连续，则函数\(\abs*{\,f\,}\)也连续．对于任意的\(\varepsilon > 0\)，因为函数\(f\)在点\(x_0\)处连续，所以存在\(\delta > 0\)使得当\(\abs{x-x_0} < \delta\)时就有
  \begin{equation*}
    \abs[\Big]{\abs*{\,f(x)} - \abs*{\,f(x_0)}} \le \abs*{\,f(x) - f(x_0)} < \varepsilon.
  \end{equation*}
  \fi
\end{enumerate}
\fi

\chapter{导数与微分}

\chapter{导数应用}

\chapter{原函数与不定积分}

\vskip-1.25em
\section{概念与性质}

\textbf{定义：}若函数$f(x)$是函数$ F(x) $在开区间$ \left(a, b\right) $上的导函数,
则称函数$F(x)$为函数$f(x)$在$(a,b)$上的一个原函数．

\textbf{例：} $ f(x) = \sin x $是在$\mathbb{R}$上的一个函数，则函数$ F(x) = -\cos x $是
$ f(x) $在$ \mathbb{R} $上的一个原函数，因为$ f(x) = F'(x) $．

\begin{table*}[h]
  \caption*{导数表}
  \centering
  \begin{tabular}{ l l }
    函数		&	导函数 \\
    $F(x)$		&	$f(x)$ \\
    $x^p$		&	$px^{p-1}$ \\
    $e^x$		&	$e^x$ \\
    $a^x$		&	$a^x \cdot \ln a$ \\
    $\ln |x|$	&	$\frac{1}{x}$
  \end{tabular}
  \begin{tabular}{ l l }
    函数			&	导函数 \\
    $F(x)$			&	$f(x)$ \\
    $\log_a |x|$	&	$\frac{1}{x \cdot \ln a}$ \\
    $\sin x$		&	$\cos x$ \\
    $\cos x$		&	$-\sin x$ \\
    $\tan x$		&	$\sec^2 x$
  \end{tabular}
  \begin{tabular}{ l l }
    函数		&	导函数 \\
    $F(x)$		&	$f(x)$ \\
    $\arcsin x$	&	$\frac{1}{\sqrt{1-x^2}}$ \\
    $\arccos x$&	$-\frac{1}{\sqrt{1-x^2}}$ \\
    $\arctan x$&	$\frac{1}{1+x^2}$ \\ {}
  \end{tabular}
\end{table*}

\begin{table*}[h]
  \caption*{原函数表}
  \centering
  \begin{tabular}{ l l }
    函数			&	原函数 \\
    $f(x)$			&	$F(x)$ \\
    $x^p(p\ne-1)$	&	$\frac{1}{p+1} x^{p+1}$ \\
    $e^x$			&	$e^x$ \\
    $a^x$			&	$\frac{a^x}{\ln a}$ \\
    $\frac{1}{x}$	&	$\ln |x|$
  \end{tabular}
  \begin{tabular}{ l l }
    函数						&	原函数 \\
    $f(x)$						&	$F(x)$ \\
    $\sin x$					&	$-\cos x$ \\
    $\cos x$					&	$\sin x$ \\
    $\sec^2 x$					&	$\tan x$ \\
    $\frac{1}{\sqrt{1-x^2}}$	&	$\arcsin x$
  \end{tabular}
  \begin{tabular}{ l l }
    函数						&	原函数 \\
    $f(x)$						&	$F(x)$ \\
    $-\frac{1}{\sqrt{1-x^2}}$	&	$\arccos x$ \\
    $\frac{1}{1+x^2}$			&	$\arctan x$ \\ \\ {}
  \end{tabular}
\end{table*}

\textbf{问题I：}什么样的$f(x)$在$(a,b)$上存在原函数？

\textbf{答：}\parbox[t]{5in}{
(1) $ f \in C(a,b) $，则$ f $在$(a,b)$内一定存在原函数.（下一章，即第7章）\\
(2) $f$在$(a,b)$不连续，是否还有可能存在原函数？}

\hypertarget{eg:discontI}{}
\textbf{反例}
\begin{gather*}
	f(x) =
	\begin{cases}
		2x \sin \frac{1}{x} - \cos \frac{1}{x}, & x \ne 0 \\
		0, & x = 0
	\end{cases} \\
	F(x) =
	\begin{cases}
		x^2 \sin \frac{1}{x}, & x \ne 0 \\
		0, & x = 0
	\end{cases}
\end{gather*}
$F(x)$在$\mathbb{R}$上是可导函数, 所以有$F'(x) = f(x)$, \ $x \in \mathbb{R}$．

\textbf{问题II：}什么样的函数$f(x)$在$(a,b)$上没有原函数？

\textbf{答：}要回答这个问题, 我们要先回顾一下微分学中学过的Darboux定理.

\hangpar{Darboux定理：}{
若$F(x)$在$[a,b]$上可导(在$a$点右导数存在, 在b点左导数存在)且$F'(a) = \alpha$,
$F'(b) = \beta$, $\alpha \ne \beta$, 则对于任何介于$\alpha$, $\beta$的实数$\eta$,
存在$\xi \in (a,b) $使得$F'(\xi) = \eta$. (导数的介值定理) }

Darboux定理的逆否命题就说明：不满足介值性质的函数没有原函数.

\textbf{例：}若$f(x)$在$(a,b)$上有第一类间断点, 则$f(x)$在$(a,b)$不满足介值定理,
从而在$(a,b)$上没有原函数.
\[f(x) = \begin{cases}
    1, & x \ge 0 \\
    -1, & x < 0
  \end{cases}\]
$x = 0$是第一类间断点, $f(x)$在$(a,b)\ (a<0, b>0)$上没有原函数.

\textbf{例：}
\[f(x) = \begin{cases}
    2x \sin \frac{1}{x} - \cos \frac{1}{x} + 2, & x \ne 0 \\
    -2, & x = 0
  \end{cases}\]
$x=0$是第二类间断点, $f(x)$在$(a,b)\ (a<0, b>0)$上不存在原函数. (cf.~\hyperlink{eg:discontI}{反例})

\textbf{问题III：}若$f(x)$在$(a,b)$上有原函数, 有几个原函数？

\textbf{答：}有无数个.

\hangpar{不同原函数之间的关系：}{
  若$F(x)$是$f(x)$在$(a,b)$内的一个原函数, 则$F(x)+C$均为$f(x)$的原函数, 并且$f(x)$的
  所有原函数构成的集合为$\{F(x)+C\}$, 其中$C \in \mathbb{R}$为任意常数．}

\textbf{证明：}

\vspace{-6pt}
(i) 若$F(x)$是$f(x)$在$(a,b)$上的一个原函数, 则$F'(x)=f(x)$, \ $x\in (a,b)$. 从而$[F(x)+C]' = f(x)$,
\ $x\in (a,b)$, 所以$F(x)+C$都是$f(x)$的原函数.

(ii) 若$G(x)$是$f(x)$在$(a,b)$上的一个原函数, 则$G'(x)=f(x)=F'(x)$, $x\in (a,b)$, 从而$[G(x) - F(x)]' = 0$,
$x \in (a, b)$, 这就意味着 $G(x) - F(x) = C$, 所以$ G(x) = F(x) +C$, $x \in (a, b)$. \qed

我们称$\{F(x)+C\}$为原函数族, 只要找一个原函数为代表, 就能表示所有的原函数.

\textbf{定义：}我们把原函数族称为$f(x)$的不定积分. 记作
\[\{F(x)+C\} = \int f(x) \,dx.\]
\begin{alignat*}{3}
	F&(x) &&\xrightarrow{\text{求导}} &&f(x) \; \text{导函数} \\
	F(x) &+ C &&\xleftarrow[\text{不定积分}]{} &&f(x) \\
	&\veq \\
	\int f(&x) \, dx && &&\text{互为逆过程}
\end{alignat*}

通过上面的原函数表, 给每一个函数加上一个$C$, 就可以构成不定积分表.

\hangpar{不定积分的性质}{
(1) 若$f,g \in R[a,b]$, 则$\int [f(x)+g(x)] \,dx = \int f(x) \,dx + \int g(x) \,dx$\,; \\
(2) 若$f \in R[a,b]$, $\lambda \in \mathbb{R}$, 则$\int [\lambda f(x)] \,dx = \lambda \int f(x) \,dx$．}

\begin{proof}
  \textbf{对(1)的证明：}

  \vspace{-6pt}
  (i) 因为$ (F(x) + G(x))' = F'(x) + G'(x) = f(x) + g(x) $, 所以$ F(x) + G(x) $是$ f(x) + g(x) $的一个原函数.

  (ii)
  \begin{align*}
    \left( \int [f(x) + g(x)] \,dx \right)' = f(x) &+ g(x) \\
                                                   & \veq \\
    \left( \int f(x) \,dx + \int g(x) \,dx \right)' = f(x) &+ g(x) \\
    \intertext{所以}
    \int [f(x) + g(x)] \,dx = \int f(x) \,dx &+ \int g(x) \,dx. \qedhere
  \end{align*}
\end{proof}

\begin{proof}
  \textbf{对(2)的证明：}

  \vspace{-6pt}
  (i) 因为$ (\lambda F(x))' = \lambda F'(x) = \lambda f(x) $, 所以$ \lambda F(x) $是$ \lambda f(x) $的一个原函数.

  (ii)
  \begin{align*}
    \left( \int \lambda f(x) \,dx \right)' = \lambda &f(x) \\
                                                     & \veq \\
    \left( \lambda \int f(x) \,dx \right)' = \lambda &f(x) \\
    \intertext{所以}
    \int \lambda f(x) \,dx = \lambda &\int f(x) \,dx. \qedhere
  \end{align*}
\end{proof}

性质(1)叫做加法法则, 性质(2)叫做数乘法则, 同时使用这两个法则得到:
\[ \int [\lambda f(x) + \mu g(x)] \,dx = \int \lambda f(x) \,dx + \int \mu g(x) \,dx
= \lambda \int f(x) \,dx + \mu \int g(x) \,dx. \]

所谓的减法法则, 可以看成上式的特例:
\[ \int [f(x) - g(x)] \,dx = \int f(x) \,dx - \int g(x) \,dx \quad (\lambda = 1, \mu = -1). \]

\textbf{例1：}$ \displaystyle \int (3x^2 - 2^x) \,dx. $
\begin{align*}
  \int (3x^2 - 2^x) \,dx
  &= 3 \int x^2 \,dx - \int 2^x \,dx \\
  &= 3 \left(\frac{x^3}{3} + C\right) - \left(\frac{2^x}{\ln 2} + C\right) \\
  &= x^3 - \frac{2^x}{\ln 2} + {\color{red} C}.
\end{align*}

\textbf{例2：}$ \displaystyle \int \frac{x^4}{1+x^2} \, dx. $

将这个代入上式
\begin{align*}
  x^4  = (x^4 -1) + 1
  &= (x^2-1)(x^2+1) + 1, \\
  \intertext{得}
  \int \frac{x^4}{1+x^2} \, dx
  &= \int \frac{(x^2-1)(x^2+1) + 1}{1+x^2} \, dx \\
  &= \int \left(x^2 -1 + \frac{1}{1+x^2}\right) \, dx \\
  & = \int x^2 \, dx - \int dx + \int \frac{1}{1+x^2} \, dx \\
  & = \frac{x^3}{3} - x + \arctan x + C.
\end{align*}

\textbf{例3：}$ \displaystyle \int \frac{\cos 2x}{\cos x - \sin x} \, dx. $

将倍角公式代入
\begin{align*}
  \cos 2x = \cos^2 x - \sin^2 x
  &= (\cos x + \sin x)(\cos x - \sin x) \\
  \int \frac{(\cos x + \sin x)\cancel{(\cos x - \sin x)}}{\cancel{\cos x - \sin x}} \, dx
  &= \int (\cos x + \sin x) \, dx \\
  &= \int \cos x \, dx + \int \sin x \, dx \\
  &= \sin x - \cos x + C.
\end{align*}

\textbf{例4：}$ \displaystyle \int \lvert x - 1 \rvert \, dx. $
\begin{align*}
  \lvert x - 1 \rvert
  &= \begin{cases}
    x - 1, & x \ge 1 \\
    1 - x, & x < 1
  \end{cases} \\
  \int \lvert x - 1 \rvert \, dx &= \begin{cases}
    \int (x - 1) \, dx, & x \ge 1 \\
    \int (1 - x) \, dx, & x < 1
  \end{cases} \\
  &= \begin{cases}
    \frac{x^2}{2} - x + C_1, & x \ge 1 \\
    x - \frac{x^2}{2} + C_2, & x < 1
  \end{cases} \\
  \intertext{为了保证$\int \lvert x - 1 \rvert \, dx$在$x=1$处可导, 则必须保证在此处连续. 所以}
  C_1 &= C_2 + 1 \\
  \intertext{设}
  F(x) &= \begin{cases}
    \frac{x^2}{2} - x + 1, & x \ge 1 \\
    x - \frac{x^2}{2}, & x < 1
  \end{cases} \\
  \intertext{则$ F(x) $为$ \lvert x - 1 \rvert $的一个原函数, 就有}
  \int \lvert x - 1 \rvert \, dx & = F(x) + C.
\end{align*}

\section{换元积分法}

\subsection{第一换元法\label{6.2.1}}

设$ \int f(u) \, dx = F(u) + C $且$\varphi(x) \in C^1$,
则$ \int f(\varphi(x)) \varphi'(x) \, dx = F(\varphi(x)) +C $.

\textbf{证明：}$ (\text{左边})' = f(\varphi(x)) \varphi'(x) = (\text{右边})' $. \qed

在实际使用中, 换元法体现了莱布尼茨微分记号的优越性. 将
\begin{align*}
  \varphi'(x) \, dx
  & = d\varphi(x) \\
  \intertext{代入原式, 得}
  \int f(\varphi(x)) \varphi'(x) \, dx
  & = \int f(\varphi(x)) \, d\varphi(x)
    \intertext{用$ u $代替$ \varphi(x) $}
  & = \int f(u) \, du \\
  & = F(u) + C \\
  & = F(\varphi(x)) + C.
\end{align*}

\exds{1}{ \int x \sin x^2 \dx. }

\begin{align*}
  \int x \sin x^2 \dx
  &= \frac{1}{2} \int \sin x^2 \diff(x^2)
  && \mreason{x \dx = \frac12 \diff(x^2)} \\
  &= \frac{1}{2} \int \sin u \du
  && \reason{用$u$代替$x^2$} \\
  &= -\frac{1}{2} \cos u + C \\
  &= -\frac{1}{2} \cos x^2 + C.
\end{align*}

\exds{2}{ \int \cot x \, dx. }

\begin{align*}
  \text{原式}
  &= \int \frac{\cos x}{\sin x} \, dx
  && \mreason{\cot x = \frac{\cos x}{\sin x} } \\
  &= \int \frac{1}{\sin x} \, d(\sin x)
  && \mreason{ d\sin x = \cos x \, dx } \\
  &= \int \frac{du}{u}
  && \mreason{ u = \sin x } \\
  &= \ln \abs{u} + C
  && \mreason{ d\ln \abs{u} = \frac{1}{u} \, du } \\
  &= \ln \abs{\sin x} + C.
  && \mreason{ u = \sin x }
\end{align*}

\hypertarget{eg:arctan}{}
\exds{3}{ \int \frac{dx}{a^2 + x^2} \quad (a \ne 0). }

\begin{align}
  \text{原式} &= \frac{1}{a^2} \int \frac{dx}{1+\paren*{\frac{x}{a}}^2}
  && \reason{因为$a \ne 0$, 提取因子$\frac{1}{a^2}$} \notag \\
              &= \frac{1}{a^2} \int \frac{d(au)}{1+u^2}
  && \mreason{ u = \frac{x}{a} } \notag \\
              &= \frac{1}{a} \int \frac{du}{1+u^2}
  && \mreason{ d(au) = a \, du } \notag \\
              &= \frac{1}{a}\arctan u + C
  && \mreason{ d\arctan u = \frac{1}{1+u^2} \, du } \notag \\
              &= \frac{1}{a}\arctan \frac{x}{a} + C.
  && \mreason{ u = \frac{x}{a} } \label{eq:arctanI}
\end{align}

\exds{4}{ \int \frac{dx}{\sqrt{a^2 - x^2}} \quad (a > 0). }

\begin{align*}
  \text{原式} &= \frac{1}{a} \int \frac{dx}{\sqrt{1-\paren*{\frac{x}{a}}^2}}
  && \reason{因为$a > 0$, 提取因子$\frac{1}{a}$} \\
              &= \frac{1}{a} \int \frac{d(au)}{\sqrt{1-u^2}}
  && \mreason{ u = \frac{x}{a} } \\
              &= \int \frac{du}{\sqrt{1-u^2}}
  && \mreason{ d(au) = a \, du } \\
              &= \arcsin u + C
  && \mreason{ d\arcsin u = \frac{1}{\sqrt{1-u^2}} \, du } \\
              &= \arcsin \frac{x}{a} + C.
  && \mreason{ u = \frac{x}{a} }
\end{align*}

\subsection{第二换元法\label{6.2.2}}

设$ f(x) $为连续函数, $ x = \varphi(t) $连续可导且有反函数, 则
\[ \int f(x) \, dx = \int f(\varphi(t)) \varphi'(t) \, dt. \]

若右边的原函数可求得, 记\disp{ G(t) = \int f(\varphi(t)) \varphi'(t) \, dt }, 则
\[ \int f(x) \, dx = G(\varphi^{-1}(x)) + C. \]

\hypertarget{eg:sinsub}{}
\exds{1}{ \int \sqrt{a^2 - x^2} \, dx. }

假设$ a > 0 $, 则$ -a \le x \le a$.
\begin{align*}
  \text{原式}
  &= \int a(\sqrt{1-\sin^2 t}) \, d(a\sin t)
  && \mreason{x = a \sin t, \  t \in [-\frac{\pi}{2}, \frac{\pi}{2}] } \\
  &= a^2 \int \cos^2 t \, dt
  && \mreason{ \cos t = \sqrt{1-\sin^2 t},\ d(a\sin t) = a\cos t \, dt } \\
  &= a^2 \int \frac{1+\cos 2t}{2} \, dt
  && \mreason{ \cos^2 t = \frac{1+\cos 2t}{2} } \\
  &= \frac{a^2}{2} t + \frac{a^2}{4} \sin 2t + C
  && \mreason{ d\frac{t}{2} = \frac{1}{2} \, dt,\ d\frac{\sin 2t}{4} = \frac{\cos 2t}{2} \, dt } \\
  &= \frac{a^2}{2} \arcsin \frac{x}{a} + \frac{a^2}{4} \sin(2\arcsin\frac{x}{a}) + C
  && \mreason{ t = \arcsin\frac{x}{a} } \\
  &= \frac{a^2}{2} \arcsin \frac{x}{a} + \frac{x}{2} \sqrt{a^2 - x^2} + C.
\end{align*}

\exds{2}{ \int \frac{dx}{\sqrt{x^2 - a^2}}. }

假设$a>0$, 则$x>a$或$x<-a$.
\begin{align*}
  \text{原式} &= \int \frac{a \sec t \tan t \dt}{a \sqrt{\sec^2 t - 1}}
  && \mreason{ x = a\sec t, \  t \in (0, \frac{\pi}{2}) } \\
              &= \int \frac{ \cancel{a \tan t} \sec t }{\cancel{a \tan t}} \, dt
  && \mreason{ d(a\sec t) = a \sec t \tan t \, dt } \\
              &= \int \frac{dt}{\cos t}
  && \mreason{ \sec t = \frac{1}{\cos t} } \\
              &= \int \frac{\cos t \, dt}{\cos^2 t}
  && \reason{分子分母同乘以$\cos t$} \\
              &= \int \frac{d\sin t}{1 - \sin^2 t}
  && \mreason{ d\sin t = \cos t \, dt, \  \cos^2 t = 1 - \sin^2 t} \\
              &= \int \frac{du}{1-u^2}
  && \mreason{ u = \sin t } \\
              &= \frac{1}{2}\paren*{\int \frac{du}{1-u} + \int \frac{du}{1+u} }
  && \mreason{ \frac{1}{1-u^2} = \frac{1}{2}\paren*{\frac{1}{1-u} + \frac{1}{1+u}} } \\
              &= \frac{1}{2}(\ln \abs{1+u} - \ln \abs{1-u} + C)
  && \mreason{ d\ln \abs{1+u} = \frac{1}{1+u},\ d\ln \abs{1-u} = -\frac{1}{1-u} } \\
              &= \frac{1}{2} \ln \abs[\bigg]{\frac{1+\sin t}{1 - \sin t}} + C
  && \reason{对数的性质, \(u = \sin t\)} \\
              &= \frac{1}{2} \ln \abs[\Bigg]{ \frac{1 + \sqrt{1-\paren{a/x}^2}}
                {1 - \sqrt{1-\paren{a/x}^2}} } + C
  && \mreason{ \sin^2 t = 1 - \paren{a/x}^2} \\
              &= \frac{1}{2} \ln \abs[\Bigg]{ \frac{\paren[\big]{1+\sqrt{1-\paren{a/x}^2}}^2}
                {\paren{a/x}^2} } + C
  && \reason{分母有理化} \\
              % &= \ln \paren[\Big]{x + \sqrt{x^2-a^2}} + C.
              &= \ln \paren[\Big]{x/a + \sqrt{\paren{x/a}^2-1}} + C
  && \reason{对数的性质} \\
              &= \arccosh \frac xa.
  && \reason{反双曲余弦的定义}
\end{align*}

这里用双曲余弦函数\(x = a \cosh u\)做换元, 可使步骤更为简洁, 如下
\begin{align*}
  \int \frac{dx}{\sqrt{x^2 - a^2}}
  = \int \frac{a \sinh u}{a \sqrt{\cosh^2 u - 1}} \du
  = \int \du
  = \arccosh \frac xa + C.
\end{align*}

\exds{3}{ \int \frac{dx}{x^2 \sqrt{x^2+1}}. }

\begin{align*}
  \text{原式} &= \int \frac{\diff \tan t}{\tan^2 t \sqrt{\tan^2 t + 1}}
  && \reason{$x = \tan t$,
     因为$x \ne 0$,
     所以$t \in (-\frac{\pi}{2},\frac{\pi}{2})\setminus\{0\}$} \\
              &= \int \frac{\cancel{\sec t} \sec t \dt}{\cancel{\sec t} \tan^2 t}
  && \mreason{ \sec^2 t - \tan^2 t = 1 } \\
              &= \int \frac{\cos t \dt}{\sin^2 t}
  && \mreason{ \sec t = \frac{1}{\cos t},\  \tan t = \frac{\sin t}{\cos t} } \\
              &= \int \frac{\diff \sin t}{\sin^2 t}
  && \mreason{ \diff \sin t = \cos t \dt } \\
              &= -\frac{1}{\sin t} + C
  && \mreason{ \int u^p \, du = \frac{u^{p+1}}{p+1} + C } \\
              &= -\frac{\sqrt{1+x^2}}{x} + C.
  && \frac{1}{\sin t} = \frac{\sqrt{1+x^2}}{x}
\end{align*}

\ifshowex
\currentpdfbookmark{练习}{B1.6.2.E}
\subsection*{练习}

\begin{enumerate}
\item 若\(f(x)\)的导函数是\(\sin x\), 求\(f(x)\)的原函数.

  \ifshowsol
  这题相当于是求函数\(\sin x\)的原函数的原函数, 所以有
  \[
    \int \paren*{\int \sin x \dx} \dx = \int \paren[\big]{-\cos x + C_1} \dx = -\sin x + C_1 x + C_2.
  \]
  \fi

\item 已知\(f(x)\)的一个原函数是\(\sin x\), \(g(x)\)的一个原函数是\(x^2\), 求复函数\(f(g(x))\)的原函数.

  \ifshowsol
  因为
  \[
    f(x) = \ddx \sin x = \cos x, \quad g(x) = \ddx x^2 = 2x,
  \]
  所以
  \begin{align*}
    \int f(g(x)) \dx
    &= \int \cos 2x \dx \\
    &= \frac12 \int \cos t \dt && \mreason{x = t/2} \\
    &= \frac12 \sin t + C = \frac12 \sin 2x + C.
  \end{align*}
  \fi

\item \disp{\int e^{-\abs{x}} \dx}.

  \ifshowsol
  \begin{align*}
    \int e^{-\abs{x}} \dx
    &=
      \begin{cases}
        \int e^{-x} \dx, & x \ge 0, \\
        \int e^x \dx, & x < 0,
      \end{cases} \\
    &=
      \begin{cases}
        - \int e^{t} \dt, & x \ge 0, \qquad \mreason{x = -t} \\
        e^x + C_2, & x < 0,
      \end{cases} \\
    &=
      \begin{cases}
        -e^t + C_1, & x \ge 0, \\
        e^x + C_2, & x < 0,
      \end{cases} \\
    &=
      \begin{cases}
        -e^{-x} + C_1, & x \ge 0, \qquad \mreason{t = -x} \\
        e^x + C_2, & x < 0,
      \end{cases} \\
    &= C +
      \begin{cases}
        -e^{-x} + 2, & x \ge 0, \\
        e^x, & x <0.
      \end{cases} \quad \reason{\(-1 + C_1 = 1 + C_2\), 取\(C_2 = 0\)}
  \end{align*}
  \fi

\item 已知曲线上任一点的二阶导数\(y'' = 6x\), 且在曲线上点\((0, -2)\)处的切线为\(2x - 3y = 6\), 求这条曲线的方程.

  \ifshowsol
  将切线的方程化为点斜式, 得到\(y = 2x/3 - 2\), 所以\(y'\big\vert_{x=0} = 2/3\)．有
  \[
    y' = \int y'' \dx = \int 6x \dx = 3x^2 + c_1,
  \]
  所以\(c_1 = 2/3\). 又有
  \[
    y = \int y' \dx = \int \paren[\Big]{3x^2 + \frac23} \dx = x^3 + \frac23 x + c_2,
  \]
  所以\(c_2 = -2\)．这条曲线的方程是
  \[
    y = x^3 + \frac23 x - 2.
  \]
  \fi

\item \disp{\int \frac{\ln x}{x^2} \dx}.

  \ifshowsol
  最好的办法是用\(x = e^t\)换元后用分部积分法, 可惜这里还没学到．有
  \begin{align*}
    \int \frac{\ln x}{x^2} \dx
    &= \int t e^{-t} \dt
    && \mreason{x = e^t} \\
    &= - \int t \diff e^{-t} \\
    &= - \paren[\Big]{t e^{-t} - \int e^{-t} \dt} \\
    &= - t e^{-t} - e^{-t} + C \\
    &= - \frac{\ln x}{x} - \frac1x + C.
  \end{align*}
  \fi

\item 设\(f(x) = e^{-x}\), 求\disp{\int \frac{f'(\ln x)}{x} \dx}.

  \ifshowsol
  使用第一换元法, 有
  \begin{equation*}
    \int \frac{f'(\ln x)}{x} \dx
    = \int f'(\ln x) \diff (\ln x)
    = f(\ln x) = \frac1x + C.
  \end{equation*}

  也可以直接求导\(f'(x) = - e^{-x}\), 然后直接代入, 有
  \begin{equation*}
    \int \frac{f'(\ln x)}{x} \dx
    = - \int \frac{1}{x^2} \dx
    = \frac1x + C.
  \end{equation*}
  \fi

\item 若\disp{\int f(x) \dx = x^2 + C}, 求\disp{\int x \, f(1-x^2) \dx}.

  \ifshowsol
  使用第一换元法, 有
  \begin{align*}
    \int x \, f(1-x^2) \dx
    = - \frac12 \int f(1-x^2) \diff (1-x^2)
    = - \frac12 \paren[\big]{1-x^2}^2 + C.
  \end{align*}

  或者通过求导得到
  \[
    f(x) = \ddx \int f(x) \dx = \ddx (x^2 + C) = 2x,
  \]
  所以
  \[
    \int x \, f(1-x^2) \dx
    = 2 \int x (1-x^2) \dx
    = x^2 - \frac{x^4}{2} + C.
  \]

  上面两种方法得到的答案形式不一样, 但实际上是等价的, 只要把第一个答案中外部的平方展开, 把产生的常数项吸收到后面的任意常数\(C\)中, 就是第二个答案中的形式.
  \fi

\item \disp{\int \frac{x}{(1-x)^3} \dx}.

  \ifshowsol
  尝试使用\(u = 1/(1-x)^2\)和\(t = 1/(1-x)\)来做换元, 观察到
  \[
    \du = \frac{2}{(1-x)^3} \dx
    \quad \text{和} \quad
    \dt = \frac{1}{(1-x)^2} \dx,
  \]
  所以有
  \begin{align*}
    \int \frac{x}{(1-x)^3} \dx
    &= \int \paren[\bigg]{\frac{x-1}{(1-x)^3} + \frac{1}{(1-x)^3}} \dx \\
    &= - \int \frac{1}{(1-x)^2} \dx + \int \frac{1}{(1-x)^3} \dx \\
    &= - \int \dt + \frac12 \int \du \\
    &= - t + \frac u2 + C \\
    &= - \frac1{1-x} + \frac1{2 (1-x)^2} + C.
  \end{align*}
  \fi

\item \disp{\int \frac{\sin x \cos x}{1 + \sin^4 x} \dx}.

  \ifshowsol
  使用\(u = \sin x\)和\(t = u^2\)来做换元, 就有
  \begin{align*}
    \int \frac{\sin x \cos x}{1 + \sin^4 x} \dx
    &= \int \frac{u}{1+u^4} \du
    && \mreason{\du = \cos x \dx} \\
    &= \frac12 \int \frac1{1+t^2} \dt
    && \mreason{\dt = 2u \du} \\
    &= \frac12 \arctan t + C \\
    &= \frac12 \arctan \sin^2 x + C
    && \mreason{t = u^2,\ u = \sin x}
  \end{align*}
  \fi

\item \disp{\int \paren[\big]{2^x + x^2} \dx}.

  \ifshowsol
  \[
    \int \paren[\big]{2^x + x^2} \dx
    = \int 2^x \dx + \int x^2 \dx
    = \frac{2^x}{\ln 2} + \frac{x^3}3 + C.
  \]
  \fi
\end{enumerate}
\fi

\section{分部积分法}

若$u(x)$, $v(x)$连续可导, 则$[u(x) v(x)]' = u'(x)v(x) + u(x)v'(x)$, 就有
\[
  \int u(x) v'(x) \, dx = u(x) v(x) - \int v(x) u'(x) \, dx
\]
或者
\[
  \underset{\text{难}}{\underline{\int u(x) \, dv(x)}} =
  u(x) v(x) - \underset{\text{易}}{\underline{\int v(x) \, du(x)}}.
\]

这种方法适用于函数本身比较难, 但是其导函数比较简单. 这样的函数$ u(x) $一般有
\[
  \begin{matrix}
    \ln x, & \arctan x, & \arcsin x, & \text{函数复杂, 导数简单,} \\
    e^x, & \sin x, & \cos x, & \text{函数导数, 难度相同．}
  \end{matrix}
\]

\exds{1}{\int \ln x \, dx .}
\begin{align*}
  \int \underset{u(x)}{\underline{\ln x}} \, \underset{dv(x)}{\underline{dx}}
  &= x \ln x - \int \underset{v(x)}{\underline{x}} \, \underset{du(x)}{\underline{d\ln x}}
  && \reason{分部积分法} \\
  &= x \ln x - \int dx
  && \mreason{d\ln x = \frac{1}{x} \, dx} \\
  &= x \ln x - x + C .
  && \mreason{dx = dx}
\end{align*}

\exds{2}{\int x \arctan x \, dx .}
\begin{align*}
  \int x \, \underset{u(x)}{\underline{\arctan x}} \, dx
  &= \int \arctan x \, d\frac{x^2}{2}
  && \mreason{d\frac{x^2}{2} = x \, dx} \\
  &= \frac{x^2}{2} \arctan x - \int \frac{x^2}{2} \, d(\arctan x)
  && \reason{分部积分法} \\
  &= \frac{x^2}{2} \arctan x - \int \frac{x^2}{2(1+x^2)} \, dx
  && \mreason{d(\arctan x) = \frac{1}{1+x^2}} \\
  &= \frac{x^2}{2} \arctan x - \frac{1}{2} \int \paren[\bigg]{1 - \frac{1}{1+x^2}} \, dx
  && \mreason{\frac{x^2}{1+x^2} = 1 - \frac{1}{1+x^2}} \\
  &= \frac{1}{2} \paren[\bigg]{x^2 \arctan x - \int dx + \int \frac{dx}{1+x^2}}
  && \reason{积分的加法法则} \\
  &= \frac{1}{2} \brkt[\big]{(x^2+1) \arctan x - x} + C .
  && \mreason{dx = dx,\, d(\arctan x) = \frac{1}{1+x^2}}
\end{align*}

\exds{3}{\int x^2 \, e^x \dx.}
\begin{align*}
  \text{原式}
  &= \int x^2 \diff e^x \\
  &= x^2 e^x - \int e^x \, d(x^2)
  && \reason{分部积分法} \\
  &= x^2 e^x - 2\int x \, de^x \\
  &= x^2 e^x - 2\paren[\Big]{x e^x - \int e^x \, dx}
  && \reason{分部积分法} \\
  &= (x^2 - 2x + 2) e^x + C.
\end{align*}

\exds{4}{\int x \sin(2x) \, dx.}
\begin{align*}
  \text{原式}
  &= \frac{1}{2} \int x \, d[-\cos(2x)] \\
  &= \frac{1}{2} \paren*{\int \cos(2x) \, dx - x \cos(2x)}
  && \reason{分部积分法} \\
  &= \frac{1}{2} \paren[\bigg]{\frac{1}{2} \sin(2x) - x \cos(2x)} + C.
\end{align*}

\exds{5}{\int e^x \sin x \, dx.}
\begin{align*}
  -\int e^x \, d\cos x
  &= \text{原式}
    = \int \sin x \, de^x \\
  - e^x \cos x + \int \cos x \, de^x
  &= \text{原式}
    = e^x \sin x - \int e^x \, d\sin x
  && \reason{分部积分法} \\
  \intertext{因为$\int \cos x \, de^x = \int e^x \cos x \, dx = \int e^x \, d\sin x$, 所以}
  \int e^x \cos x \, dx
  &= \frac{\sin x + \cos x}{2} e^x + C, \\
  \text{原式}
  &= e^x \sin x - \frac{\sin x + \cos x}{2} e^x + C \\
  &= \frac{\sin x - \cos x}{2} e^x + C.
\end{align*}

\section{有理函数的积分}

\subsection{四个特殊函数的不定积分}

\begin{enumerate}
\item \disp{\int \frac A{ax+b} \dx,\ (a \ne 0)}.
  \[
    \frac Aa \int \frac1{x + b/a} \dx
    = \frac Aa \ln \abs[\bigg]{x + \frac ba} + C.
  \]

\item \disp{\int \frac A{(ax+b)^n} \dx, \ (a \ne 0, n \in \N^+ \setminus \brce{1})}.
  \[
    \frac A{a^n} \int \frac1{(x+b/a)^n} \dx
    = \frac A{a^n} \int \frac1{(x+b/a)^n} \diff (x+b/a)
    = - \frac A{a^n (n-1) (x+b/a)^{n-1}} + C.
  \]

\item \disp{\int \frac{Bx+D}{px^2+qx+r} \dx, \ (p \ne 0, \Delta < 0, B \ne 0)}.

  设\(P(x) = px^2 + qx + r\), \(\Delta\)为二次多项式\(P(x)\)的判别式, 则有
  \begin{align*}
    \int \frac{Bx+D}{P(x)} \dx
    &= \frac{B}{2p} \int \frac{P'(x) - q + (2p/B)D}{P(x)} \dx
    && \reason{提取因子\(B/2p\)} \\
    &= \frac{B}{2p} \int \frac{P'(x)}{P(x)} \dx + \paren[\bigg]{D - \frac{B}{2p} q} \int \frac{\dx}{P(x)}
    && \reason{积分的加法法则} \\
    &= \frac{B}{2p} \int \frac{\diff P(x)}{P(x)} + \paren[\bigg]{D - \frac{B}{2p} q} \frac1p \int \frac{\dx}{P(x)/p}
    && \reason{第一换元法} \\
    &= \frac{B}{2p} \ln \abs[\big]{P(x)} + \paren[\bigg]{D - \frac{B}{2p} q} \frac1p \int \frac{\dx}{\paren[\big]{x+\frac{q}{2p}}^2 - \frac{\Delta}{4p^2}}
    && \mreason{\frac{P(x)}{p} = \paren[\Big]{x+\frac{q}{2p}}^2 - \frac{\Delta}{4p^2}} \\
    &= \frac{B}{2p} \ln \abs[\big]{P(x)} + \paren[\bigg]{D - \frac{B}{2p} q} \frac2{\sqrt{-\Delta}} \arctan \frac{P'(x)}{\sqrt{-\Delta}} + C.
    && \mreason{\int \frac{\dx}{x^2 + a^2} = \frac1a \arctan \frac{x}{a}}
  \end{align*}

  上面推导的过程中其实假定了\(p > 0\)．其实当\(p < 0\)时, 上式也成立.

\item \disp{\int \frac{Bx+D}{\paren{px^2+qx+r}^n} \dx, \ (p \ne 0, \Delta < 0, B \ne 0, n \in \N^+ \setminus \brce{1})}.

  设
  \[
    I_{n,a^2}(x) = \int \frac{\dx}{\paren[\big]{x^2 + a^2}^n},
  \]
  那么\(I_{1,a^2}(x)\)就是~\ref{6.2.1}中的\hyperlink{eg:arctan}{例3}．此外还有
  \begin{align*}
    I_{n,a^2}(x)
    &= \frac{x}{\paren[\big]{x^2 + a^2}^n} - \int x \diff\brkt[\bigg]{\frac{1}{\paren[\big]{x^2 + a^2}^n}} \\
    &= \frac{x}{\paren[\big]{x^2 + a^2}^n} + 2n \int \frac{x^2}{\paren[\big]{x^2 + a^2}^{n+1}} \dx \\
    &= \frac{x}{\paren[\big]{x^2 + a^2}^n} + 2n \int \brkt[\bigg]{\frac{x^2 + a^2}{\paren[\big]{x^2 + a^2}^{n+1}} - \frac{a^2}{\paren[\big]{x^2 + a^2}^{n+1}}} \dx \\
    &= \frac{x}{\paren[\big]{x^2 + a^2}^n} + 2n \paren[\big]{I_{n,a^2}(x) - a^2 I_{n+1,a^2}(x)},
  \end{align*}
  得到递推关系
  \begin{equation}
    I_{n+1,a^2}(x) = \frac{1}{2na^2} \brkt[\Big]{(2n-1) I_{n,a^2}(x) + \frac{x}{\paren[\big]{x^2 + a^2}^n}}.
  \end{equation}
  用处理第三类特殊函数同样的方法, 得到
  \begin{align*}
    \int \frac{Bx+D}{P^n(x)} \dx
    &= \frac{B}{2p} \int \frac{P'(x) - q + (2p/B)D}{P^n(x)} \dx \\
    &= \frac{B}{2p} \int \frac{P'(x)}{P^n(x)} \dx + \paren[\bigg]{D - \frac{B}{2p} q} \int \frac{\dx}{P^n(x)} \\
    &= \frac{B}{2p} \int \frac{\diff P(x)}{P^n(x)} + \paren[\bigg]{D - \frac{B}{2p} q} \frac1{p^n} \int \frac{\dx}{\brkt*{P(x)/p}^n} \\
    &= \frac{B}{2p} \frac{P^{1-n}(x)}{1-n} + \paren[\bigg]{D - \frac{B}{2p} q} \frac1{p^n} \int \frac{\dx}{\brkt[\Big]{\paren[\big]{x+\frac{q}{2p}}^2 - \frac{\Delta}{4p^2}}^n} \\
    &= \frac{B}{2p} \frac{P^{1-n}(x)}{1-n} + \paren[\bigg]{D - \frac{B}{2p} q} \frac{I_{n,-\Delta/4p^2}\paren*{x+q/2p}}{p^n} + C.
  \end{align*}
\end{enumerate}

\subsection{有理分式函数的化简}

设\(P_n(x)\)和\(Q_m(x)\)分别为\(x\)的\(n\)次和\(m\)次多项式, 则当\(n < m\)时, 称
\[
  \frac{P_n(x)}{Q_m(x)}
\]
为真分式有理函数, 当\(n \ge m\)时, 称之为假分式有理函数．一个真分式有理函数可以分解成一个多项式与一个假分式有理函数的和的形式.

\exds{1}{\frac{x^4 + 2x^3 + x^2 + 3}{x^2 + 1} = x^2 + 2x + \frac{-2x+3}{x^2 + 1}}.

多项式的不定积分已经解决了, 剩下只要把真分式有理函数分解成前面提到的四类特殊函数的和的形式, 那么有理函数的不定积分就解决了.

\exds{2}{\frac{2x^2 + 2x + 13}{(x-2)\paren{x^2+1}^2}}.

使用待定系数法, 有
\begin{align*}
  \text{原式}
  &= \frac{A}{x-2} + \frac{Bx+C}{x^2+1} + \frac{Dx+E}{\paren{x^2+1}^2} \\
  &= \frac{A\paren{x^2+1}^2
    + \paren{Bx+C}\paren{x-2}\paren{x^2+1}
    + \paren{Dx+E}\paren{x-2}}{%
    (x-2)\paren{x^2+1}^2} \\
  &= \frac{\paren{A + B} x^4
    + \paren{-2B + C} x^3
    + \paren{2A + B - 2C + D}x^2
    + \paren{-2B + C - 2D + E} x
    + \paren{A - 2C - 2E}}{%
    (x-2)\paren{x^2+1}^2}.
\end{align*}
写成方程组的形式
\[
  \hspace*{-2em}
  \systeme{%
    A + B = 0,
    {-2}B + C = 0,
    2A + B - 2C + D = 2,
    {-2}B + C - 2D + E = 2,
    A - 2C - 2E = 13}
  \quad
  \mathrel{\Longrightarrow}
  \qquad
  \systeme{%
    A = 1,
    B = -1,
    C = -2,
    D = -3,
    E = -4},
\]
所以有
\[
  \frac{2x^2 + 2x + 13}{(x-2)\paren{x^2+1}^2}
  = \frac{1}{x-2} - \frac{x+2}{x^2+1} - \frac{3x+4}{\paren{x^2+1}^2}.
\]

\exds{3}{\frac{x^2 + 3x + 1}{(x-2)^2 (x^2 + x + 2)^2}}.

使用待定系数法, 有
\[
  \frac{x^2 + 3x + 1}{(x-2)^2 (x^2 + x + 2)^2}
  = \frac{A}{x-2} + \frac{B}{(x-2)^2} + \frac{Cx+D}{x^2 + x + 2} + \frac{Ex+F}{(x^2 + x + 2)^2}.
\]
右边通分后, 整理成方程组的形式
\[
  \systeme{%
    A + C = 0,
    B - 3C + D = 0,
    A + 2B + 2C - 3D + E = 0,
    {-6}A + 5B - 4C + 2D - 4E + F = 1,
    {-4}A + 4B + 8C - 4D + 4E - 4F = 3,
    {-8}A + 4B + 8D + 4F = 1}
  \quad
  \mathrel{\Longrightarrow}
  \quad
  \systeme{%
    A = -27/256,
    B = 11/64,
    C = 27/256,
    D = 37/256,
    E = -1/64,
    F = -27/64},
\]
所以有
\[
  \frac{x^2 + 3x + 1}{(x-2)^2 (x^2 + x + 2)^2}
  = - \frac{27}{256(x-2)} + \frac{11}{64(x-2)^2} + \frac{27x+37}{256(x^2 + x + 2)} - \frac{x+27}{64(x^2 + x + 2)^2}.
\]

\subsection{有理分式函数的不定积分\label{6.4.3}}

\exds{1}{\int \frac{x^4 + 2x^3 + x^2 + 3}{x^2 + 1} \dx}.
\begin{align*}
  \int \paren[\bigg]{x^2 + 2x + \frac{-2x+3}{x^2 + 1}} \dx
  &= \frac{\,x^3\!}{3} + x^2 - \int \frac{2x}{x^2 + 1} \dx + 3 \int \frac{\dx}{x^2 + 1} \\
  &= \frac{\,x^3\!}{3} + x^2 - \ln\paren{x^2+1} + 3 \arctan x + C.
\end{align*}

\exds{2}{\int \frac{2x^2 + 2x + 13}{(x-2)\paren{x^2+1}^2} \dx}.

\begin{align*}
  \int \frac{2x^2 + 2x + 13}{(x-2)\paren{x^2+1}^2} \dx
  &= \int \brkt[\bigg]{\frac{1}{x-2} - \frac{x+2}{x^2+1} - \frac{3x+4}{\paren{x^2+1}^2}} \dx \\
  &= \ln\abs[\big]{x-2}
    - \frac12 \int \frac{2x}{x^2+1} \dx
    - 2 \int \frac{\dx}{x^2+1} \\
  &\qquad - \frac32 \int \frac{2x}{(x^2+1)^2} \dx - 4 \int \frac{\dx}{(x^2+1)^2} \\
  &= \ln\abs[\big]{x-2} - \frac12 \ln(x^2+1) - 2 \arctan x \\
  &\qquad + \frac{3}{2(x^2+1)} - 4 \, I_{2,1} \\
  &= \ln\abs[\big]{x-2} - \frac12 \ln(x^2+1) - 2 \arctan x \\
  &\qquad + \frac{3}{2(x^2+1)} - 2 \, \paren*{I_{1,1} + \frac{x}{x^2+1}} \\
  &= \ln\abs[\big]{x-2} - \frac12 \ln(x^2+1) - 2 \arctan x \\
  &\qquad + \frac{3}{2(x^2+1)} - 2 \arctan x  - \frac{2x}{x^2+1} + C \\
  &= \ln\frac{\abs{x-2}}{\scriptstyle\sqrt{x^2+1}} - 4 \arctan x + \frac{3-4x}{2(x^2+1)} + C.
\end{align*}

\subsection{三角有理函数的不定积分}

对于\(R(\sin x, \cos x)\)这样带有三角函数的分式有理函数, 可以使用变量替换\(t = \tan\frac{x}{2}\)将其转换成关于\(t\)的有理函数．因为
\begin{gather*}
  \sin x = \frac{2\tan\frac{x}{2}}{1+\tan^2\frac{x}{2}} = \frac{2t}{1+t^2},
  \quad
  \cos x = \frac{1 - \tan^2\frac{x}{2}}{1+\tan^2\frac{x}{2}} = \frac{1-t^2}{1+t^2}, \\[1ex]
  x = 2 \arctan t,
  \quad
  \dx = \frac{2}{1+t^2} \dt,
\end{gather*}
所以
\[
  R(\sin x, \cos x) \dx = R\paren[\bigg]{\frac{2t}{1+t^2}, \frac{1-t^2}{1+t^2}} \frac{2}{1+t^2} \dt.
\]
设
\[
  I(t) = \int R\paren[\bigg]{\frac{2t}{1+t^2}, \frac{1-t^2}{1+t^2}} \frac{2}{1+t^2} \dt,
\]
则
\[
  \int R(\sin x, \cos x) \dx = I\paren[\Big]{\tan\frac{x}{2}}.
\]

\ifshowex
\currentpdfbookmark{练习}{B1.6.4.E}
\subsection*{练习}

\begin{enumerate}
  \ifshowsol
  \setlength{\itemsep}{10pt plus 4pt minus 4pt}
  \setlength{\abovedisplayskip}{5pt plus 2pt minus 5pt}
  \setlength{\belowdisplayskip}{10pt plus 3pt minus 2pt}
  \fi
\item 设\(\displaystyle J_k = \int \frac{\dx}{\brkt{(x+a)^2 + b^2}^k}\), 求\(J_k\)的递推表达式.

  \ifshowsol
  因为
  \[
    J_k
    = \int \frac{\dx}{\brkt{(x+a)^2 + b^2}^k}
    = \int \frac{\diff(x+a)}{\brkt{(x+a)^2 + b^2}^k}
    = \int \frac{\du}{\paren{u^2 + b^2}^k}
    = I_{k,b^2}(u)
    = I_{k,b^2}(x+a),
  \]
  所以
  \begin{equation*}
    \begin{split}
      J_{k+1}
      = I_{k+1,b^2}(x+a)
      &= \frac{1}{2kb^2} \brce[\bigg]{(2k-1) I_{k,b^2}(x+a) + \frac{x+a}{\brkt{(x+a)^2 + b^2}^k}} \\
      &= \frac{1}{2kb^2} \brce[\bigg]{(2k-1) J_k + \frac{x+a}{\brkt{(x+a)^2 + b^2}^k}}.
    \end{split}
  \end{equation*}
  \fi

\item \(\displaystyle \int \frac{\dx}{(x+a)^2 + b^2} \quad (b \ne 0)\).

  \ifshowsol
  \[
    \int \frac{\dx}{(x+a)^2 + b^2}
    = \int \frac{\diff(x+a)}{(x+a)^2 + b^2}
    = \int \frac{\du}{u^2 + b^2}
    = \frac1b \arctan \frac ub + C
    = \frac1b \arctan \frac{x+a}b + C.
  \]
  \fi

\item \(\displaystyle \int \frac{\dx}{1-x^2}\).

  \ifshowsol
  \[
    \int \frac{\dx}{1-x^2}
    = \arctanh x + C
    = \frac12 \ln\frac{1+x}{1-x} + C.
  \]
  \fi

\item \(\displaystyle \int \frac{t+4}{t^2 + 5t -6} \dt\).

  \ifshowsol
  \[
    \begin{split}
      \int \frac{t+4}{t^2 + 5t -6} \dt
      &= \int \frac{t+4}{(t-1)(t+6)} \dt
      = \frac57 \int \frac{\dt}{t-1} + \frac27 \int \frac{\dt}{t+6} \\
      &= \frac57 \ln\abs[\big]{t-1} + \frac27 \ln\abs[\big]{t+6} + C
      = \frac17 \ln\abs[\big]{(t-1)^5 (t+6)^2} + C.
    \end{split}
  \]
  \fi

\item \(\displaystyle \int \frac{2x^2+2x+13}{(x-2)(x^2+1)^2} \dx\).

  \ifshowsol
  \pskip
  这题就是~\ref{6.4.3}的例2.
  \pskip
  \fi

\item \(\displaystyle \int \frac{\dx}{x^4+1}\).

  \ifshowsol
  \[
    \begin{split}
      \int \frac{\dx}{x^4+1}
      &= \int \frac{\dx}{(x^2+1)^2 - 2x^2}
      = \int \frac{\dx}{(x^2+{\scriptstyle\sqrt2}\,x+1)(x^2-{\scriptstyle\sqrt2}\,x+1)} \\
      &= \frac14 \int \paren[\bigg]{\frac{{\scriptstyle\sqrt2}\,x+2}{x^2+{\scriptstyle\sqrt2}\,x+1} - \frac{{\scriptstyle\sqrt2}\,x-2}{x^2+{\scriptstyle\sqrt2}\,x+1}} \dx \\
      &= \frac{\scriptstyle\sqrt2\,}{8} \int \frac{2x+{\scriptstyle\sqrt2}}{x^2+{\scriptstyle\sqrt2}\,x+1} \dx + \frac14 \int \frac{\dx}{x^2+{\scriptstyle\sqrt2}\,x+1} \\
      &\qquad - \frac{\scriptstyle\sqrt2\,}{8} \int \frac{2x-{\scriptstyle\sqrt2}}{x^2-{\scriptstyle\sqrt2}\,x+1} \dx + \frac14 \int \frac{\dx}{x^2-{\scriptstyle\sqrt2}\,x+1} \\
      &= \frac{\scriptstyle\sqrt2\,}{8} \ln\paren[\bigg]{\frac{x^2+{\scriptstyle\sqrt2}\,x+1}{x^2-{\scriptstyle\sqrt2}\,x+1}} + \frac14 \int \frac{\dx}{(x+{\scriptstyle\sqrt2}/2)^2 + 1/2} \\
      &\qquad + \frac14 \int \frac{\dx}{(x-{\scriptstyle\sqrt2}/2)^2 + 1/2} \\
      &= \frac{\scriptstyle\sqrt2\,}{8} \ln\paren[\bigg]{\frac{x^2+{\scriptstyle\sqrt2}\,x+1}{x^2-{\scriptstyle\sqrt2}\,x+1}} + \frac{\scriptstyle\sqrt2\,}4 \int \frac{\diff({\scriptstyle\sqrt2}\,x+1)}{({\scriptstyle\sqrt2}\,x+1)^2 + 1} \\
      &\qquad + \frac{\scriptstyle\sqrt2\,}4 \int \frac{\diff({\scriptstyle\sqrt2}\,x-1)}{({\scriptstyle\sqrt2}\,x-1)^2 + 1} \\
      &= \frac{\scriptstyle\sqrt2\,}{8} \ln\paren[\bigg]{\frac{x^2+{\scriptstyle\sqrt2}\,x+1}{x^2-{\scriptstyle\sqrt2}\,x+1}} + \frac{\scriptstyle\sqrt2\,}4 \brkt*{\arctan({\scriptstyle\sqrt2}\,x+1) + \arctan({\scriptstyle\sqrt2}\,x-1)} + C \\
      &= \frac{\scriptstyle\sqrt2\,}{8} \ln\paren[\bigg]{\frac{x^2+{\scriptstyle\sqrt2}\,x+1}{x^2-{\scriptstyle\sqrt2}\,x+1}} + \frac{\scriptstyle\sqrt2\,}4 \arctan\frac{{\scriptstyle\sqrt2}\,x}{1-x^2} + C.
    \end{split}
  \]
  \fi
\end{enumerate}
\fi

\section{简单无理式的积分\label{6.5}}

类型I

\begin{itemize}
\item \(\displaystyle \int R\paren[\big]{x, \sqrt{(x+p)^2 - q^2}} \dx\), 用\(x + p = q \sec t\)做替换.
\item \(\displaystyle \int R\paren[\big]{x, \sqrt{(x+p)^2 + q^2}} \dx\), 用\(x + p = q \tan t\)做替换.
\item \(\displaystyle \int R\paren[\big]{x, \sqrt{q^2 - (x+p)^2}} \dx\), 用\(x + p = q \sin t\)做替换.
\end{itemize}

前面~\ref{6.2.2}的\hyperlink{eg:sinsub}{例1}就属于这一类型的替换.

\exds{1}{\int \frac{\dx}{1+\sqrt{x^2+2x+2}}}.

类型II
\[
  \int R\paren[\big]{x, \sqrt[n]{ax+b}} \dx, \quad (a \ne 0).
\]
用
\[
  t = \sqrt[n]{ax+b}, \quad
  x = \frac{t^n-b}{a}, \quad
  \dx = \frac{nt^{n-1}}{a} \dt
\]
做替换, 就有
\[
  \int R\paren[\big]{x, \sqrt[n]{ax+b}} \dx
  = \int R\paren[\Big]{\frac{t^n-b}{a}, t} \frac{nt^{n-1}}{a} \dt.
\]

\exds{2}{\int \frac{x}{\sqrt{x-1}} \dx}.

类型III

\[
  \int R\paren[\Big]{x, \sqrt[n]{\frac{ax+b}{cx+d}}} \dx, \quad (a \ne 0, c \ne 0).
\]
用
\[
  t = \sqrt[n]{\frac{ax+b}{cx+d}}, \quad
  x = \frac{dt^n-b}{a-ct^n}, \quad
  \dx = \frac{(ad-bc)nt^{n-1}}{(a-ct^n)^2} \dt
\]
做替换, 就有
\[
  \int R\paren[\Big]{x, \sqrt[n]{\frac{ax+b}{cx+d}}} \dx
  = \int R\paren[\Big]{\frac{dt^n-b}{a-ct^n}, t} \frac{(ad-bc)nt^{n-1}}{(a-ct^n)^2} \dt.
\]

\hypertarget{eg:rootI}{}
\exds{3}{\int \frac{\dx}{\sqrt[3]{(x-1)(x+1)^2}}}.

用\(t = \sqrt[3]{\frac{x+1}{x-1}}\)做换元, 则\(x = \frac{t^3+1}{t^3-1},\ \dx = -\frac{2(3t^2)}{(t^3-1)^2} \dt\), 那么
\[
  \begin{split}
    \int \frac{\dx}{\sqrt[3]{(x-1)(x+1)^2}}
    &= \int \sqrt[3]{\frac{x+1}{x-1}} \frac{\dx}{x+1}
    = \int t \cdot \frac{t^3-1}{2t^3} \cdot \frac{-2(3t^2)}{(t^3-1)^2} \dt
    = -3 \int \frac{\dt}{t^3-1} \\
    &= -3 \int \frac{\dt}{(t-1)(t^2+t+1)}
    = - \int \paren[\Big]{\frac{1}{t-1} - \frac{t+2}{t^2+t+1}} \dt \\
    &= \frac12 \int \frac{2t+1}{t^2+t+1} \dt + \frac32 \int \frac{\dt}{\paren[\big]{t+\frac12}^2+\frac34} - \ln\abs[\big]{t-1} \\
    &= \frac12 \ln(t^2+t+1) - \ln\abs[\big]{t-1} + 2 \int \frac{\dt}{\paren[\Big]{\frac{2t+1}{\scriptscriptstyle\sqrt3}}^2 + 1} \\
    &= \frac12 \ln(t^2+t+1) - \ln\abs[\big]{t-1} + \sqrt3 \arctan \frac{2t+1}{\scriptstyle\sqrt3} + C.
  \end{split}
\]

\ifshowex
\subpdfbookmark{练习}{B1.6.5.E}
\subsection*{练习}

\begin{enumerate}
  \ifshowsol
  \setlength{\parskip}{8pt plus 3pt minus 2pt}
  \setlength{\itemsep}{7pt plus 2pt minus 2pt}
  \setlength{\abovedisplayskip}{7pt plus 5pt minus 2pt}
  \setlength{\belowdisplayskip}{8pt plus 4pt minus 3pt}
  \fi
\item \(\displaystyle \int \frac{\sqrt{x^2 - 2x + 1}}{x-1} \dx\).

  \ifshowsol
  \vspace*{-1em}
  \[
    \int \frac{\sqrt{x^2 - 2x + 1}}{x-1} \dx
    = \int \frac{\sqrt{(x-1)^2}}{x-1} \dx
    = \int \frac{\abs{x-1}}{x-1} \dx
    = \int \sgn(x-1) \dx
    =
    \begin{cases}
      x + C_1, & x > 1, \\
      -x + C_2, & x < 1.
    \end{cases}
  \]
  \fi

\item \(\displaystyle \int \sqrt{e^x+1} \dx\).

  \ifshowsol
  用\(t = \sqrt{e^x + 1}\)做换元, 有
  \[
    \begin{split}
      \int \sqrt{e^x+1} \dx
      &= 2 \int \frac{t^2}{t^2-1} \dx
      = 2 \int \paren[\Big]{1 - \frac{1}{1-t^2}} \dx
      = 2t - \ln\abs[\bigg]{\frac{1+t}{1-t}} + C \\
      &= 2 \sqrt{e^x + 1} - \ln\abs[\Bigg]{\frac{1+\sqrt{e^x + 1}}{1-\sqrt{e^x + 1}}} + C.
    \end{split}
  \]
  \fi

\item \(\displaystyle \int \frac{\dx}{\sqrt[3]{(x-1)(x+1)^2}}\).

  \ifshowsol
  这题就是~\ref{6.5}的\hyperlink{eg:rootI}{例3}
  \fi

\item \(\displaystyle \int \frac{\dx}{1 + \sin x}\).

  \ifshowsol
  用\(t = \tan\frac{x}{2}\)做换元, 有
  \[
    \begin{split}
      \int \frac{\dx}{1 + \sin x}
      &= \int \frac{1}{\scriptstyle 1 + \tfrac{2t}{1+t^2}} \frac{2}{\scriptstyle 1+t^2} \dt
      = 2 \int \frac{\dt}{t^2+2t+1}
      = 2 \int \frac{\dt}{(t+1)^2} \\
      &= - \frac{2}{t+1} + C
      = - \frac{2}{1+\tan\frac{x}{2}} + C.
    \end{split}
  \]
  \fi

\item \(\displaystyle \int \frac{\dx}{1 - \cos x}\).

  \ifshowsol
  同样用\(t = \tan\frac{x}{2}\)做换元, 有
  \[
    \begin{split}
      \int \frac{dx}{1-\cos x}
      = \int \frac{1}{\scriptstyle 1-\tfrac{1-t^2}{1+t^2}} \frac{2}{1+t^2} \dt
      = \int \frac{dt}{t^2}
      = - \frac1t + C
      = - \cot\frac{x}{2} + C.
    \end{split}
  \]
  \fi

\item \(\displaystyle \int \frac{1 + \sin x}{1 + \cos x} \dx\).

  \ifshowsol
  同样用\(t = \tan\frac{x}{2}\)做换元, 有
  \[
    \begin{split}
      \int \frac{1 + \sin x}{1 + \cos x} \dx
      &= \int \tfrac{1 + \tfrac{2t}{1+t^2}}{1+\tfrac{1-t^2}{1+t^2}} \frac{2}{1+t^2} \dt
      = \int \paren[\Big]{1 + \frac{2t}{1+t^2}} \dt \\
      &= t + \ln\paren{1+t^2} + C
      = \tan\frac{x}{2} + \ln\sec^2\frac{x}{2} + C \\
      &= \tan\frac{x}{2} + \ln\frac{2}{1 + \cos x} + C
      = \tan\frac{x}{2} - \ln\paren{1 + \cos x} + C.
    \end{split}
  \]
  \fi

\item \(\displaystyle \int \frac{\tan x}{a^2 \cos^2 x + b^2 \sin^2 x} \dx,\ (a \ne 0,\ b \ne 0)\).

  \ifshowsol
  用\(u = \tan x\)做换元, 有
  \[
    \begin{split}
      \int \frac{\tan x}{a^2 \cos^2 x + b^2 \sin^2 x} \dx
      &= \int \frac{\tan x}{a^2 + b^2 \tan^2 x} \frac{1}{\cos^2 x} \dx
      = \int \frac{u}{a^2 + b^2 u^2} \du \\
      &= \frac1{2b^2} \ln\paren{a^2 + b^2 u^2} + C
      = \frac1{2b^2} \ln\paren{a^2 + b^2 \tan^2 x} + C.
    \end{split}
  \]
  \fi

\item \(\displaystyle \int \frac{\sin 2x}{\cos^2 x + 2 \sin x} \dx\).

  \ifshowsol
  用\(u = \sin x\)做换元, 有
  \[
    \int \frac{\sin 2x}{\cos^2 x + 2 \sin x} \dx
    = \int \frac{2 \sin x \cos x}{1 - \sin^2 x + 2 \sin x} \dx
    = \int \frac{2u}{1 - u^2 + 2u} \du.
  \]
  上面最右边的式子, 我们可以有两种方式处理．两种方式处理后得到的结果形式略有不同, 但是变形后其实是一样的．第一种就是继续部分分式分解, 有
  \[
    \begin{split}
      \int \frac{2u}{1 - u^2 + 2u} \du
      &= - \frac12 \int \paren[\bigg]{\frac{2 + \sqrt2}{u - 1 - \sqrt2} + \frac{2 - \sqrt2}{u - 1 + \sqrt2}} \du \\
      &= - \frac{2+\sqrt2}{2} \ln\abs[\Big]{u - 1 - \sqrt2} - \frac{2-\sqrt2}{2} \ln\abs[\Big]{u - 1 + \sqrt2} + C \\
      &= - \frac{2+\sqrt2}{2} \ln\abs[\Big]{\sin x - 1 - \sqrt2} - \frac{2-\sqrt2}{2} \ln\abs[\Big]{\sin x - 1 + \sqrt2} + C.
    \end{split}
  \]
  第二种就是直接凑微分, 有
  \[
    \begin{split}
      \int \frac{2u}{1 - u^2 + 2u} \du
      &= - \int \paren[\bigg]{\frac{2u-2}{u^2 - 2u - 1} + \frac{2}{u^2 - 2u - 1}} \du \\
      &= - \ln\abs[\Big]{u^2 - 2u - 1} - \frac{\sqrt2}{2} \int \paren[\bigg]{\frac{1}{u - 1 - \sqrt2} - \frac{1}{u - 1 + \sqrt2}} \du \\
      &= - \ln\abs[\Big]{u^2 - 2u - 1} + \frac{\sqrt2}{2} \ln\abs[\Bigg]{\frac{u - 1 + \sqrt2}{u - 1 - \sqrt2}} + C \\
      &= - \ln\abs[\Big]{\cos^2 x + 2 \sin x} + \frac{\sqrt2}{2} \ln\abs[\Bigg]{\frac{\sin x - 1 + \sqrt2}{\sin x - 1 - \sqrt2}} + C.
    \end{split}
  \]
  \fi

\item \(\displaystyle \int \frac{\dx}{\sqrt x \paren{\sqrt x + \sqrt[3]x}}\).

  \ifshowsol
  用\(t = \sqrt[6]x\)做换元, 有
  \[
    \int \frac{\dx}{\sqrt x \paren{\sqrt x + \sqrt[3]x}}
    = \int \frac{6t^5}{t^3(t^3+t^2)} \dt
    = 6 \int \frac{\dt}{t+1}
    = 6 \ln(1+t) + C
    = 6 \ln(1+\sqrt[6]x) + C.
  \]
  \fi

\item \(\displaystyle \int x \sqrt{x+2} \dx\).

  \ifshowsol
  用\(t = \sqrt{x+2}\)做换元, 有
  \[
    \begin{split}
      \int x \sqrt{x+2} \dx
      &= \int \paren{t^2-2}t \cdot 2t \dt
      = \int \paren{2t^4 - 4t^2} \dt \\
      &= \frac25 t^5 - \frac43 t^3 + C
      = \frac25 (x+2)^{5/2} - \frac43 (x+2)^{3/2} + C.
    \end{split}
  \]
  \fi
\end{enumerate}
\fi

\chapter{定积分}

\section{积分概念与积分存在条件}

\ifshowex
\subpdfbookmark{练习}{B1.7.1.E}
\subsection*{练习}

\begin{enumerate}
  \ifshowsol
  \setlength{\parskip}{9pt plus 3pt minus 2pt}
  \setlength{\itemsep}{7pt plus 2pt minus 2pt}
  \fi
\item 估算定积分\(\displaystyle \int_{\sqrt3/3}^{\sqrt3} x \arctan x \dx\)的上下界.

  \ifshowsol
  被积函数是单调递增函数, 这个积分上下限正好是常见的正切值, 求出上和与下和, 有
  \[
    \begin{split}
      (\sqrt3 - \sqrt3/3)\frac{\sqrt3}{3} \arctan \frac{\sqrt3}{3}
      \le
      &\int_{\sqrt3/3}^{\sqrt3} x \arctan x \dx
      \le
      (\sqrt3 - \sqrt3/3) \sqrt3 \arctan\sqrt3, \\
      \frac{\pi}{9}
      \le
      &\int_{\sqrt3/3}^{\sqrt3} x \arctan x \dx
      \le
      \frac23 \pi.
    \end{split}
  \]
  \fi

\item \(\displaystyle \lim_{n\to+\infty} \int_0^{1/2} \frac{x^n}{1+x^2} \dx\).

  \ifshowsol
  当\(n \ge 2\)时, 被积函数是单调递增函数, 所以通过求上和得到一个上界．这个积分显然是\(\ge 0\)的, 又当\(n\to\infty\)时, 这个上界是极限是\(0\), 所以这个积分的极限是\(0\).
  \fi

\item \(\displaystyle \lim_{n\to+\infty} \int_0^1 \frac{x^n e^x}{1+e^x} \dx\).

  \ifshowsol
  在区间\([0, 1]\)上，这个被积函数可以看成一个有界变量和\(x^n\)的乘积, 易知\(x^n\)是它的一个上界．那么只要证明\(\int_0^1 x^n \dx\)的极限是\(0\), 即可证明所求积分的极限也是\(0\).
  \fi

\item 设\(f(x)\)为\((0,+\infty)\)上的单调减函数, 试比较\(\sum_{k=1}^n f(k),\ \int_1^{n+1} f(x) \dx,\ \int_1^{n} f(x) \dx\)的大小关系.

  \ifshowsol
  因为\(f(x)\)是\((0,+\infty)\)上的单调减函数, 所以易知对于任意\(k \ge 1\)都有
  \[
    \int_k^{k+1} f(x) \dx \le f(k) \le \int_{k-1}^k f(x) \dx.
  \]
  那么
  \[
    \int_1^{n+1} f(x) \dx \le \sum_{k=1}^n f(k) \le \int_0^n f(x) \dx, \quad
    \int_2^{n+1} f(x) \dx \le \sum_{k=2}^n f(k) \le \int_1^n f(x) \dx.
  \]
  然后有
  \[
    \int_1^{n+1} f(x) \dx \le \sum_{k=1}^n f(k) = f(1) + \sum_{k=2}^n f(k) \le f(1) + \int_1^n f(x) \dx.
  \]
  \fi

\item \(\displaystyle \lim_{n\to+\infty} \sum_{k=1}^n \frac{n}{n^2+k^2} \).

  \ifshowsol
  将这个和变形得到
  \[
    \sum_{k=1}^n \frac{n}{n^2+k^2}
    = \sum_{k=1}^n \frac1n \frac{1}{1+\paren[\big]{\frac{k}{n}}^2}.
  \]
  这实际上就是函数\(\frac{1}{1+x^2}\)在\([0,1]\)上的一个下和．那么
  \[
    \lim_{n\to+\infty} \sum_{k=1}^n \frac{n}{n^2+k^2} = \int_0^1 \frac{\dx}{1+x^2} = \frac{\pi}{4}.
  \]
  \fi

\item \(\displaystyle \int_{-1}^1 \paren[\big]{\sin^5 x + \sqrt{1 - x^2}} \dx\).

  \ifshowsol
  将被积函数分解成一个奇函数和一个偶函数, 积分区间是\([-1,1]\), 奇函数抵消掉变成零, 偶函数变成
  \[
    \int_{-1}^1 \paren[\big]{\sin^5 x + \sqrt{1 - x^2}} \dx
    = \int_{-1}^1 \sin^5 x \dx + 2 \int_0^1 \sqrt{1-x^2} \dx
    = \frac{\pi}{2}.
  \]
  \fi

\item \(\displaystyle \int_{-1}^1 x^2 \ln\paren[\big]{x + \sqrt{1 + x^2}} \dx\).

  \ifshowsol
  因为\(\ln\paren[\big]{x + \sqrt{1 + x^2}} = \arcsinh x\)是一个奇函数, \(x^2\)是一个偶函数, 所以他们的乘积还是一个奇函数．因此
  \[
    \int_{-1}^1 x^2 \ln\paren[\big]{x + \sqrt{1 + x^2}} \dx = 0.
  \]
  \fi

\item 比较\(\displaystyle 0,\ \int_0^{\pi/2} \sin\sin x \dx,\ \int_0^{\pi/2} \cos\sin x \dx\)的大小.
\end{enumerate}
\fi

\section{定积分的性质}

\begin{theorem*}
  \begin{enumerate}
  \item[]
  \item 函数\(f, g \in R[a,b]\)且\(\forall \alpha, \beta \in \R,\ \alpha\,f + \beta\,g \in R[a,b]\), 则
    \[
      \int_a^b \paren{\alpha\,f + \beta\,g} \dx
      = \alpha \int_a^b f \dx + \beta \int_a^b g \dx.
    \]

  \item 函数\(f \in R[a,b]\), 那么\(\forall c \in (a,b)\)有
    \[
      \int_a^b f \dx = \int_a^c f \dx + \int_c^b f \dx.
    \]

  \item 函数\(f \in R[a,b]\), 那么
    \[
      \int_a^b f \dx = - \int_b^a \dx.
    \]
    推论：\(\int_a^a f \dx = 0\).

  \item 函数\(f \in R[a,b]\)且\(f(x) \ge 0\; \forall x \in [a,b]\), 则
    \[
      \int_a^b f \dx \ge 0.
    \]
    推论：函数\(f, g \in R[a,b]\)且\(f(x) \le g(x)\; \forall x \in [a,b]\), 则
    \[
      \int_a^b f \dx \le \int_a^b g \dx.
    \]

  \item 函数\(f \in R[a,b]\), 则\(\abs{\,f} \in R[a,b]\)且
    \[
      \abs[\Big]{\int_a^b f \dx} \le \int_a^b \abs{\,f} \dx.
    \]

  \item 函数\(f \in R[a,b]\), 若\(\forall x \in [a,b]\)都有\(m \le f < M\), 则
    \[
      m(b-a) \le \int_a^b f \dx \le M(b-a).
    \]

  \item 函数\(f \in R[a,b]\), 则\(\exists \xi \in (a,b)\)使得
    \[
      \int_a^b f \dx = f(\xi)(b-a).
    \]

  \item 函数\(f \in C[a,b],\ g \in R[a,b]\)且\(g\)在\([a,b]\)不变号, 则\(\exists \xi \in (a,b)\)使得
    \[
      \int_a^b fg \dx = f(\xi) \int_a^b g \dx.
    \]
  \end{enumerate}
\end{theorem*}

\section{变上限积分与Newton-Leibniz公式}

\ifshowex
\subpdfbookmark{练习}{B1.7.3.E}
\subsection*{练习}

\begin{enumerate}
\item 设
  \[
    f(x) =
    \begin{cases}
      x^2, & x \in [0,1), \\
      x+1, & x \in [1,2],
    \end{cases}
  \]
  试判断
  \[
    F(x) = \int_0^x f(t) \dt
  \]
  在\([0,2]\)上的连续性和可导性.

  \ifshowsol
  对于这个简单的函数, 我们可以写出它的表达式
  \[
    F(x) =
    \begin{cases}
      \frac13 x^3, & x \in [0,1), \\
      \frac12 x^2 + x - \frac76, & x \in [1,2].
    \end{cases}
  \]
  所以易知\(\lim_{x\to1} F(x) = F(1) = \frac13\)和\(F'_-(1) = 1 \ne 2 = F'_+(1)\)．那么\(F\)在\([0,2]\)上连续, 导函数在\(x=1\)处存在第一类间断点.
  \fi

\item 设
  \[
    F(x) = \frac1{x-a} \int_a^x f(t) \dt,
  \]
  其中\(f\)在\([a,b]\)上连续, 在\((a,b)\)内可导且\(f'(x) \le 0\)．试讨论\(F\)在\((a,b)\)上的单调性.

  \ifshowsol
  对该函数求导, 得到
  \[
    \ddx F(x) = \frac{f(x)(x-a) - \int_a^x f(t) \dt}{(x-a)^2}.
  \]
  因为\(f\)在\((a,b)\)上单调递减, 所以
  \[
    f(x)(x-a) \le \int_a^x f(t) \dt.
  \]
  这就意味着\(\ddx F(x) \le 0\), 也就是说\(F\)在\((a,b)\)上单调递减.
  \fi

\item \(\displaystyle \int_0^2 \frac{(x-1)^2 + 1}{(x-1)^2 + x^2 (x-2)^2} \dx\).

  \ifshowsol
  设被积函数为\(f\,\), 那么根据定积分的性质就有
  \[
    \begin{split}
      \int_0^2 f(x) \dx
      &= \int_{-1}^1 f(x+1) \dx
      = \int_{-1}^1 \frac{x^2 + 1}{x^2 + (x+1)^2 (x-1)^2} \dx \\
      &= 2 \int_0^1 \frac{x^2 + 1}{x^2 + (x+1)^2 (x-1)^2} \dx
      = 2 \int_0^1 \frac{1 + \frac{1}{x^2}}{1 + \paren[\big]{\frac{x^2-1}{x}}^2} \dx \\
      &= 2 \int_0^1 \frac{1 + \frac{1}{x^2}}{1 + \paren[\big]{x - \frac{1}{x}}^2} \dx
      = 2 \int_0^1 \frac{\diff\paren[\big]{x - \frac{1}{x}}}{1 + \paren[\big]{x - \frac{1}{x}}^2} \\
      &= 2 \arctan\paren[\Big]{x - \frac{1}{x}}\bigg\vert_0^1
      = 2 \brkt[\Big]{0 - \paren[\Big]{-\frac{\pi}{2}}} \\
      &= \pi.
    \end{split}
  \]
  易知平移后的函数\(f(x+1)\)是一个偶函数.
  \fi

\item 设\(f\)是\([0,+\infty)\)上的连续函数且恒有\(f(x) > 0\), 定义函数
  \[
    g(x) = \frac{\int_0^x t\,f(t) \dt}{\int_0^x f(t) \dt},
  \]
  则下列说法正确的是哪个？
  \begin{enumerate}
  \item \(\displaystyle \lim_{x\to0} g(x) = 1\).
  \item \(g(x)\)在\([0,+\infty)\)上单调增加.
  \item \(\displaystyle \lim_{x\to\infty} g(x) = +\infty\).
  \item \(\displaystyle \lim_{x\to0^+} g'(x)\)不存在.
  \end{enumerate}

  \ifshowsol
  易证\(\lim_{x\to0} g(x) = 0\)和\(\lim_{x\to0^+} g'(x) = 1/2\)．设\(f(t) = e^{-t}\), 那么这个函数就是\enumparen{c}的反例, 因为\(\lim_{x\to\infty} g(x) = 1\)．对于\(g\)求导, 有
  \[
    g'(x) = \frac{x\,f(x) \int_0^x f(t) \dt - f(x) \int_0^x t\,f(t) \dt}{\paren[\big]{\int_0^x f(t) \dt}^2}
    = f(x) \frac{\int_0^x (x-t)\,f(t) \dt}{\paren[\big]{\int_0^x f(t) \dt}^2}.
  \]
  对于所有的\(t \in (0, x)\), 都有\(x - t > 0\)和\(f(t) > 0\), 所以\(\int_0^x (x-t)\,f(t) \dt > 0\)．这就是说在\((0,+\infty)\)上\(g'(x) > 0\), 所以\(g(x)\)在\([0,+\infty)\)上单调增加.
  \fi

\item 已知\(F(x) = \int_a^x f(t) \dt \; (a \le x \le b)\), 则下列结论正确的是哪个？
  \begin{enumerate}
  \item 若函数\(F\)连续, 则\(F' = f\).
  \item 若函数\(f\)连续, 则\(F\)一阶导函数连续.
  \item 函数\(F\)的连续点也是函数\(f\)的连续点.
  \item 若函数\(f\)连续, 则不一定有\(F' = f\).
  \end{enumerate}

\item 关于\(\int_a^x f(t) \dt\), 以下说法正确的是哪个？
  \begin{enumerate}
  \item 函数\(\int_a^x f(t) \dt\)是\(f(x)\)的某一个原函数.
  \item 函数\(\int_a^x f(t) \dt\)是\(f(x)\)的一类原函数族.
  \item 函数\(\int_a^x f(t) \dt\)不一定是\(f(x)\)的原函数.
  \item 若\(\int_a^x f(t) \dt\)是\(f(x)\)的原函数, 则\(f(x)\)连续.
  \end{enumerate}

\item \(\displaystyle \ddx \int_{1/x}^{\cos x} f(t) \dt\).

  \ifshowsol
  \[
    \ddx \int_{1/x}^{\cos x} f(t) \dt
    = \ddx \paren[\Big]{\int_{1/x}^0 f(t) \dt + \int_0^{\cos x} f(t) \dt}
    = \frac{f(1/x)}{x^2} - f(\cos x) \sin x .
  \]
  \fi

\item \(\displaystyle \ddx \int_0^x \sin x \cos t^2 \dt\).

  \ifshowsol
  \[
    \ddx \int_0^x \sin x \cos t^2 \dt
    = \ddx \sin x \int_0^x \cos t^2 \dt
    = \cos x \int_0^x \cos t^2 \dt + \sin x \cos x^2.
  \]
  \fi

\item 求\(x = \int_0^t \sin u \du,\ y = \int_0^t \cos u \du\)所确定的函数对\(x\)的导数\(\dd[y]x\).

  \ifshowsol
  \[
    \dd[y]x = \frac{\dy/\!\dt}{\dx/\!\dt}
    = \frac{\cos t}{\sin t}
    = \cot t.
  \]
  \fi

\item 求由\(\int_0^y e^t \dt + \int_0^x \cos t \dt = 0\)所确定的隐函数对\(x\)的导数\(\dd[y]x\).
  \[
    \begin{split}
      \diff\paren[\Big]{\int_0^y e^t \dt + \int_0^x \cos t \dt}
      &= 0 \\
      e^y \dy + \cos x \dx = 0 \\
      \dd[y]x = - e^{-y} \cos x.
    \end{split}
  \]
\end{enumerate}
\fi

\section{定积分的换元积分法与分部积分法}

\ifshowex
\subpdfbookmark{练习}{B1.7.4.E}
\subsection*{练习}

\begin{enumerate}
\item \(\displaystyle \int_0^a \sqrt{a^2 - x^2} \dx\).

  \ifshowsol
  根据被积函数的几何意义, 有
  \[
    \int_0^a \sqrt{a^2 - x^2} \dx = \frac{\pi a^2}{4}.
  \]
  \fi

\item \(\displaystyle \int_a^{2a} \frac{\sqrt{x^2 - a^2}}{x^4} \dx, \ (a > 0)\).

  \ifshowsol
  用\(x = a \sec t\)做换元, 有
  \[
    \begin{split}
      \int_a^{2a} \frac{\sqrt{x^2 - a^2}}{x^4} \dx
      &= \int_0^{\pi/3} \frac{\sqrt{a^2 \sec^2 t - a^2} \cdot a \tan t \sec t}{a^4 \sec^4 t} \dt
      = \frac{1}{a^2} \int_0^{\pi/3} \frac{\tan^2 t}{\sec^3 t} \dt \\
      &= \frac{1}{a^2} \int_0^{\pi/3} \sin^2 t \cos t \dt
      = \frac{1}{a^2} \int_0^{\sqrt3/2} u^2 \du \\
      &= \frac{1}{a^2} \frac{u^3}{3}\bigg\vert_0^{\sqrt3/2}
      = \frac{\sqrt3}{8a^2}.
    \end{split}
  \]
  也可以用\(x = a \cosh t\)做换元, 有
  \[
    \begin{split}
      \int_a^{2a} \frac{\sqrt{x^2 - a^2}}{x^4} \dx
      &= \int_0^{\arccosh2} \frac{\sqrt{a^2 \cosh^2 t - a^2} \cdot a \sinh t}{a^4 \cosh^4 t} \dt
      = \frac1{a^2} \int_0^{\arccosh2} \tanh^2 t \sech^2 t \dt \\
      &= \frac1{a^2} \int_0^{\tanh\arccosh2} u^2 \du
      = \frac1{a^2} \frac{u^3}{3} \bigg\vert_0^{\sqrt3/2}
      = \frac{\sqrt3}{8a^2}.
    \end{split}
  \]
  其中
  \[
    \tanh\arccosh2 = \tanh\arcsech\frac12 = \sqrt{1 - \sech^2\arcsech\frac12}
    = \sqrt{1 - \frac14} = \frac{\sqrt3}{2}.
  \]
  \fi

\item \(\displaystyle \int_0^3 \frac{x}{1 + \sqrt{1+x}} \dx\).

  \ifshowsol
  用\(t = \sqrt{1+x}\)做换元, 有
  \[
    \int_0^3 \frac{x}{1 + \sqrt{1+x}} \dx
    = \int_1^2 \frac{t^2-1}{1+t} \cdot 2t \dt
    = 2 \int_1^2 \paren{t^2 - t} \dt
    = \frac{2}{3} t^3 \bigg\vert_1^2 - t^2 \bigg\vert_1^2
    = \frac53.
  \]
  \fi

\item \(\displaystyle \int_1^e \frac{1 + \ln x}{x} \dx\).

  \ifshowsol
  \[
    \int_1^e \frac{1 + \ln x}{x} \dx
    = \int_1^e \frac{\dx}{x} + \int_1^e \frac{\ln x}{x} \dx
    = \ln x \bigg\vert_1^e + \frac{\ln^2 x}{2} \bigg\vert_1^e
    = 1 + \frac12 = \frac32.
  \]
  \fi

\item \(\displaystyle \int_0^2 \sqrt{\paren[\big]{4-x^2}^3} \dx\).

  \ifshowsol
  用\(x = 2 \sin t\)做换元, 有
  \[
    \begin{split}
      \int_0^{\pi/2} \sqrt{\paren[\big]{4-x^2}^3} \dx
      &= 16 \int_0^{\pi/2} \cos^4 t \dt
      = 4 \int_0^{\pi/2} \paren[\big]{1 + \cos 2t}^2 \dt \\
      &= 4 \int_0^{\pi/2} \paren{1 + 2 \cos 2t + \cos^2 2t} \dt \\
      &= 4 \paren[\bigg]{\frac{\pi}{2} + \sin 2t \Big\vert_0^{\pi/2} + \frac12 \int_0^\pi \cos^2 u \du} \\
      &= 2 \pi + \int_0^\pi \paren{1 + \cos 2u} \du \\
      &= 2 \pi + \pi + \frac{\sin 2u}{2} \bigg\vert_0^\pi
      = 3 \pi.
    \end{split}
  \]
  \fi
\item \(\displaystyle \int_0^4 \frac{\sqrt x}{1 + x \sqrt{x}} \dx\).

  \ifshowsol
  用\(t = \sqrt x\)做换元, 有
  \[
    \begin{split}
      \int_0^4 \frac{\sqrt x}{1 + x \sqrt{x}} \dx
      = \int_0^2 \frac{t}{1+t^3} \cdot 2t \dt
      = \frac23 \int_0^2 \frac{\diff(t^3)}{1+t^3}
      = \frac23 \ln(1+t^3) \Big\vert_0^2
      = \frac23 \ln9
      = \frac43 \ln3.
    \end{split}
  \]
  \fi

\item \(\displaystyle \int_1^2 x \sqrt{x^2 - 1} \dx\).

  \ifshowsol
  用\(x = \cosh t\)做换元, 有
  \[
    \int_1^2 x \sqrt{x^2 - 1} \dx
    = \int_0^{\arccosh2} \sinh^2 t \cosh t \dt
    = \int_0^{\sinh\arccosh2} u^2 \du
    = \frac{u^3}{3} \bigg\vert_0^{\sqrt3}
    = \sqrt3.
  \]
  其中
  \[
    \sinh\arccosh2 = \sqrt{\cosh^2 \arccosh 2 - 1} = \sqrt{2^2 - 1} = \sqrt3.
  \]
  或者用\(x = \sec t\)做换元, 有
  \[
    \int_1^2 x \sqrt{x^2 - 1} \dx
    = \int_0^{\pi/3} \tan^2 t \sec^2 t \dt
    = \int_0^{\sqrt3} u^2 \du
    = \frac{u^3}{3} \bigg\vert_0^{\sqrt3}
    = \sqrt3.
  \]
  \fi

\item \(\displaystyle \int_0^{2\pi} \frac{\dx}{1 + \cos^2 x}\).

  \ifshowsol
  先将被积函数降次, 然后把积分上下限变换到最小的范围, 最后用\(t = \tan \frac x2\)做换元, 有
  \[
    \begin{split}
      \int_0^{2\pi} \frac{\dx}{1 + \cos^2 x}
      &= \int_0^{2\pi} \frac{2}{3 + \cos 2x} \dx
      = \int_0^{4\pi} \frac{\dx}{3 + \cos x}
      = 2 \int_0^{2\pi} \frac{\dx}{3 + \cos x} \\
      &= 2 \int_{-\pi}^{\pi} \frac{\dx}{3 - \cos x}
      = 4 \int_0^{\pi} \frac{\dx}{3 - \cos x} \\
      &= 4 \int_0^{+\infty} \frac{1}{3 - \paren{1-t^2}/\paren{1+t^2}} \frac{2}{1+t^2} \dt
      = 4 \int_0^{+\infty} \frac{\dt}{1 + 2t^2} \\
      &= \frac{4}{\sqrt2} \arctan \sqrt2 t \bigg\vert_0^{+\infty}
      = \sqrt2 \pi.
    \end{split}
  \]
  \fi

\item 设函数
  \[
    f(x) =
    \begin{cases}
      x, & 0 \le x \le 1, \\
      x^2, & 1 < x \le 2,
    \end{cases}
  \]
  求\(\displaystyle \int_0^2 f(x) \dx\).

  \ifshowsol
  \[
    \int_0^2 f(x) \dx
    = \int_0^1 f(x) \dx + \int_1^2 f(x) \dx
    = \frac{x^2}{2} \bigg\vert_0^1 + \frac{x^3}{3} \bigg\vert_1^2
    = \frac{17}{6}.
  \]
  \fi

\item \(\displaystyle \int_0^3 \paren[\big]{\abs[\big]{x-1} + \abs[\big]{x-2}} \dx\).

  \ifshowsol
  \[
    \begin{split}
      \int_0^3 \paren[\big]{\abs[\big]{x-1} + \abs[\big]{x-2}} \dx
      &= \int_0^1 \paren{3-2x} \dx + \int_1^2 \dx + \int_2^3 \paren{2x-3} \dx \\
      &= \paren{3x-x^2} \Big\vert_0^1 + 1 + \paren{x^2 - 3x} \Big\vert_2^3 \\
      &= 2 + 1 + 2 = 5.
    \end{split}
  \]
  \fi

\item \(\displaystyle \int_0^{2\pi} \abs[\big]{\sin\paren{x-\pi}} \dx\).

  \ifshowsol
  \[
    \int_0^{2\pi} \abs[\big]{\sin\paren{x-\pi}} \dx
    = \int_0^{2\pi} \abs[\big]{- \sin x} \dx
    = \int_0^{2\pi} \abs[\big]{\sin x} \dx
    = 2 \int_0^{\pi} \abs[\big]{\sin x} \dx
    = 2 \int_0^{\pi} \sin x \dx
    = 4.
  \]
  \fi

\item \(\displaystyle \int_0^\pi \frac{x \sin^2 x}{1 + \sin x} \dx\).

  \ifshowsol
  \[
    \begin{split}
      \int_0^\pi \frac{x \sin^2 x}{1 + \sin x} \dx
      &= \int_{-\pi/2}^{\pi/2} \frac{(x+\pi/2) \cos^2 x}{1 + \cos x} \dx
      = \int_{-\pi/2}^{\pi/2} \frac{x \cos^2 x}{1 + \cos x} \dx + \frac\pi2 \int_{-\pi/2}^{\pi/2} \frac{\cos^2 x}{1 + \cos x} \dx \\
      &= \pi \int_0^{\pi/2} \frac{\cos^2 x}{1 + \cos x} \dx
      = \pi \int_0^1 \frac{\brkt[\big]{(1-t^2)/(1+t^2)}^2}{1 + (1-t^2)/(1+t^2)} \cdot \frac2{1+t^2} \dx \\
      &= \pi \int_0^1 \paren[\bigg]{\frac{1-t^2}{1+t^2}}^2 \dt
      = \pi \int_0^1 \brkt[\bigg]{1 - \frac{4t^2}{\paren{1+t^2}^2}} \dt \\
      &= \pi - 4 \pi \int_0^1 \brkt[\bigg]{\frac{1}{1+t^2} - \frac{1}{\paren{1+t^2}^2}} \dt \\
      &= \pi - 4 \pi \arctan t \Big\vert_0^1 + 4 \pi \int_0^1 \frac{\dt}{\paren{1+t^2}^2} \\
      &= \pi - \pi^2 + 4 \pi \int_0^1 \frac{\dt}{\paren{1+t^2}^2}.
    \end{split}
  \]
  现在只要把最后一行剩下的积分求出来就可以了, 注意到
  \[
    \begin{split}
      \int_0^1 \frac{\dt}{1+t^2}
      &= \frac{t}{1+t^2} \bigg\vert_0^1 + 2 \int_0^1 \frac{t^2}{\paren{1+t^2}^2} \dt
      = \frac12 + 2 \int_0^1 \brkt[\bigg]{\frac{1}{1+t^2} - \frac{1}{\paren{1+t^2}^2}} \dt \\
      &= \frac12 + 2 \int_0^1 \frac{\dt}{1+t^2} - 2 \int_0^1 \frac{\dt}{\paren{1+t^2}^2},
    \end{split}
  \]
  所以
  \[
    \int_0^1 \frac{\dt}{\paren{1+t^2}^2}
    = \frac14 + \frac12 \int_0^1 \frac{\dt}{1+t^2}
    = \frac14 + \frac12 \arctan t \Big\vert_0^1
    = \frac14 + \frac\pi8.
  \]
  因此,
  \[
    \int_0^\pi \frac{x \sin^2 x}{1 + \sin x} \dx
    = \pi - \pi^2 + 4 \pi \paren[\bigg]{\frac14 + \frac\pi8}
    = 2 \pi - \frac{\pi^2}{2}.
  \]
  \fi

\item \(\displaystyle \int_0^1 \ln\paren{1+x^2} \dx\).

  \ifshowsol
  \[
    \begin{split}
      \int_0^1 \ln\paren{1+x^2} \dx
      &= x \ln\paren{1+x^2} \Big\vert_0^1 - 2 \int_0^1 \frac{x^2}{1+x^2} \dx
      = \ln2 - 2 \int_0^1 \paren[\bigg]{1 - \frac{1}{1+x^2}} \dx \\
      &= \ln 2 - 2 + 2 \arctan x \Big\vert_0^1
      = \ln 2 - 2 + \frac\pi2.
    \end{split}
  \]
  \fi

\item \(\displaystyle \int_0^1 x \arctan x \dx\).

  \ifshowsol
  \[
    \begin{split}
      \int_0^1 x \arctan x \dx
      &= \frac12 \int_0^1 \arctan x \diff(x^2)
      = \frac12 \paren[\Big]{x^2 \arctan x \Big\vert_0^1 - \int_0^1 \frac{x^2}{1+x^2} \dx} \\
      &= \frac\pi8 - \frac12 + \frac12 \arctan x \Big\vert_0^1
      = \frac\pi4 - \frac12.
    \end{split}
  \]
  \fi

\item \(\displaystyle \int_0^1 x^3 e^{-x^2} \dx\).

  \ifshowsol
  \[
    \begin{split}
      \int_0^1 x^3 e^{-x^2} \dx
      &= - \frac12 \int_0^1 x^2 \diff e^{-x^2}
      = - \frac12 \paren[\Big]{x^2 e^{-x^2} \Big\vert_0^1 - \int_0^1 e^{-x^2} \cdot 2x \dx} \\
      &= - \frac12 \paren[\Big]{e^{-1} + e^{-x^2} \Big\vert_0^1}
      = \frac12 - \frac1e.
    \end{split}
  \]
  \fi

\item \(\displaystyle \int_0^\pi e^x \sin 2x \dx\).

  \ifshowsol
  因为
  \[
    \begin{split}
      \int_0^\pi e^x \sin 2x \dx
      &= e^x \sin 2x \Big\vert_0^\pi - 2 \int_0^\pi e^x \cos 2x \dx
      = -2 \paren[\Big]{e^x \cos 2x \Big\vert_0^\pi + 2 \int_0^\pi e^x \sin 2x \dx} \\
      &= -2(e^\pi - 1) - 4 \int_0^\pi e^x \sin 2x \dx.
    \end{split}
  \]
  所以
  \[
    \int_0^\pi e^x \sin 2x \dx = -\frac25 (e^\pi - 1).
  \]
  \fi
\end{enumerate}
\fi

\section{定积分的几何应用}

\ifshowex
\subpdfbookmark{练习}{B1.7.5.E}
\subsection*{练习}
\fi


\section{定积分的物理应用}

\section{反常积分}

\ifshowex
\subpdfbookmark{练习}{B1.7.7.E}
\subsection*{练习}
\fi

\chapter{级数}


\end{document}

% Local Variables:
% TeX-engine: luatex
% End:
